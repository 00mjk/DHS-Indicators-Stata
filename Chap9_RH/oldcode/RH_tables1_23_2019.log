---------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\39585\ICF\Analysis - Shared Resources\Code\ShareCodeProject\Chap9_RH\RH_tables1_23_2019.log
  log type:  text
 opened on:  23 Jan 2019, 12:46:29

. ********************************************************
. 
. *gen wt=v005/1000000
. 
. * indicators from IR file
. if file=="IR" {
. 
. 
. * Indicators involving ANC visit: excel file ch9tables_ANCvisits will be produced
. *********************************************************************************
. //Person providing assistance during ANC
. 
. *residence
. tab v025 rh_anc_pv [iw=wt], row nofreq 

   type of |
  place of |         Person providing assistance during ANC
 residence |    Doctor  Nurse/mid  Other hea  TBA/other     No ANC |     Total
-----------+-------------------------------------------------------+----------
     urban |     28.98      66.87       2.75       0.05       1.34 |    100.00 
     rural |     15.47      70.50      10.24       0.17       3.61 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |     21.71      68.83       6.78       0.12       2.56 |    100.00 
. 
. *region
. tab v024 rh_anc_pv [iw=wt], row nofreq 

              |         Person providing assistance during ANC
       region |    Doctor  Nurse/mid  Other hea  TBA/other     No ANC |     Total
--------------+-------------------------------------------------------+----------
      western |     14.03      77.06       8.19       0.00       0.72 |    100.00 
      central |     24.68      66.90       6.41       0.00       2.01 |    100.00 
greater accra |     34.34      61.85       2.31       0.11       1.39 |    100.00 
        volta |     19.92      63.22      10.78       0.27       5.81 |    100.00 
      eastern |     27.36      64.56       4.68       0.24       3.15 |    100.00 
      ashanti |     34.61      63.02       1.14       0.00       1.23 |    100.00 
  brong ahafo |     10.14      85.17       3.61       0.00       1.08 |    100.00 
     northern |      3.19      72.03      16.76       0.47       7.55 |    100.00 
   upper east |      5.67      86.28       6.48       0.00       1.58 |    100.00 
   upper west |      6.70      59.96      31.61       0.00       1.72 |    100.00 
--------------+-------------------------------------------------------+----------
        Total |     21.71      68.83       6.78       0.12       2.56 |    100.00 
. 
. *education
. tab v106 rh_anc_pv [iw=wt], row nofreq 

     highest |
 educational |         Person providing assistance during ANC
       level |    Doctor  Nurse/mid  Other hea  TBA/other     No ANC |     Total
-------------+-------------------------------------------------------+----------
no education |      8.84      72.55      12.66       0.29       5.65 |    100.00 
     primary |     19.92      69.79       6.18       0.00       4.11 |    100.00 
   secondary |     26.84      68.05       4.46       0.08       0.58 |    100.00 
      higher |     46.71      52.13       1.17       0.00       0.00 |    100.00 
-------------+-------------------------------------------------------+----------
       Total |     21.71      68.83       6.78       0.12       2.56 |    100.00 
. 
. *wealth
. tab v190 rh_anc_pv [iw=wt], row nofreq 

    wealth |         Person providing assistance during ANC
     index |    Doctor  Nurse/mid  Other hea  TBA/other     No ANC |     Total
-----------+-------------------------------------------------------+----------
   poorest |      6.10      72.06      15.81       0.36       5.67 |    100.00 
    poorer |     14.43      73.53       7.70       0.08       4.25 |    100.00 
    middle |     21.44      71.51       5.31       0.11       1.62 |    100.00 
    richer |     25.66      70.43       3.23       0.00       0.69 |    100.00 
   richest |     42.81      55.84       1.07       0.00       0.28 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |     21.71      68.83       6.78       0.12       2.56 |    100.00 
. 
. */
. ****************************************************
. //Skilled assistance during ANC
. 
. *residence
. tab v025 rh_anc_pvskill [iw=wt], row nofreq 

   type of |  Skilled assistance
  place of |      during ANC
 residence | Unskilled  Skilled p |     Total
-----------+----------------------+----------
     urban |      1.39      98.61 |    100.00 
     rural |      3.78      96.22 |    100.00 
-----------+----------------------+----------
     Total |      2.68      97.32 |    100.00 
. 
. *region
. tab v024 rh_anc_pvskill [iw=wt], row nofreq 

              |  Skilled assistance
              |      during ANC
       region | Unskilled  Skilled p |     Total
--------------+----------------------+----------
      western |      0.72      99.28 |    100.00 
      central |      2.01      97.99 |    100.00 
greater accra |      1.49      98.51 |    100.00 
        volta |      6.08      93.92 |    100.00 
      eastern |      3.40      96.60 |    100.00 
      ashanti |      1.23      98.77 |    100.00 
  brong ahafo |      1.08      98.92 |    100.00 
     northern |      8.02      91.98 |    100.00 
   upper east |      1.58      98.42 |    100.00 
   upper west |      1.72      98.28 |    100.00 
--------------+----------------------+----------
        Total |      2.68      97.32 |    100.00 
. 
. *education
. tab v106 rh_anc_pvskill [iw=wt], row nofreq 

     highest |  Skilled assistance
 educational |      during ANC
       level | Unskilled  Skilled p |     Total
-------------+----------------------+----------
no education |      5.94      94.06 |    100.00 
     primary |      4.11      95.89 |    100.00 
   secondary |      0.66      99.34 |    100.00 
      higher |      0.00     100.00 |    100.00 
-------------+----------------------+----------
       Total |      2.68      97.32 |    100.00 
. 
. *wealth
. tab v190 rh_anc_pvskill [iw=wt], row nofreq 

           |  Skilled assistance
    wealth |      during ANC
     index | Unskilled  Skilled p |     Total
-----------+----------------------+----------
   poorest |      6.03      93.97 |    100.00 
    poorer |      4.34      95.66 |    100.00 
    middle |      1.74      98.26 |    100.00 
    richer |      0.69      99.31 |    100.00 
   richest |      0.28      99.72 |    100.00 
-----------+----------------------+----------
     Total |      2.68      97.32 |    100.00 
. 
. * output to excel
. * output to excel
. */
. ****************************************************
. // Number of ANC visits in categories
. 
. *residence
. tab v025 rh_anc_numvs [iw=wt], row nofreq 

   type of |
  place of |                  Number of ANC visits
 residence |      none          1        2-3         4+  don't kno |     Total
-----------+-------------------------------------------------------+----------
     urban |      1.34       0.59       5.43      92.27       0.36 |    100.00 
     rural |      3.61       1.51      11.28      82.94       0.66 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |      2.56       1.09       8.58      87.25       0.52 |    100.00 
. 
. *region
. tab v024 rh_anc_numvs [iw=wt], row nofreq 

              |                  Number of ANC visits
       region |      none          1        2-3         4+  don't kno |     Total
--------------+-------------------------------------------------------+----------
      western |      0.72       1.16       6.03      92.10       0.00 |    100.00 
      central |      2.01       0.24       6.32      91.10       0.33 |    100.00 
greater accra |      1.39       0.81       6.19      91.42       0.18 |    100.00 
        volta |      5.81       3.30      13.48      77.28       0.12 |    100.00 
      eastern |      3.15       2.02      17.08      77.37       0.38 |    100.00 
      ashanti |      1.23       0.05       3.74      93.49       1.49 |    100.00 
  brong ahafo |      1.08       0.52       7.65      90.29       0.47 |    100.00 
     northern |      7.55       2.58      16.48      72.96       0.43 |    100.00 
   upper east |      1.58       0.15       4.02      93.01       1.24 |    100.00 
   upper west |      1.72       0.21       6.74      91.32       0.00 |    100.00 
--------------+-------------------------------------------------------+----------
        Total |      2.56       1.09       8.58      87.25       0.52 |    100.00 
. 
. *education
. tab v106 rh_anc_numvs [iw=wt], row nofreq 

     highest |
 educational |                  Number of ANC visits
       level |      none          1        2-3         4+  don't kno |     Total
-------------+-------------------------------------------------------+----------
no education |      5.65       1.86      12.40      79.23       0.86 |    100.00 
     primary |      4.11       1.64      11.21      82.27       0.78 |    100.00 
   secondary |      0.58       0.56       6.20      92.37       0.29 |    100.00 
      higher |      0.00       0.00       1.44      98.56       0.00 |    100.00 
-------------+-------------------------------------------------------+----------
       Total |      2.56       1.09       8.58      87.25       0.52 |    100.00 
. 
. *wealth
. tab v190 rh_anc_numvs [iw=wt], row nofreq 

    wealth |                  Number of ANC visits
     index |      none          1        2-3         4+  don't kno |     Total
-----------+-------------------------------------------------------+----------
   poorest |      5.67       2.22      15.00      76.40       0.71 |    100.00 
    poorer |      4.25       1.56      11.29      82.07       0.83 |    100.00 
    middle |      1.62       0.75      10.11      86.81       0.71 |    100.00 
    richer |      0.69       0.72       4.15      94.13       0.32 |    100.00 
   richest |      0.28       0.07       1.59      98.06       0.00 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |      2.56       1.09       8.58      87.25       0.52 |    100.00 
. 
. * output to excel
. */
. 
. * no table for rh_anc4vs. 
. ****************************************************
. // Number of months pregnant before 1st ANC visit
. 
. *residence
. tab v025 rh_anc_moprg [iw=wt], row nofreq 

   type of |
  place of |       Number of months pregnant at  time of first ANC visit
 residence |    no anc         <4        4-5        6-7         8+  don't kno |     Total
-----------+------------------------------------------------------------------+----------
     urban |      1.34      67.85      25.26       5.20       0.35       0.00 |    100.00 
     rural |      3.61      60.73      28.89       6.08       0.62       0.06 |    100.00 
-----------+------------------------------------------------------------------+----------
     Total |      2.56      64.02      27.22       5.67       0.50       0.03 |    100.00 
. 
. *region
. tab v024 rh_anc_moprg [iw=wt], row nofreq 

              |       Number of months pregnant at  time of first ANC visit
       region |    no anc         <4        4-5        6-7         8+  don't kno |     Total
--------------+------------------------------------------------------------------+----------
      western |      0.72      77.15      17.12       4.39       0.62       0.00 |    100.00 
      central |      2.01      64.70      29.01       3.62       0.65       0.00 |    100.00 
greater accra |      1.39      66.99      26.52       5.00       0.11       0.00 |    100.00 
        volta |      5.81      61.60      24.47       6.53       1.59       0.00 |    100.00 
      eastern |      3.15      60.73      27.82       7.33       0.97       0.00 |    100.00 
      ashanti |      1.23      69.63      24.28       4.65       0.21       0.00 |    100.00 
  brong ahafo |      1.08      64.08      27.78       6.71       0.35       0.00 |    100.00 
     northern |      7.55      39.56      41.91      10.19       0.50       0.30 |    100.00 
   upper east |      1.58      70.83      24.71       2.88       0.00       0.00 |    100.00 
   upper west |      1.72      68.28      26.77       3.01       0.21       0.00 |    100.00 
--------------+------------------------------------------------------------------+----------
        Total |      2.56      64.02      27.22       5.67       0.50       0.03 |    100.00 
. 
. *education
. tab v106 rh_anc_moprg [iw=wt], row nofreq 

     highest |
 educational |       Number of months pregnant at  time of first ANC visit
       level |    no anc         <4        4-5        6-7         8+  don't kno |     Total
-------------+------------------------------------------------------------------+----------
no education |      5.65      53.77      32.02       8.11       0.32       0.13 |    100.00 
     primary |      4.11      59.27      28.95       6.42       1.25       0.00 |    100.00 
   secondary |      0.58      68.95      25.52       4.62       0.33       0.00 |    100.00 
      higher |      0.00      88.92      11.02       0.06       0.00       0.00 |    100.00 
-------------+------------------------------------------------------------------+----------
       Total |      2.56      64.02      27.22       5.67       0.50       0.03 |    100.00 
. 
. *wealth
. tab v190 rh_anc_moprg [iw=wt], row nofreq 

    wealth |       Number of months pregnant at  time of first ANC visit
     index |    no anc         <4        4-5        6-7         8+  don't kno |     Total
-----------+------------------------------------------------------------------+----------
   poorest |      5.67      52.81      31.80       8.77       0.78       0.17 |    100.00 
    poorer |      4.25      55.22      32.69       7.05       0.79       0.00 |    100.00 
    middle |      1.62      63.53      29.04       5.33       0.48       0.00 |    100.00 
    richer |      0.69      70.23      23.83       4.94       0.31       0.00 |    100.00 
   richest |      0.28      79.80      17.95       1.91       0.07       0.00 |    100.00 
-----------+------------------------------------------------------------------+----------
     Total |      2.56      64.02      27.22       5.67       0.50       0.03 |    100.00 
. 
. * output to excel
. */
. 
. * no table for rh_anc4mo. 
. ****************************************************
. * Output for rh_ancmedian, rh_ancmedian_urban rh_ancmedian_rural. These are scalars. 
. 
. 
. ****************************************************
. 
. * Indicators involving ANC components: excel file ch9tables_ANCcomps will be produced
. *************************************************************************************
. //took iron during pregnancy
. 
. *residence
. tab v025 rh_anciron [iw=wt], row nofreq 

           |       Took iron
           |  tablet/syrup during
   type of |   pregnancy of last
  place of |         birth
 residence |        no        yes |     Total
-----------+----------------------+----------
     urban |      7.03      92.97 |    100.00 
     rural |      8.99      91.01 |    100.00 
-----------+----------------------+----------
     Total |      8.09      91.91 |    100.00 
. 
. *region
. tab v024 rh_anciron [iw=wt], row nofreq 

              |       Took iron
              |  tablet/syrup during
              |   pregnancy of last
              |         birth
       region |        no        yes |     Total
--------------+----------------------+----------
      western |      6.27      93.73 |    100.00 
      central |      8.20      91.80 |    100.00 
greater accra |      7.09      92.91 |    100.00 
        volta |     11.52      88.48 |    100.00 
      eastern |     11.31      88.69 |    100.00 
      ashanti |      6.02      93.98 |    100.00 
  brong ahafo |      5.41      94.59 |    100.00 
     northern |     11.50      88.50 |    100.00 
   upper east |     10.47      89.53 |    100.00 
   upper west |      3.76      96.24 |    100.00 
--------------+----------------------+----------
        Total |      8.09      91.91 |    100.00 
. 
. *education
. tab v106 rh_anciron [iw=wt], row nofreq 

             |       Took iron
             |  tablet/syrup during
     highest |   pregnancy of last
 educational |         birth
       level |        no        yes |     Total
-------------+----------------------+----------
no education |     10.98      89.02 |    100.00 
     primary |      9.22      90.78 |    100.00 
   secondary |      6.57      93.43 |    100.00 
      higher |      3.28      96.72 |    100.00 
-------------+----------------------+----------
       Total |      8.09      91.91 |    100.00 
. 
. *wealth
. tab v190 rh_anciron [iw=wt], row nofreq 

           |       Took iron
           |  tablet/syrup during
           |   pregnancy of last
    wealth |         birth
     index |        no        yes |     Total
-----------+----------------------+----------
   poorest |     10.59      89.41 |    100.00 
    poorer |      8.98      91.02 |    100.00 
    middle |      9.68      90.32 |    100.00 
    richer |      6.70      93.30 |    100.00 
   richest |      4.15      95.85 |    100.00 
-----------+----------------------+----------
     Total |      8.09      91.91 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //took intestinal parasite drugs during pregnacy
. 
. *residence
. tab v025 rh_ancparast [iw=wt], row nofreq 

           |    Took intestinal
           | parasite drugs during
   type of |   pregnancy of last
  place of |         birth
 residence |        no        yes |     Total
-----------+----------------------+----------
     urban |     63.79      36.21 |    100.00 
     rural |     57.80      42.20 |    100.00 
-----------+----------------------+----------
     Total |     60.57      39.43 |    100.00 
. 
. *region
. tab v024 rh_ancparast [iw=wt], row nofreq 

              |    Took intestinal
              | parasite drugs during
              |   pregnancy of last
              |         birth
       region |        no        yes |     Total
--------------+----------------------+----------
      western |     39.12      60.88 |    100.00 
      central |     55.97      44.03 |    100.00 
greater accra |     69.35      30.65 |    100.00 
        volta |     67.83      32.17 |    100.00 
      eastern |     57.32      42.68 |    100.00 
      ashanti |     74.56      25.44 |    100.00 
  brong ahafo |     65.82      34.18 |    100.00 
     northern |     52.10      47.90 |    100.00 
   upper east |     30.36      69.64 |    100.00 
   upper west |     73.50      26.50 |    100.00 
--------------+----------------------+----------
        Total |     60.57      39.43 |    100.00 
. 
. *education
. tab v106 rh_ancparast [iw=wt], row nofreq 

             |    Took intestinal
             | parasite drugs during
     highest |   pregnancy of last
 educational |         birth
       level |        no        yes |     Total
-------------+----------------------+----------
no education |     57.69      42.31 |    100.00 
     primary |     56.64      43.36 |    100.00 
   secondary |     62.49      37.51 |    100.00 
      higher |     72.73      27.27 |    100.00 
-------------+----------------------+----------
       Total |     60.57      39.43 |    100.00 
. 
. *wealth
. tab v190 rh_ancparast [iw=wt], row nofreq 

           |    Took intestinal
           | parasite drugs during
           |   pregnancy of last
    wealth |         birth
     index |        no        yes |     Total
-----------+----------------------+----------
   poorest |     57.31      42.69 |    100.00 
    poorer |     57.96      42.04 |    100.00 
    middle |     57.32      42.68 |    100.00 
    richer |     60.22      39.78 |    100.00 
   richest |     70.67      29.33 |    100.00 
-----------+----------------------+----------
     Total |     60.57      39.43 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //told of pregnancy complications
. 
. *residence
. tab v025 rh_ancprgcomp [iw=wt], row nofreq 

           | Informed of pregnancy
   type of | complications during
  place of |       ANC visit
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |     13.03      86.97 |    100.00 
     rural |     18.76      81.24 |    100.00 
-----------+----------------------+----------
     Total |     16.08      83.92 |    100.00 
. 
. *region
. tab v024 rh_ancprgcomp [iw=wt], row nofreq 

              | Informed of pregnancy
              | complications during
              |       ANC visit
       region |         0          1 |     Total
--------------+----------------------+----------
      western |     16.37      83.63 |    100.00 
      central |     10.29      89.71 |    100.00 
greater accra |      5.47      94.53 |    100.00 
        volta |     10.58      89.42 |    100.00 
      eastern |     24.21      75.79 |    100.00 
      ashanti |     26.07      73.93 |    100.00 
  brong ahafo |     23.80      76.20 |    100.00 
     northern |      7.37      92.63 |    100.00 
   upper east |      7.43      92.57 |    100.00 
   upper west |     46.46      53.54 |    100.00 
--------------+----------------------+----------
        Total |     16.08      83.92 |    100.00 
. 
. *education
. tab v106 rh_ancprgcomp [iw=wt], row nofreq 

             | Informed of pregnancy
     highest | complications during
 educational |       ANC visit
       level |         0          1 |     Total
-------------+----------------------+----------
no education |     16.75      83.25 |    100.00 
     primary |     20.74      79.26 |    100.00 
   secondary |     14.56      85.44 |    100.00 
      higher |      9.86      90.14 |    100.00 
-------------+----------------------+----------
       Total |     16.08      83.92 |    100.00 
. 
. *wealth
. tab v190 rh_ancprgcomp [iw=wt], row nofreq 

           | Informed of pregnancy
           | complications during
    wealth |       ANC visit
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |     20.18      79.82 |    100.00 
    poorer |     21.18      78.82 |    100.00 
    middle |     16.99      83.01 |    100.00 
    richer |     13.29      86.71 |    100.00 
   richest |      8.54      91.46 |    100.00 
-----------+----------------------+----------
     Total |     16.08      83.92 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //blood pressure was taken during ANC visit
. 
. *residence
. tab v025 rh_ancbldpres [iw=wt], row nofreq 

           |  Blood pressure was
   type of |   taken during ANC
  place of |         visit
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |      0.60      99.40 |    100.00 
     rural |      1.65      98.35 |    100.00 
-----------+----------------------+----------
     Total |      1.16      98.84 |    100.00 
. 
. *region
. tab v024 rh_ancbldpres [iw=wt], row nofreq 

              |  Blood pressure was
              |   taken during ANC
              |         visit
       region |         0          1 |     Total
--------------+----------------------+----------
      western |      1.42      98.58 |    100.00 
      central |      0.33      99.67 |    100.00 
greater accra |      0.34      99.66 |    100.00 
        volta |      1.50      98.50 |    100.00 
      eastern |      1.71      98.29 |    100.00 
      ashanti |      0.37      99.63 |    100.00 
  brong ahafo |      1.05      98.95 |    100.00 
     northern |      4.14      95.86 |    100.00 
   upper east |      0.21      99.79 |    100.00 
   upper west |      0.82      99.18 |    100.00 
--------------+----------------------+----------
        Total |      1.16      98.84 |    100.00 
. 
. *education
. tab v106 rh_ancbldpres [iw=wt], row nofreq 

             |  Blood pressure was
     highest |   taken during ANC
 educational |         visit
       level |         0          1 |     Total
-------------+----------------------+----------
no education |      2.29      97.71 |    100.00 
     primary |      0.95      99.05 |    100.00 
   secondary |      0.79      99.21 |    100.00 
      higher |      0.00     100.00 |    100.00 
-------------+----------------------+----------
       Total |      1.16      98.84 |    100.00 
. 
. *wealth
. tab v190 rh_ancbldpres [iw=wt], row nofreq 

           |  Blood pressure was
           |   taken during ANC
    wealth |         visit
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |      3.05      96.95 |    100.00 
    poorer |      1.02      98.98 |    100.00 
    middle |      0.77      99.23 |    100.00 
    richer |      0.51      99.49 |    100.00 
   richest |      0.41      99.59 |    100.00 
-----------+----------------------+----------
     Total |      1.16      98.84 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //urine sample taken during ANC visit
. 
. *residence
. tab v025 rh_ancurine [iw=wt], row nofreq 

           |   Urine sample was
   type of |   taken during ANC
  place of |         visit
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |      0.63      99.37 |    100.00 
     rural |      4.48      95.52 |    100.00 
-----------+----------------------+----------
     Total |      2.68      97.32 |    100.00 
. 
. *region
. tab v024 rh_ancurine [iw=wt], row nofreq 

              |   Urine sample was
              |   taken during ANC
              |         visit
       region |         0          1 |     Total
--------------+----------------------+----------
      western |      1.86      98.14 |    100.00 
      central |      0.16      99.84 |    100.00 
greater accra |      0.37      99.63 |    100.00 
        volta |      1.79      98.21 |    100.00 
      eastern |      1.15      98.85 |    100.00 
      ashanti |      0.00     100.00 |    100.00 
  brong ahafo |      0.72      99.28 |    100.00 
     northern |     17.25      82.75 |    100.00 
   upper east |      0.97      99.03 |    100.00 
   upper west |      6.01      93.99 |    100.00 
--------------+----------------------+----------
        Total |      2.68      97.32 |    100.00 
. 
. *education
. tab v106 rh_ancurine [iw=wt], row nofreq 

             |   Urine sample was
     highest |   taken during ANC
 educational |         visit
       level |         0          1 |     Total
-------------+----------------------+----------
no education |      7.80      92.20 |    100.00 
     primary |      1.63      98.37 |    100.00 
   secondary |      0.78      99.22 |    100.00 
      higher |      0.06      99.94 |    100.00 
-------------+----------------------+----------
       Total |      2.68      97.32 |    100.00 
. 
. *wealth
. tab v190 rh_ancurine [iw=wt], row nofreq 

           |   Urine sample was
           |   taken during ANC
    wealth |         visit
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |      9.38      90.62 |    100.00 
    poorer |      2.90      97.10 |    100.00 
    middle |      0.35      99.65 |    100.00 
    richer |      0.63      99.37 |    100.00 
   richest |      0.00     100.00 |    100.00 
-----------+----------------------+----------
     Total |      2.68      97.32 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //blood sample taken during ANC visit
. 
. *residence
. tab v025 rh_ancbldsamp [iw=wt], row nofreq 

           |   Blood sample was
   type of |   taken during ANC
  place of |         visit
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |      0.54      99.46 |    100.00 
     rural |      3.02      96.98 |    100.00 
-----------+----------------------+----------
     Total |      1.86      98.14 |    100.00 
. 
. *region
. tab v024 rh_ancbldsamp [iw=wt], row nofreq 

              |   Blood sample was
              |   taken during ANC
              |         visit
       region |         0          1 |     Total
--------------+----------------------+----------
      western |      1.03      98.97 |    100.00 
      central |      2.86      97.14 |    100.00 
greater accra |      0.37      99.63 |    100.00 
        volta |      1.67      98.33 |    100.00 
      eastern |      1.92      98.08 |    100.00 
      ashanti |      0.30      99.70 |    100.00 
  brong ahafo |      0.85      99.15 |    100.00 
     northern |      7.47      92.53 |    100.00 
   upper east |      0.99      99.01 |    100.00 
   upper west |      2.80      97.20 |    100.00 
--------------+----------------------+----------
        Total |      1.86      98.14 |    100.00 
. 
. *education
. tab v106 rh_ancbldsamp [iw=wt], row nofreq 

             |   Blood sample was
     highest |   taken during ANC
 educational |         visit
       level |         0          1 |     Total
-------------+----------------------+----------
no education |      3.40      96.60 |    100.00 
     primary |      1.78      98.22 |    100.00 
   secondary |      1.30      98.70 |    100.00 
      higher |      0.00     100.00 |    100.00 
-------------+----------------------+----------
       Total |      1.86      98.14 |    100.00 
. 
. *wealth
. tab v190 rh_ancbldsamp [iw=wt], row nofreq 

           |   Blood sample was
           |   taken during ANC
    wealth |         visit
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |      4.83      95.17 |    100.00 
    poorer |      2.10      97.90 |    100.00 
    middle |      1.71      98.29 |    100.00 
    richer |      0.35      99.65 |    100.00 
   richest |      0.23      99.77 |    100.00 
-----------+----------------------+----------
     Total |      1.86      98.14 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //had 2+ tetanus injections
. 
. *residence
. tab v025 rh_anctoxinj [iw=wt], row nofreq 

           |  Received 2+ tetanus
   type of |   injections during
  place of |    last pregnancy
 residence |        no        yes |     Total
-----------+----------------------+----------
     urban |     40.40      59.60 |    100.00 
     rural |     45.08      54.92 |    100.00 
-----------+----------------------+----------
     Total |     42.92      57.08 |    100.00 
. 
. *region
. tab v024 rh_anctoxinj [iw=wt], row nofreq 

              |  Received 2+ tetanus
              |   injections during
              |    last pregnancy
       region |        no        yes |     Total
--------------+----------------------+----------
      western |     31.71      68.29 |    100.00 
      central |     31.05      68.95 |    100.00 
greater accra |     45.00      55.00 |    100.00 
        volta |     47.98      52.02 |    100.00 
      eastern |     49.33      50.67 |    100.00 
      ashanti |     40.65      59.35 |    100.00 
  brong ahafo |     42.95      57.05 |    100.00 
     northern |     52.83      47.17 |    100.00 
   upper east |     43.16      56.84 |    100.00 
   upper west |     56.83      43.17 |    100.00 
--------------+----------------------+----------
        Total |     42.92      57.08 |    100.00 
. 
. *education
. tab v106 rh_anctoxinj [iw=wt], row nofreq 

             |  Received 2+ tetanus
     highest |   injections during
 educational |    last pregnancy
       level |        no        yes |     Total
-------------+----------------------+----------
no education |     48.88      51.12 |    100.00 
     primary |     49.23      50.77 |    100.00 
   secondary |     38.02      61.98 |    100.00 
      higher |     35.18      64.82 |    100.00 
-------------+----------------------+----------
       Total |     42.92      57.08 |    100.00 
. 
. *wealth
. tab v190 rh_anctoxinj [iw=wt], row nofreq 

           |  Received 2+ tetanus
           |   injections during
    wealth |    last pregnancy
     index |        no        yes |     Total
-----------+----------------------+----------
   poorest |     52.90      47.10 |    100.00 
    poorer |     46.32      53.68 |    100.00 
    middle |     39.91      60.09 |    100.00 
    richer |     41.85      58.15 |    100.00 
   richest |     32.57      67.43 |    100.00 
-----------+----------------------+----------
     Total |     42.92      57.08 |    100.00 
. 
. * output to excel
. */
. ****************************************************
. //protected against neonatal tetanus
. 
. *residence
. tab v025 rh_ancneotet [iw=wt], row nofreq 

   type of |   Protected against
  place of |   neonatal tetanus
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |     19.93      80.07 |    100.00 
     rural |     23.82      76.18 |    100.00 
-----------+----------------------+----------
     Total |     22.02      77.98 |    100.00 
. 
. *region
. tab v024 rh_ancneotet [iw=wt], row nofreq 

              |   Protected against
              |   neonatal tetanus
       region |         0          1 |     Total
--------------+----------------------+----------
      western |     17.97      82.03 |    100.00 
      central |     16.00      84.00 |    100.00 
greater accra |     21.79      78.21 |    100.00 
        volta |     19.19      80.81 |    100.00 
      eastern |     31.19      68.81 |    100.00 
      ashanti |     18.25      81.75 |    100.00 
  brong ahafo |     16.30      83.70 |    100.00 
     northern |     31.01      68.99 |    100.00 
   upper east |     32.04      67.96 |    100.00 
   upper west |     29.08      70.92 |    100.00 
--------------+----------------------+----------
        Total |     22.02      77.98 |    100.00 
. 
. *education
. tab v106 rh_ancneotet [iw=wt], row nofreq 

     highest |   Protected against
 educational |   neonatal tetanus
       level |         0          1 |     Total
-------------+----------------------+----------
no education |     27.56      72.44 |    100.00 
     primary |     26.75      73.25 |    100.00 
   secondary |     18.14      81.86 |    100.00 
      higher |     12.48      87.52 |    100.00 
-------------+----------------------+----------
       Total |     22.02      77.98 |    100.00 
. 
. *wealth
. tab v190 rh_ancneotet [iw=wt], row nofreq 

           |   Protected against
    wealth |   neonatal tetanus
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |     31.79      68.21 |    100.00 
    poorer |     23.27      76.73 |    100.00 
    middle |     21.14      78.86 |    100.00 
    richer |     20.28      79.72 |    100.00 
   richest |     12.66      87.34 |    100.00 
-----------+----------------------+----------
     Total |     22.02      77.98 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_anc_pv using ch9tables_ANCvists.xls [iw=wt] , c(row) f(1) replace 

Table output written to: ch9tables_ANCvists.xls

        Person providing assistance during ANC                                  
        Doctor  Nurse/midwife   Other health worker     TBA/other/relative      No ANC  Total
        %       %       %       %       %       %
type of place of residence                                              
urban   29.0    66.9    2.8     0.0     1.3     100.0
rural   15.5    70.5    10.2    0.2     3.6     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

highest educational level                                               
no education    8.8     72.6    12.7    0.3     5.7     100.0
primary 19.9    69.8    6.2     0.0     4.1     100.0
secondary       26.8    68.0    4.5     0.1     0.6     100.0
higher  46.7    52.1    1.2     0.0     0.0     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

region                                          
western 14.0    77.1    8.2     0.0     0.7     100.0
central 24.7    66.9    6.4     0.0     2.0     100.0
greater accra   34.3    61.9    2.3     0.1     1.4     100.0
volta   19.9    63.2    10.8    0.3     5.8     100.0
eastern 27.4    64.6    4.7     0.2     3.2     100.0
ashanti 34.6    63.0    1.1     0.0     1.2     100.0
brong ahafo     10.1    85.2    3.6     0.0     1.1     100.0
northern        3.2     72.0    16.8    0.5     7.5     100.0
upper east      5.7     86.3    6.5     0.0     1.6     100.0
upper west      6.7     60.0    31.6    0.0     1.7     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

wealth index                                            
poorest 6.1     72.1    15.8    0.4     5.7     100.0
poorer  14.4    73.5    7.7     0.1     4.3     100.0
middle  21.4    71.5    5.3     0.1     1.6     100.0
richer  25.7    70.4    3.2     0.0     0.7     100.0
richest 42.8    55.8    1.1     0.0     0.3     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0
. tabout v025 v106 v024 v190 rh_anc_pvskill using ch9tables_ANCvists.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCvists.xls

        Person providing assistance during ANC                                  
        Doctor  Nurse/midwife   Other health worker     TBA/other/relative      No ANC  Total
        %       %       %       %       %       %
type of place of residence                                              
urban   29.0    66.9    2.8     0.0     1.3     100.0
rural   15.5    70.5    10.2    0.2     3.6     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

highest educational level                                               
no education    8.8     72.6    12.7    0.3     5.7     100.0
primary 19.9    69.8    6.2     0.0     4.1     100.0
secondary       26.8    68.0    4.5     0.1     0.6     100.0
higher  46.7    52.1    1.2     0.0     0.0     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

region                                          
western 14.0    77.1    8.2     0.0     0.7     100.0
central 24.7    66.9    6.4     0.0     2.0     100.0
greater accra   34.3    61.9    2.3     0.1     1.4     100.0
volta   19.9    63.2    10.8    0.3     5.8     100.0
eastern 27.4    64.6    4.7     0.2     3.2     100.0
ashanti 34.6    63.0    1.1     0.0     1.2     100.0
brong ahafo     10.1    85.2    3.6     0.0     1.1     100.0
northern        3.2     72.0    16.8    0.5     7.5     100.0
upper east      5.7     86.3    6.5     0.0     1.6     100.0
upper west      6.7     60.0    31.6    0.0     1.7     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

wealth index                                            
poorest 6.1     72.1    15.8    0.4     5.7     100.0
poorer  14.4    73.5    7.7     0.1     4.3     100.0
middle  21.4    71.5    5.3     0.1     1.6     100.0
richer  25.7    70.4    3.2     0.0     0.7     100.0
richest 42.8    55.8    1.1     0.0     0.3     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

        Skilled assistance during ANC           
        Unskilled provider      Skilled provider        Total
        %       %       %
type of place of residence                      
urban   1.4     98.6    100.0
rural   3.8     96.2    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    5.9     94.1    100.0
primary 4.1     95.9    100.0
secondary       0.7     99.3    100.0
higher  0.0     100.0   100.0
Total   2.7     97.3    100.0

region                  
western 0.7     99.3    100.0
central 2.0     98.0    100.0
greater accra   1.5     98.5    100.0
volta   6.1     93.9    100.0
eastern 3.4     96.6    100.0
ashanti 1.2     98.8    100.0
brong ahafo     1.1     98.9    100.0
northern        8.0     92.0    100.0
upper east      1.6     98.4    100.0
upper west      1.7     98.3    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 6.0     94.0    100.0
poorer  4.3     95.7    100.0
middle  1.7     98.3    100.0
richer  0.7     99.3    100.0
richest 0.3     99.7    100.0
Total   2.7     97.3    100.0
. tabout v025 v106 v024 v190 rh_anc_numvs using ch9tables_ANCvists.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCvists.xls

        Person providing assistance during ANC                                  
        Doctor  Nurse/midwife   Other health worker     TBA/other/relative      No ANC  Total
        %       %       %       %       %       %
type of place of residence                                              
urban   29.0    66.9    2.8     0.0     1.3     100.0
rural   15.5    70.5    10.2    0.2     3.6     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

highest educational level                                               
no education    8.8     72.6    12.7    0.3     5.7     100.0
primary 19.9    69.8    6.2     0.0     4.1     100.0
secondary       26.8    68.0    4.5     0.1     0.6     100.0
higher  46.7    52.1    1.2     0.0     0.0     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

region                                          
western 14.0    77.1    8.2     0.0     0.7     100.0
central 24.7    66.9    6.4     0.0     2.0     100.0
greater accra   34.3    61.9    2.3     0.1     1.4     100.0
volta   19.9    63.2    10.8    0.3     5.8     100.0
eastern 27.4    64.6    4.7     0.2     3.2     100.0
ashanti 34.6    63.0    1.1     0.0     1.2     100.0
brong ahafo     10.1    85.2    3.6     0.0     1.1     100.0
northern        3.2     72.0    16.8    0.5     7.5     100.0
upper east      5.7     86.3    6.5     0.0     1.6     100.0
upper west      6.7     60.0    31.6    0.0     1.7     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

wealth index                                            
poorest 6.1     72.1    15.8    0.4     5.7     100.0
poorer  14.4    73.5    7.7     0.1     4.3     100.0
middle  21.4    71.5    5.3     0.1     1.6     100.0
richer  25.7    70.4    3.2     0.0     0.7     100.0
richest 42.8    55.8    1.1     0.0     0.3     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

        Skilled assistance during ANC           
        Unskilled provider      Skilled provider        Total
        %       %       %
type of place of residence                      
urban   1.4     98.6    100.0
rural   3.8     96.2    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    5.9     94.1    100.0
primary 4.1     95.9    100.0
secondary       0.7     99.3    100.0
higher  0.0     100.0   100.0
Total   2.7     97.3    100.0

region                  
western 0.7     99.3    100.0
central 2.0     98.0    100.0
greater accra   1.5     98.5    100.0
volta   6.1     93.9    100.0
eastern 3.4     96.6    100.0
ashanti 1.2     98.8    100.0
brong ahafo     1.1     98.9    100.0
northern        8.0     92.0    100.0
upper east      1.6     98.4    100.0
upper west      1.7     98.3    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 6.0     94.0    100.0
poorer  4.3     95.7    100.0
middle  1.7     98.3    100.0
richer  0.7     99.3    100.0
richest 0.3     99.7    100.0
Total   2.7     97.3    100.0

        Number of ANC visits                                    
        none            2-3     4+      don't know/missing      Total
        %       %       %       %       %       %
type of place of residence                                              
urban   1.3     0.6     5.4     92.3    0.4     100.0
rural   3.6     1.5     11.3    82.9    0.7     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

highest educational level                                               
no education    5.7     1.9     12.4    79.2    0.9     100.0
primary 4.1     1.6     11.2    82.3    0.8     100.0
secondary       0.6     0.6     6.2     92.4    0.3     100.0
higher  0.0     0.0     1.4     98.6    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

region                                          
western 0.7     1.2     6.0     92.1    0.0     100.0
central 2.0     0.2     6.3     91.1    0.3     100.0
greater accra   1.4     0.8     6.2     91.4    0.2     100.0
volta   5.8     3.3     13.5    77.3    0.1     100.0
eastern 3.2     2.0     17.1    77.4    0.4     100.0
ashanti 1.2     0.0     3.7     93.5    1.5     100.0
brong ahafo     1.1     0.5     7.7     90.3    0.5     100.0
northern        7.5     2.6     16.5    73.0    0.4     100.0
upper east      1.6     0.2     4.0     93.0    1.2     100.0
upper west      1.7     0.2     6.7     91.3    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

wealth index                                            
poorest 5.7     2.2     15.0    76.4    0.7     100.0
poorer  4.3     1.6     11.3    82.1    0.8     100.0
middle  1.6     0.7     10.1    86.8    0.7     100.0
richer  0.7     0.7     4.1     94.1    0.3     100.0
richest 0.3     0.1     1.6     98.1    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0
. tabout v025 v106 v024 v190 rh_anc_moprg using ch9tables_ANCvists.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCvists.xls

        Person providing assistance during ANC                                  
        Doctor  Nurse/midwife   Other health worker     TBA/other/relative      No ANC  Total
        %       %       %       %       %       %
type of place of residence                                              
urban   29.0    66.9    2.8     0.0     1.3     100.0
rural   15.5    70.5    10.2    0.2     3.6     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

highest educational level                                               
no education    8.8     72.6    12.7    0.3     5.7     100.0
primary 19.9    69.8    6.2     0.0     4.1     100.0
secondary       26.8    68.0    4.5     0.1     0.6     100.0
higher  46.7    52.1    1.2     0.0     0.0     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

region                                          
western 14.0    77.1    8.2     0.0     0.7     100.0
central 24.7    66.9    6.4     0.0     2.0     100.0
greater accra   34.3    61.9    2.3     0.1     1.4     100.0
volta   19.9    63.2    10.8    0.3     5.8     100.0
eastern 27.4    64.6    4.7     0.2     3.2     100.0
ashanti 34.6    63.0    1.1     0.0     1.2     100.0
brong ahafo     10.1    85.2    3.6     0.0     1.1     100.0
northern        3.2     72.0    16.8    0.5     7.5     100.0
upper east      5.7     86.3    6.5     0.0     1.6     100.0
upper west      6.7     60.0    31.6    0.0     1.7     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

wealth index                                            
poorest 6.1     72.1    15.8    0.4     5.7     100.0
poorer  14.4    73.5    7.7     0.1     4.3     100.0
middle  21.4    71.5    5.3     0.1     1.6     100.0
richer  25.7    70.4    3.2     0.0     0.7     100.0
richest 42.8    55.8    1.1     0.0     0.3     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

        Skilled assistance during ANC           
        Unskilled provider      Skilled provider        Total
        %       %       %
type of place of residence                      
urban   1.4     98.6    100.0
rural   3.8     96.2    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    5.9     94.1    100.0
primary 4.1     95.9    100.0
secondary       0.7     99.3    100.0
higher  0.0     100.0   100.0
Total   2.7     97.3    100.0

region                  
western 0.7     99.3    100.0
central 2.0     98.0    100.0
greater accra   1.5     98.5    100.0
volta   6.1     93.9    100.0
eastern 3.4     96.6    100.0
ashanti 1.2     98.8    100.0
brong ahafo     1.1     98.9    100.0
northern        8.0     92.0    100.0
upper east      1.6     98.4    100.0
upper west      1.7     98.3    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 6.0     94.0    100.0
poorer  4.3     95.7    100.0
middle  1.7     98.3    100.0
richer  0.7     99.3    100.0
richest 0.3     99.7    100.0
Total   2.7     97.3    100.0

        Number of ANC visits                                    
        none            2-3     4+      don't know/missing      Total
        %       %       %       %       %       %
type of place of residence                                              
urban   1.3     0.6     5.4     92.3    0.4     100.0
rural   3.6     1.5     11.3    82.9    0.7     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

highest educational level                                               
no education    5.7     1.9     12.4    79.2    0.9     100.0
primary 4.1     1.6     11.2    82.3    0.8     100.0
secondary       0.6     0.6     6.2     92.4    0.3     100.0
higher  0.0     0.0     1.4     98.6    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

region                                          
western 0.7     1.2     6.0     92.1    0.0     100.0
central 2.0     0.2     6.3     91.1    0.3     100.0
greater accra   1.4     0.8     6.2     91.4    0.2     100.0
volta   5.8     3.3     13.5    77.3    0.1     100.0
eastern 3.2     2.0     17.1    77.4    0.4     100.0
ashanti 1.2     0.0     3.7     93.5    1.5     100.0
brong ahafo     1.1     0.5     7.7     90.3    0.5     100.0
northern        7.5     2.6     16.5    73.0    0.4     100.0
upper east      1.6     0.2     4.0     93.0    1.2     100.0
upper west      1.7     0.2     6.7     91.3    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

wealth index                                            
poorest 5.7     2.2     15.0    76.4    0.7     100.0
poorer  4.3     1.6     11.3    82.1    0.8     100.0
middle  1.6     0.7     10.1    86.8    0.7     100.0
richer  0.7     0.7     4.1     94.1    0.3     100.0
richest 0.3     0.1     1.6     98.1    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

        Number of months pregnant at  time of first ANC visit                                           
        no anc  <4      4-5     6-7     8+      don't know/missing      Total
        %       %       %       %       %       %       %
type of place of residence                                                      
urban   1.3     67.8    25.3    5.2     0.3     0.0     100.0
rural   3.6     60.7    28.9    6.1     0.6     0.1     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

highest educational level                                                       
no education    5.7     53.8    32.0    8.1     0.3     0.1     100.0
primary 4.1     59.3    28.9    6.4     1.3     0.0     100.0
secondary       0.6     68.9    25.5    4.6     0.3     0.0     100.0
higher  0.0     88.9    11.0    0.1     0.0     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

region                                                  
western 0.7     77.2    17.1    4.4     0.6     0.0     100.0
central 2.0     64.7    29.0    3.6     0.7     0.0     100.0
greater accra   1.4     67.0    26.5    5.0     0.1     0.0     100.0
volta   5.8     61.6    24.5    6.5     1.6     0.0     100.0
eastern 3.2     60.7    27.8    7.3     1.0     0.0     100.0
ashanti 1.2     69.6    24.3    4.7     0.2     0.0     100.0
brong ahafo     1.1     64.1    27.8    6.7     0.3     0.0     100.0
northern        7.5     39.6    41.9    10.2    0.5     0.3     100.0
upper east      1.6     70.8    24.7    2.9     0.0     0.0     100.0
upper west      1.7     68.3    26.8    3.0     0.2     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

wealth index                                                    
poorest 5.7     52.8    31.8    8.8     0.8     0.2     100.0
poorer  4.3     55.2    32.7    7.0     0.8     0.0     100.0
middle  1.6     63.5    29.0    5.3     0.5     0.0     100.0
richer  0.7     70.2    23.8    4.9     0.3     0.0     100.0
richest 0.3     79.8    18.0    1.9     0.1     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0
. tabout rh_ancmedian rh_ancmedian_urban rh_ancmedian_rural using ch9tables_ANCvists.xls [iw=wt] , oneway cells(cell)
>  append 

Table output written to: ch9tables_ANCvists.xls

        Person providing assistance during ANC                                  
        Doctor  Nurse/midwife   Other health worker     TBA/other/relative      No ANC  Total
        %       %       %       %       %       %
type of place of residence                                              
urban   29.0    66.9    2.8     0.0     1.3     100.0
rural   15.5    70.5    10.2    0.2     3.6     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

highest educational level                                               
no education    8.8     72.6    12.7    0.3     5.7     100.0
primary 19.9    69.8    6.2     0.0     4.1     100.0
secondary       26.8    68.0    4.5     0.1     0.6     100.0
higher  46.7    52.1    1.2     0.0     0.0     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

region                                          
western 14.0    77.1    8.2     0.0     0.7     100.0
central 24.7    66.9    6.4     0.0     2.0     100.0
greater accra   34.3    61.9    2.3     0.1     1.4     100.0
volta   19.9    63.2    10.8    0.3     5.8     100.0
eastern 27.4    64.6    4.7     0.2     3.2     100.0
ashanti 34.6    63.0    1.1     0.0     1.2     100.0
brong ahafo     10.1    85.2    3.6     0.0     1.1     100.0
northern        3.2     72.0    16.8    0.5     7.5     100.0
upper east      5.7     86.3    6.5     0.0     1.6     100.0
upper west      6.7     60.0    31.6    0.0     1.7     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

wealth index                                            
poorest 6.1     72.1    15.8    0.4     5.7     100.0
poorer  14.4    73.5    7.7     0.1     4.3     100.0
middle  21.4    71.5    5.3     0.1     1.6     100.0
richer  25.7    70.4    3.2     0.0     0.7     100.0
richest 42.8    55.8    1.1     0.0     0.3     100.0
Total   21.7    68.8    6.8     0.1     2.6     100.0

        Skilled assistance during ANC           
        Unskilled provider      Skilled provider        Total
        %       %       %
type of place of residence                      
urban   1.4     98.6    100.0
rural   3.8     96.2    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    5.9     94.1    100.0
primary 4.1     95.9    100.0
secondary       0.7     99.3    100.0
higher  0.0     100.0   100.0
Total   2.7     97.3    100.0

region                  
western 0.7     99.3    100.0
central 2.0     98.0    100.0
greater accra   1.5     98.5    100.0
volta   6.1     93.9    100.0
eastern 3.4     96.6    100.0
ashanti 1.2     98.8    100.0
brong ahafo     1.1     98.9    100.0
northern        8.0     92.0    100.0
upper east      1.6     98.4    100.0
upper west      1.7     98.3    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 6.0     94.0    100.0
poorer  4.3     95.7    100.0
middle  1.7     98.3    100.0
richer  0.7     99.3    100.0
richest 0.3     99.7    100.0
Total   2.7     97.3    100.0

        Number of ANC visits                                    
        none            2-3     4+      don't know/missing      Total
        %       %       %       %       %       %
type of place of residence                                              
urban   1.3     0.6     5.4     92.3    0.4     100.0
rural   3.6     1.5     11.3    82.9    0.7     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

highest educational level                                               
no education    5.7     1.9     12.4    79.2    0.9     100.0
primary 4.1     1.6     11.2    82.3    0.8     100.0
secondary       0.6     0.6     6.2     92.4    0.3     100.0
higher  0.0     0.0     1.4     98.6    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

region                                          
western 0.7     1.2     6.0     92.1    0.0     100.0
central 2.0     0.2     6.3     91.1    0.3     100.0
greater accra   1.4     0.8     6.2     91.4    0.2     100.0
volta   5.8     3.3     13.5    77.3    0.1     100.0
eastern 3.2     2.0     17.1    77.4    0.4     100.0
ashanti 1.2     0.0     3.7     93.5    1.5     100.0
brong ahafo     1.1     0.5     7.7     90.3    0.5     100.0
northern        7.5     2.6     16.5    73.0    0.4     100.0
upper east      1.6     0.2     4.0     93.0    1.2     100.0
upper west      1.7     0.2     6.7     91.3    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

wealth index                                            
poorest 5.7     2.2     15.0    76.4    0.7     100.0
poorer  4.3     1.6     11.3    82.1    0.8     100.0
middle  1.6     0.7     10.1    86.8    0.7     100.0
richer  0.7     0.7     4.1     94.1    0.3     100.0
richest 0.3     0.1     1.6     98.1    0.0     100.0
Total   2.6     1.1     8.6     87.3    0.5     100.0

        Number of months pregnant at  time of first ANC visit                                           
        no anc  <4      4-5     6-7     8+      don't know/missing      Total
        %       %       %       %       %       %       %
type of place of residence                                                      
urban   1.3     67.8    25.3    5.2     0.3     0.0     100.0
rural   3.6     60.7    28.9    6.1     0.6     0.1     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

highest educational level                                                       
no education    5.7     53.8    32.0    8.1     0.3     0.1     100.0
primary 4.1     59.3    28.9    6.4     1.3     0.0     100.0
secondary       0.6     68.9    25.5    4.6     0.3     0.0     100.0
higher  0.0     88.9    11.0    0.1     0.0     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

region                                                  
western 0.7     77.2    17.1    4.4     0.6     0.0     100.0
central 2.0     64.7    29.0    3.6     0.7     0.0     100.0
greater accra   1.4     67.0    26.5    5.0     0.1     0.0     100.0
volta   5.8     61.6    24.5    6.5     1.6     0.0     100.0
eastern 3.2     60.7    27.8    7.3     1.0     0.0     100.0
ashanti 1.2     69.6    24.3    4.7     0.2     0.0     100.0
brong ahafo     1.1     64.1    27.8    6.7     0.3     0.0     100.0
northern        7.5     39.6    41.9    10.2    0.5     0.3     100.0
upper east      1.6     70.8    24.7    2.9     0.0     0.0     100.0
upper west      1.7     68.3    26.8    3.0     0.2     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

wealth index                                                    
poorest 5.7     52.8    31.8    8.8     0.8     0.2     100.0
poorer  4.3     55.2    32.7    7.0     0.8     0.0     100.0
middle  1.6     63.5    29.0    5.3     0.5     0.0     100.0
richer  0.7     70.2    23.8    4.9     0.3     0.0     100.0
richest 0.3     79.8    18.0    1.9     0.1     0.0     100.0
Total   2.6     64.0    27.2    5.7     0.5     0.0     100.0

        %
Total- Median months pregnant at first visit    
3.57    100.0
Total   100.0

Urban- Median months pregnant at first visit    
3.49    100.0
Total   100.0

Rural- Median months pregnant at first visit    
3.65    100.0
Total   100.0
. tabout v025 v106 v024 v190 rh_anciron using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) replace 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0
. tabout v025 v106 v024 v190 rh_ancparast using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0
. tabout v025 v106 v024 v190 rh_ancprgcomp using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0
. tabout v025 v106 v024 v190 rh_ancbldpres using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0

        Blood pressure was taken during ANC visit               
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   1.7     98.3    100.0
Total   1.2     98.8    100.0

highest educational level                       
no education    2.3     97.7    100.0
primary 0.9     99.1    100.0
secondary       0.8     99.2    100.0
higher  0.0     100.0   100.0
Total   1.2     98.8    100.0

region                  
western 1.4     98.6    100.0
central 0.3     99.7    100.0
greater accra   0.3     99.7    100.0
volta   1.5     98.5    100.0
eastern 1.7     98.3    100.0
ashanti 0.4     99.6    100.0
brong ahafo     1.1     98.9    100.0
northern        4.1     95.9    100.0
upper east      0.2     99.8    100.0
upper west      0.8     99.2    100.0
Total   1.2     98.8    100.0

wealth index                    
poorest 3.0     97.0    100.0
poorer  1.0     99.0    100.0
middle  0.8     99.2    100.0
richer  0.5     99.5    100.0
richest 0.4     99.6    100.0
Total   1.2     98.8    100.0
. tabout v025 v106 v024 v190 rh_ancurine using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0

        Blood pressure was taken during ANC visit               
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   1.7     98.3    100.0
Total   1.2     98.8    100.0

highest educational level                       
no education    2.3     97.7    100.0
primary 0.9     99.1    100.0
secondary       0.8     99.2    100.0
higher  0.0     100.0   100.0
Total   1.2     98.8    100.0

region                  
western 1.4     98.6    100.0
central 0.3     99.7    100.0
greater accra   0.3     99.7    100.0
volta   1.5     98.5    100.0
eastern 1.7     98.3    100.0
ashanti 0.4     99.6    100.0
brong ahafo     1.1     98.9    100.0
northern        4.1     95.9    100.0
upper east      0.2     99.8    100.0
upper west      0.8     99.2    100.0
Total   1.2     98.8    100.0

wealth index                    
poorest 3.0     97.0    100.0
poorer  1.0     99.0    100.0
middle  0.8     99.2    100.0
richer  0.5     99.5    100.0
richest 0.4     99.6    100.0
Total   1.2     98.8    100.0

        Urine sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   4.5     95.5    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    7.8     92.2    100.0
primary 1.6     98.4    100.0
secondary       0.8     99.2    100.0
higher  0.1     99.9    100.0
Total   2.7     97.3    100.0

region                  
western 1.9     98.1    100.0
central 0.2     99.8    100.0
greater accra   0.4     99.6    100.0
volta   1.8     98.2    100.0
eastern 1.2     98.8    100.0
ashanti 0.0     100.0   100.0
brong ahafo     0.7     99.3    100.0
northern        17.3    82.7    100.0
upper east      1.0     99.0    100.0
upper west      6.0     94.0    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 9.4     90.6    100.0
poorer  2.9     97.1    100.0
middle  0.3     99.7    100.0
richer  0.6     99.4    100.0
richest 0.0     100.0   100.0
Total   2.7     97.3    100.0
. tabout v025 v106 v024 v190 rh_ancbldsamp using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0

        Blood pressure was taken during ANC visit               
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   1.7     98.3    100.0
Total   1.2     98.8    100.0

highest educational level                       
no education    2.3     97.7    100.0
primary 0.9     99.1    100.0
secondary       0.8     99.2    100.0
higher  0.0     100.0   100.0
Total   1.2     98.8    100.0

region                  
western 1.4     98.6    100.0
central 0.3     99.7    100.0
greater accra   0.3     99.7    100.0
volta   1.5     98.5    100.0
eastern 1.7     98.3    100.0
ashanti 0.4     99.6    100.0
brong ahafo     1.1     98.9    100.0
northern        4.1     95.9    100.0
upper east      0.2     99.8    100.0
upper west      0.8     99.2    100.0
Total   1.2     98.8    100.0

wealth index                    
poorest 3.0     97.0    100.0
poorer  1.0     99.0    100.0
middle  0.8     99.2    100.0
richer  0.5     99.5    100.0
richest 0.4     99.6    100.0
Total   1.2     98.8    100.0

        Urine sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   4.5     95.5    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    7.8     92.2    100.0
primary 1.6     98.4    100.0
secondary       0.8     99.2    100.0
higher  0.1     99.9    100.0
Total   2.7     97.3    100.0

region                  
western 1.9     98.1    100.0
central 0.2     99.8    100.0
greater accra   0.4     99.6    100.0
volta   1.8     98.2    100.0
eastern 1.2     98.8    100.0
ashanti 0.0     100.0   100.0
brong ahafo     0.7     99.3    100.0
northern        17.3    82.7    100.0
upper east      1.0     99.0    100.0
upper west      6.0     94.0    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 9.4     90.6    100.0
poorer  2.9     97.1    100.0
middle  0.3     99.7    100.0
richer  0.6     99.4    100.0
richest 0.0     100.0   100.0
Total   2.7     97.3    100.0

        Blood sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.5     99.5    100.0
rural   3.0     97.0    100.0
Total   1.9     98.1    100.0

highest educational level                       
no education    3.4     96.6    100.0
primary 1.8     98.2    100.0
secondary       1.3     98.7    100.0
higher  0.0     100.0   100.0
Total   1.9     98.1    100.0

region                  
western 1.0     99.0    100.0
central 2.9     97.1    100.0
greater accra   0.4     99.6    100.0
volta   1.7     98.3    100.0
eastern 1.9     98.1    100.0
ashanti 0.3     99.7    100.0
brong ahafo     0.8     99.2    100.0
northern        7.5     92.5    100.0
upper east      1.0     99.0    100.0
upper west      2.8     97.2    100.0
Total   1.9     98.1    100.0

wealth index                    
poorest 4.8     95.2    100.0
poorer  2.1     97.9    100.0
middle  1.7     98.3    100.0
richer  0.3     99.7    100.0
richest 0.2     99.8    100.0
Total   1.9     98.1    100.0
. tabout v025 v106 v024 v190 rh_anctoxinj using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0

        Blood pressure was taken during ANC visit               
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   1.7     98.3    100.0
Total   1.2     98.8    100.0

highest educational level                       
no education    2.3     97.7    100.0
primary 0.9     99.1    100.0
secondary       0.8     99.2    100.0
higher  0.0     100.0   100.0
Total   1.2     98.8    100.0

region                  
western 1.4     98.6    100.0
central 0.3     99.7    100.0
greater accra   0.3     99.7    100.0
volta   1.5     98.5    100.0
eastern 1.7     98.3    100.0
ashanti 0.4     99.6    100.0
brong ahafo     1.1     98.9    100.0
northern        4.1     95.9    100.0
upper east      0.2     99.8    100.0
upper west      0.8     99.2    100.0
Total   1.2     98.8    100.0

wealth index                    
poorest 3.0     97.0    100.0
poorer  1.0     99.0    100.0
middle  0.8     99.2    100.0
richer  0.5     99.5    100.0
richest 0.4     99.6    100.0
Total   1.2     98.8    100.0

        Urine sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   4.5     95.5    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    7.8     92.2    100.0
primary 1.6     98.4    100.0
secondary       0.8     99.2    100.0
higher  0.1     99.9    100.0
Total   2.7     97.3    100.0

region                  
western 1.9     98.1    100.0
central 0.2     99.8    100.0
greater accra   0.4     99.6    100.0
volta   1.8     98.2    100.0
eastern 1.2     98.8    100.0
ashanti 0.0     100.0   100.0
brong ahafo     0.7     99.3    100.0
northern        17.3    82.7    100.0
upper east      1.0     99.0    100.0
upper west      6.0     94.0    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 9.4     90.6    100.0
poorer  2.9     97.1    100.0
middle  0.3     99.7    100.0
richer  0.6     99.4    100.0
richest 0.0     100.0   100.0
Total   2.7     97.3    100.0

        Blood sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.5     99.5    100.0
rural   3.0     97.0    100.0
Total   1.9     98.1    100.0

highest educational level                       
no education    3.4     96.6    100.0
primary 1.8     98.2    100.0
secondary       1.3     98.7    100.0
higher  0.0     100.0   100.0
Total   1.9     98.1    100.0

region                  
western 1.0     99.0    100.0
central 2.9     97.1    100.0
greater accra   0.4     99.6    100.0
volta   1.7     98.3    100.0
eastern 1.9     98.1    100.0
ashanti 0.3     99.7    100.0
brong ahafo     0.8     99.2    100.0
northern        7.5     92.5    100.0
upper east      1.0     99.0    100.0
upper west      2.8     97.2    100.0
Total   1.9     98.1    100.0

wealth index                    
poorest 4.8     95.2    100.0
poorer  2.1     97.9    100.0
middle  1.7     98.3    100.0
richer  0.3     99.7    100.0
richest 0.2     99.8    100.0
Total   1.9     98.1    100.0

        Received 2+ tetanus injections during last pregnancy            
        no      yes     Total
        %       %       %
type of place of residence                      
urban   40.4    59.6    100.0
rural   45.1    54.9    100.0
Total   42.9    57.1    100.0

highest educational level                       
no education    48.9    51.1    100.0
primary 49.2    50.8    100.0
secondary       38.0    62.0    100.0
higher  35.2    64.8    100.0
Total   42.9    57.1    100.0

region                  
western 31.7    68.3    100.0
central 31.1    68.9    100.0
greater accra   45.0    55.0    100.0
volta   48.0    52.0    100.0
eastern 49.3    50.7    100.0
ashanti 40.7    59.3    100.0
brong ahafo     43.0    57.0    100.0
northern        52.8    47.2    100.0
upper east      43.2    56.8    100.0
upper west      56.8    43.2    100.0
Total   42.9    57.1    100.0

wealth index                    
poorest 52.9    47.1    100.0
poorer  46.3    53.7    100.0
middle  39.9    60.1    100.0
richer  41.8    58.2    100.0
richest 32.6    67.4    100.0
Total   42.9    57.1    100.0
. tabout v025 v106 v024 v190 rh_ancneotet using ch9tables_ANCcomps.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_ANCcomps.xls

        Took iron tablet/syrup during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   7.0     93.0    100.0
rural   9.0     91.0    100.0
Total   8.1     91.9    100.0

highest educational level                       
no education    11.0    89.0    100.0
primary 9.2     90.8    100.0
secondary       6.6     93.4    100.0
higher  3.3     96.7    100.0
Total   8.1     91.9    100.0

region                  
western 6.3     93.7    100.0
central 8.2     91.8    100.0
greater accra   7.1     92.9    100.0
volta   11.5    88.5    100.0
eastern 11.3    88.7    100.0
ashanti 6.0     94.0    100.0
brong ahafo     5.4     94.6    100.0
northern        11.5    88.5    100.0
upper east      10.5    89.5    100.0
upper west      3.8     96.2    100.0
Total   8.1     91.9    100.0

wealth index                    
poorest 10.6    89.4    100.0
poorer  9.0     91.0    100.0
middle  9.7     90.3    100.0
richer  6.7     93.3    100.0
richest 4.1     95.9    100.0
Total   8.1     91.9    100.0

        Took intestinal parasite drugs during pregnancy of last birth           
        no      yes     Total
        %       %       %
type of place of residence                      
urban   63.8    36.2    100.0
rural   57.8    42.2    100.0
Total   60.6    39.4    100.0

highest educational level                       
no education    57.7    42.3    100.0
primary 56.6    43.4    100.0
secondary       62.5    37.5    100.0
higher  72.7    27.3    100.0
Total   60.6    39.4    100.0

region                  
western 39.1    60.9    100.0
central 56.0    44.0    100.0
greater accra   69.3    30.7    100.0
volta   67.8    32.2    100.0
eastern 57.3    42.7    100.0
ashanti 74.6    25.4    100.0
brong ahafo     65.8    34.2    100.0
northern        52.1    47.9    100.0
upper east      30.4    69.6    100.0
upper west      73.5    26.5    100.0
Total   60.6    39.4    100.0

wealth index                    
poorest 57.3    42.7    100.0
poorer  58.0    42.0    100.0
middle  57.3    42.7    100.0
richer  60.2    39.8    100.0
richest 70.7    29.3    100.0
Total   60.6    39.4    100.0

        Informed of pregnancy complications during ANC visit            
        0       1       Total
        %       %       %
type of place of residence                      
urban   13.0    87.0    100.0
rural   18.8    81.2    100.0
Total   16.1    83.9    100.0

highest educational level                       
no education    16.7    83.3    100.0
primary 20.7    79.3    100.0
secondary       14.6    85.4    100.0
higher  9.9     90.1    100.0
Total   16.1    83.9    100.0

region                  
western 16.4    83.6    100.0
central 10.3    89.7    100.0
greater accra   5.5     94.5    100.0
volta   10.6    89.4    100.0
eastern 24.2    75.8    100.0
ashanti 26.1    73.9    100.0
brong ahafo     23.8    76.2    100.0
northern        7.4     92.6    100.0
upper east      7.4     92.6    100.0
upper west      46.5    53.5    100.0
Total   16.1    83.9    100.0

wealth index                    
poorest 20.2    79.8    100.0
poorer  21.2    78.8    100.0
middle  17.0    83.0    100.0
richer  13.3    86.7    100.0
richest 8.5     91.5    100.0
Total   16.1    83.9    100.0

        Blood pressure was taken during ANC visit               
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   1.7     98.3    100.0
Total   1.2     98.8    100.0

highest educational level                       
no education    2.3     97.7    100.0
primary 0.9     99.1    100.0
secondary       0.8     99.2    100.0
higher  0.0     100.0   100.0
Total   1.2     98.8    100.0

region                  
western 1.4     98.6    100.0
central 0.3     99.7    100.0
greater accra   0.3     99.7    100.0
volta   1.5     98.5    100.0
eastern 1.7     98.3    100.0
ashanti 0.4     99.6    100.0
brong ahafo     1.1     98.9    100.0
northern        4.1     95.9    100.0
upper east      0.2     99.8    100.0
upper west      0.8     99.2    100.0
Total   1.2     98.8    100.0

wealth index                    
poorest 3.0     97.0    100.0
poorer  1.0     99.0    100.0
middle  0.8     99.2    100.0
richer  0.5     99.5    100.0
richest 0.4     99.6    100.0
Total   1.2     98.8    100.0

        Urine sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.6     99.4    100.0
rural   4.5     95.5    100.0
Total   2.7     97.3    100.0

highest educational level                       
no education    7.8     92.2    100.0
primary 1.6     98.4    100.0
secondary       0.8     99.2    100.0
higher  0.1     99.9    100.0
Total   2.7     97.3    100.0

region                  
western 1.9     98.1    100.0
central 0.2     99.8    100.0
greater accra   0.4     99.6    100.0
volta   1.8     98.2    100.0
eastern 1.2     98.8    100.0
ashanti 0.0     100.0   100.0
brong ahafo     0.7     99.3    100.0
northern        17.3    82.7    100.0
upper east      1.0     99.0    100.0
upper west      6.0     94.0    100.0
Total   2.7     97.3    100.0

wealth index                    
poorest 9.4     90.6    100.0
poorer  2.9     97.1    100.0
middle  0.3     99.7    100.0
richer  0.6     99.4    100.0
richest 0.0     100.0   100.0
Total   2.7     97.3    100.0

        Blood sample was taken during ANC visit         
        0       1       Total
        %       %       %
type of place of residence                      
urban   0.5     99.5    100.0
rural   3.0     97.0    100.0
Total   1.9     98.1    100.0

highest educational level                       
no education    3.4     96.6    100.0
primary 1.8     98.2    100.0
secondary       1.3     98.7    100.0
higher  0.0     100.0   100.0
Total   1.9     98.1    100.0

region                  
western 1.0     99.0    100.0
central 2.9     97.1    100.0
greater accra   0.4     99.6    100.0
volta   1.7     98.3    100.0
eastern 1.9     98.1    100.0
ashanti 0.3     99.7    100.0
brong ahafo     0.8     99.2    100.0
northern        7.5     92.5    100.0
upper east      1.0     99.0    100.0
upper west      2.8     97.2    100.0
Total   1.9     98.1    100.0

wealth index                    
poorest 4.8     95.2    100.0
poorer  2.1     97.9    100.0
middle  1.7     98.3    100.0
richer  0.3     99.7    100.0
richest 0.2     99.8    100.0
Total   1.9     98.1    100.0

        Received 2+ tetanus injections during last pregnancy            
        no      yes     Total
        %       %       %
type of place of residence                      
urban   40.4    59.6    100.0
rural   45.1    54.9    100.0
Total   42.9    57.1    100.0

highest educational level                       
no education    48.9    51.1    100.0
primary 49.2    50.8    100.0
secondary       38.0    62.0    100.0
higher  35.2    64.8    100.0
Total   42.9    57.1    100.0

region                  
western 31.7    68.3    100.0
central 31.1    68.9    100.0
greater accra   45.0    55.0    100.0
volta   48.0    52.0    100.0
eastern 49.3    50.7    100.0
ashanti 40.7    59.3    100.0
brong ahafo     43.0    57.0    100.0
northern        52.8    47.2    100.0
upper east      43.2    56.8    100.0
upper west      56.8    43.2    100.0
Total   42.9    57.1    100.0

wealth index                    
poorest 52.9    47.1    100.0
poorer  46.3    53.7    100.0
middle  39.9    60.1    100.0
richer  41.8    58.2    100.0
richest 32.6    67.4    100.0
Total   42.9    57.1    100.0

        Protected against neonatal tetanus              
        0       1       Total
        %       %       %
type of place of residence                      
urban   19.9    80.1    100.0
rural   23.8    76.2    100.0
Total   22.0    78.0    100.0

highest educational level                       
no education    27.6    72.4    100.0
primary 26.7    73.3    100.0
secondary       18.1    81.9    100.0
higher  12.5    87.5    100.0
Total   22.0    78.0    100.0

region                  
western 18.0    82.0    100.0
central 16.0    84.0    100.0
greater accra   21.8    78.2    100.0
volta   19.2    80.8    100.0
eastern 31.2    68.8    100.0
ashanti 18.2    81.8    100.0
brong ahafo     16.3    83.7    100.0
northern        31.0    69.0    100.0
upper east      32.0    68.0    100.0
upper west      29.1    70.9    100.0
Total   22.0    78.0    100.0

wealth index                    
poorest 31.8    68.2    100.0
poorer  23.3    76.7    100.0
middle  21.1    78.9    100.0
richer  20.3    79.7    100.0
richest 12.7    87.3    100.0
Total   22.0    78.0    100.0
. */
. ****************************************************
. 
. 
. * Indicators for problems accessing health care: excel file ch9tables_probs will be produced
. ********************************************************************************************
. //problem permission to go
. 
. *residence
. tab v025 rh_prob_permit [iw=wt], row nofreq 

           |  Problem health care
   type of | access: permission to
  place of |          go
 residence |   no prob       prob |     Total
-----------+----------------------+----------
     urban |     94.46       5.54 |    100.00 
     rural |     93.39       6.61 |    100.00 
-----------+----------------------+----------
     Total |     93.96       6.04 |    100.00 
. 
. *region
. tab v024 rh_prob_permit [iw=wt], row nofreq 

              |  Problem health care
              | access: permission to
              |          go
       region |   no prob       prob |     Total
--------------+----------------------+----------
      western |     92.02       7.98 |    100.00 
      central |     95.88       4.12 |    100.00 
greater accra |     96.33       3.67 |    100.00 
        volta |     97.78       2.22 |    100.00 
      eastern |     91.22       8.78 |    100.00 
      ashanti |     93.15       6.85 |    100.00 
  brong ahafo |     94.20       5.80 |    100.00 
     northern |     91.42       8.58 |    100.00 
   upper east |     95.66       4.34 |    100.00 
   upper west |     84.92      15.08 |    100.00 
--------------+----------------------+----------
        Total |     93.96       6.04 |    100.00 
. 
. *education
. tab v106 rh_prob_permit [iw=wt], row nofreq 

             |  Problem health care
     highest | access: permission to
 educational |          go
       level |   no prob       prob |     Total
-------------+----------------------+----------
no education |     93.15       6.85 |    100.00 
     primary |     93.21       6.79 |    100.00 
   secondary |     94.20       5.80 |    100.00 
      higher |     96.44       3.56 |    100.00 
-------------+----------------------+----------
       Total |     93.96       6.04 |    100.00 
. 
. *wealth
. tab v190 rh_prob_permit [iw=wt], row nofreq 

           |  Problem health care
           | access: permission to
    wealth |          go
     index |   no prob       prob |     Total
-----------+----------------------+----------
   poorest |     92.40       7.60 |    100.00 
    poorer |     92.49       7.51 |    100.00 
    middle |     93.40       6.60 |    100.00 
    richer |     94.78       5.22 |    100.00 
   richest |     95.85       4.15 |    100.00 
-----------+----------------------+----------
     Total |     93.96       6.04 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_prob_permit using ch9tables_probs.xls [iw=wt] , c(row) f(1) replace 

Table output written to: ch9tables_probs.xls

        Problem health care access: permission to go            
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   94.5    5.5     100.0
rural   93.4    6.6     100.0
Total   94.0    6.0     100.0

highest educational level                       
no education    93.2    6.8     100.0
primary 93.2    6.8     100.0
secondary       94.2    5.8     100.0
higher  96.4    3.6     100.0
Total   94.0    6.0     100.0

region                  
western 92.0    8.0     100.0
central 95.9    4.1     100.0
greater accra   96.3    3.7     100.0
volta   97.8    2.2     100.0
eastern 91.2    8.8     100.0
ashanti 93.1    6.9     100.0
brong ahafo     94.2    5.8     100.0
northern        91.4    8.6     100.0
upper east      95.7    4.3     100.0
upper west      84.9    15.1    100.0
Total   94.0    6.0     100.0

wealth index                    
poorest 92.4    7.6     100.0
poorer  92.5    7.5     100.0
middle  93.4    6.6     100.0
richer  94.8    5.2     100.0
richest 95.9    4.1     100.0
Total   94.0    6.0     100.0
. */
. ****************************************************
. //problem getting money
. 
. *residence
. tab v025 rh_prob_money [iw=wt], row nofreq 

   type of |  Problem health care
  place of | access: getting money
 residence |   no prob       prob |     Total
-----------+----------------------+----------
     urban |     64.79      35.21 |    100.00 
     rural |     50.69      49.31 |    100.00 
-----------+----------------------+----------
     Total |     58.27      41.73 |    100.00 
. 
. *region
. tab v024 rh_prob_money [iw=wt], row nofreq 

              |  Problem health care
              | access: getting money
       region |   no prob       prob |     Total
--------------+----------------------+----------
      western |     65.71      34.29 |    100.00 
      central |     65.75      34.25 |    100.00 
greater accra |     75.24      24.76 |    100.00 
        volta |     38.21      61.79 |    100.00 
      eastern |     52.54      47.46 |    100.00 
      ashanti |     50.63      49.37 |    100.00 
  brong ahafo |     67.49      32.51 |    100.00 
     northern |     39.80      60.20 |    100.00 
   upper east |     54.02      45.98 |    100.00 
   upper west |     35.93      64.07 |    100.00 
--------------+----------------------+----------
        Total |     58.27      41.73 |    100.00 
. 
. *education
. tab v106 rh_prob_money [iw=wt], row nofreq 

     highest |  Problem health care
 educational | access: getting money
       level |   no prob       prob |     Total
-------------+----------------------+----------
no education |     45.12      54.88 |    100.00 
     primary |     49.13      50.87 |    100.00 
   secondary |     62.58      37.42 |    100.00 
      higher |     84.83      15.17 |    100.00 
-------------+----------------------+----------
       Total |     58.27      41.73 |    100.00 
. 
. *wealth
. tab v190 rh_prob_money [iw=wt], row nofreq 

           |  Problem health care
    wealth | access: getting money
     index |   no prob       prob |     Total
-----------+----------------------+----------
   poorest |     41.39      58.61 |    100.00 
    poorer |     45.98      54.02 |    100.00 
    middle |     54.40      45.60 |    100.00 
    richer |     63.63      36.37 |    100.00 
   richest |     77.32      22.68 |    100.00 
-----------+----------------------+----------
     Total |     58.27      41.73 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_prob_money using ch9tables_probs.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_probs.xls

        Problem health care access: permission to go            
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   94.5    5.5     100.0
rural   93.4    6.6     100.0
Total   94.0    6.0     100.0

highest educational level                       
no education    93.2    6.8     100.0
primary 93.2    6.8     100.0
secondary       94.2    5.8     100.0
higher  96.4    3.6     100.0
Total   94.0    6.0     100.0

region                  
western 92.0    8.0     100.0
central 95.9    4.1     100.0
greater accra   96.3    3.7     100.0
volta   97.8    2.2     100.0
eastern 91.2    8.8     100.0
ashanti 93.1    6.9     100.0
brong ahafo     94.2    5.8     100.0
northern        91.4    8.6     100.0
upper east      95.7    4.3     100.0
upper west      84.9    15.1    100.0
Total   94.0    6.0     100.0

wealth index                    
poorest 92.4    7.6     100.0
poorer  92.5    7.5     100.0
middle  93.4    6.6     100.0
richer  94.8    5.2     100.0
richest 95.9    4.1     100.0
Total   94.0    6.0     100.0

        Problem health care access: getting money               
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   64.8    35.2    100.0
rural   50.7    49.3    100.0
Total   58.3    41.7    100.0

highest educational level                       
no education    45.1    54.9    100.0
primary 49.1    50.9    100.0
secondary       62.6    37.4    100.0
higher  84.8    15.2    100.0
Total   58.3    41.7    100.0

region                  
western 65.7    34.3    100.0
central 65.7    34.3    100.0
greater accra   75.2    24.8    100.0
volta   38.2    61.8    100.0
eastern 52.5    47.5    100.0
ashanti 50.6    49.4    100.0
brong ahafo     67.5    32.5    100.0
northern        39.8    60.2    100.0
upper east      54.0    46.0    100.0
upper west      35.9    64.1    100.0
Total   58.3    41.7    100.0

wealth index                    
poorest 41.4    58.6    100.0
poorer  46.0    54.0    100.0
middle  54.4    45.6    100.0
richer  63.6    36.4    100.0
richest 77.3    22.7    100.0
Total   58.3    41.7    100.0
. */
. ****************************************************
. //problem distance
. 
. *residence
. tab v025 rh_prob_dist [iw=wt], row nofreq 

           |  Problem health care
   type of |  access: distance to
  place of |       facility
 residence |   no prob       prob |     Total
-----------+----------------------+----------
     urban |     82.80      17.20 |    100.00 
     rural |     65.15      34.85 |    100.00 
-----------+----------------------+----------
     Total |     74.64      25.36 |    100.00 
. 
. *region
. tab v024 rh_prob_dist [iw=wt], row nofreq 

              |  Problem health care
              |  access: distance to
              |       facility
       region |   no prob       prob |     Total
--------------+----------------------+----------
      western |     80.32      19.68 |    100.00 
      central |     81.79      18.21 |    100.00 
greater accra |     87.43      12.57 |    100.00 
        volta |     67.83      32.17 |    100.00 
      eastern |     63.78      36.22 |    100.00 
      ashanti |     73.40      26.60 |    100.00 
  brong ahafo |     78.67      21.33 |    100.00 
     northern |     50.20      49.80 |    100.00 
   upper east |     80.02      19.98 |    100.00 
   upper west |     46.25      53.75 |    100.00 
--------------+----------------------+----------
        Total |     74.64      25.36 |    100.00 
. 
. *education
. tab v106 rh_prob_dist [iw=wt], row nofreq 

             |  Problem health care
     highest |  access: distance to
 educational |       facility
       level |   no prob       prob |     Total
-------------+----------------------+----------
no education |     62.22      37.78 |    100.00 
     primary |     71.16      28.84 |    100.00 
   secondary |     78.21      21.79 |    100.00 
      higher |     89.71      10.29 |    100.00 
-------------+----------------------+----------
       Total |     74.64      25.36 |    100.00 
. 
. *wealth
. tab v190 rh_prob_dist [iw=wt], row nofreq 

           |  Problem health care
           |  access: distance to
    wealth |       facility
     index |   no prob       prob |     Total
-----------+----------------------+----------
   poorest |     54.88      45.12 |    100.00 
    poorer |     64.84      35.16 |    100.00 
    middle |     76.31      23.69 |    100.00 
    richer |     81.57      18.43 |    100.00 
   richest |     87.39      12.61 |    100.00 
-----------+----------------------+----------
     Total |     74.64      25.36 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_prob_dist using ch9tables_probs.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_probs.xls

        Problem health care access: permission to go            
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   94.5    5.5     100.0
rural   93.4    6.6     100.0
Total   94.0    6.0     100.0

highest educational level                       
no education    93.2    6.8     100.0
primary 93.2    6.8     100.0
secondary       94.2    5.8     100.0
higher  96.4    3.6     100.0
Total   94.0    6.0     100.0

region                  
western 92.0    8.0     100.0
central 95.9    4.1     100.0
greater accra   96.3    3.7     100.0
volta   97.8    2.2     100.0
eastern 91.2    8.8     100.0
ashanti 93.1    6.9     100.0
brong ahafo     94.2    5.8     100.0
northern        91.4    8.6     100.0
upper east      95.7    4.3     100.0
upper west      84.9    15.1    100.0
Total   94.0    6.0     100.0

wealth index                    
poorest 92.4    7.6     100.0
poorer  92.5    7.5     100.0
middle  93.4    6.6     100.0
richer  94.8    5.2     100.0
richest 95.9    4.1     100.0
Total   94.0    6.0     100.0

        Problem health care access: getting money               
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   64.8    35.2    100.0
rural   50.7    49.3    100.0
Total   58.3    41.7    100.0

highest educational level                       
no education    45.1    54.9    100.0
primary 49.1    50.9    100.0
secondary       62.6    37.4    100.0
higher  84.8    15.2    100.0
Total   58.3    41.7    100.0

region                  
western 65.7    34.3    100.0
central 65.7    34.3    100.0
greater accra   75.2    24.8    100.0
volta   38.2    61.8    100.0
eastern 52.5    47.5    100.0
ashanti 50.6    49.4    100.0
brong ahafo     67.5    32.5    100.0
northern        39.8    60.2    100.0
upper east      54.0    46.0    100.0
upper west      35.9    64.1    100.0
Total   58.3    41.7    100.0

wealth index                    
poorest 41.4    58.6    100.0
poorer  46.0    54.0    100.0
middle  54.4    45.6    100.0
richer  63.6    36.4    100.0
richest 77.3    22.7    100.0
Total   58.3    41.7    100.0

        Problem health care access: distance to facility                
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   82.8    17.2    100.0
rural   65.1    34.9    100.0
Total   74.6    25.4    100.0

highest educational level                       
no education    62.2    37.8    100.0
primary 71.2    28.8    100.0
secondary       78.2    21.8    100.0
higher  89.7    10.3    100.0
Total   74.6    25.4    100.0

region                  
western 80.3    19.7    100.0
central 81.8    18.2    100.0
greater accra   87.4    12.6    100.0
volta   67.8    32.2    100.0
eastern 63.8    36.2    100.0
ashanti 73.4    26.6    100.0
brong ahafo     78.7    21.3    100.0
northern        50.2    49.8    100.0
upper east      80.0    20.0    100.0
upper west      46.2    53.8    100.0
Total   74.6    25.4    100.0

wealth index                    
poorest 54.9    45.1    100.0
poorer  64.8    35.2    100.0
middle  76.3    23.7    100.0
richer  81.6    18.4    100.0
richest 87.4    12.6    100.0
Total   74.6    25.4    100.0
. */
. ****************************************************
. //problem don't want to go alone
. 
. *residence
. tab v025 rh_prob_alone [iw=wt], row nofreq 

           |  Problem health care
   type of |  access: not wanting
  place of |      to go alone
 residence |   no prob       prob |     Total
-----------+----------------------+----------
     urban |     86.33      13.67 |    100.00 
     rural |     82.31      17.69 |    100.00 
-----------+----------------------+----------
     Total |     84.47      15.53 |    100.00 
. 
. *region
. tab v024 rh_prob_alone [iw=wt], row nofreq 

              |  Problem health care
              |  access: not wanting
              |      to go alone
       region |   no prob       prob |     Total
--------------+----------------------+----------
      western |     93.26       6.74 |    100.00 
      central |     88.10      11.90 |    100.00 
greater accra |     86.64      13.36 |    100.00 
        volta |     83.20      16.80 |    100.00 
      eastern |     82.33      17.67 |    100.00 
      ashanti |     82.65      17.35 |    100.00 
  brong ahafo |     86.40      13.60 |    100.00 
     northern |     66.27      33.73 |    100.00 
   upper east |     90.60       9.40 |    100.00 
   upper west |     84.82      15.18 |    100.00 
--------------+----------------------+----------
        Total |     84.47      15.53 |    100.00 
. 
. *education
. tab v106 rh_prob_alone [iw=wt], row nofreq 

             |  Problem health care
     highest |  access: not wanting
 educational |      to go alone
       level |   no prob       prob |     Total
-------------+----------------------+----------
no education |     79.04      20.96 |    100.00 
     primary |     84.74      15.26 |    100.00 
   secondary |     85.54      14.46 |    100.00 
      higher |     90.46       9.54 |    100.00 
-------------+----------------------+----------
       Total |     84.47      15.53 |    100.00 
. 
. *wealth
. tab v190 rh_prob_alone [iw=wt], row nofreq 

           |  Problem health care
           |  access: not wanting
    wealth |      to go alone
     index |   no prob       prob |     Total
-----------+----------------------+----------
   poorest |     75.74      24.26 |    100.00 
    poorer |     81.78      18.22 |    100.00 
    middle |     86.31      13.69 |    100.00 
    richer |     87.53      12.47 |    100.00 
   richest |     87.92      12.08 |    100.00 
-----------+----------------------+----------
     Total |     84.47      15.53 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_prob_alone using ch9tables_probs.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_probs.xls

        Problem health care access: permission to go            
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   94.5    5.5     100.0
rural   93.4    6.6     100.0
Total   94.0    6.0     100.0

highest educational level                       
no education    93.2    6.8     100.0
primary 93.2    6.8     100.0
secondary       94.2    5.8     100.0
higher  96.4    3.6     100.0
Total   94.0    6.0     100.0

region                  
western 92.0    8.0     100.0
central 95.9    4.1     100.0
greater accra   96.3    3.7     100.0
volta   97.8    2.2     100.0
eastern 91.2    8.8     100.0
ashanti 93.1    6.9     100.0
brong ahafo     94.2    5.8     100.0
northern        91.4    8.6     100.0
upper east      95.7    4.3     100.0
upper west      84.9    15.1    100.0
Total   94.0    6.0     100.0

wealth index                    
poorest 92.4    7.6     100.0
poorer  92.5    7.5     100.0
middle  93.4    6.6     100.0
richer  94.8    5.2     100.0
richest 95.9    4.1     100.0
Total   94.0    6.0     100.0

        Problem health care access: getting money               
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   64.8    35.2    100.0
rural   50.7    49.3    100.0
Total   58.3    41.7    100.0

highest educational level                       
no education    45.1    54.9    100.0
primary 49.1    50.9    100.0
secondary       62.6    37.4    100.0
higher  84.8    15.2    100.0
Total   58.3    41.7    100.0

region                  
western 65.7    34.3    100.0
central 65.7    34.3    100.0
greater accra   75.2    24.8    100.0
volta   38.2    61.8    100.0
eastern 52.5    47.5    100.0
ashanti 50.6    49.4    100.0
brong ahafo     67.5    32.5    100.0
northern        39.8    60.2    100.0
upper east      54.0    46.0    100.0
upper west      35.9    64.1    100.0
Total   58.3    41.7    100.0

wealth index                    
poorest 41.4    58.6    100.0
poorer  46.0    54.0    100.0
middle  54.4    45.6    100.0
richer  63.6    36.4    100.0
richest 77.3    22.7    100.0
Total   58.3    41.7    100.0

        Problem health care access: distance to facility                
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   82.8    17.2    100.0
rural   65.1    34.9    100.0
Total   74.6    25.4    100.0

highest educational level                       
no education    62.2    37.8    100.0
primary 71.2    28.8    100.0
secondary       78.2    21.8    100.0
higher  89.7    10.3    100.0
Total   74.6    25.4    100.0

region                  
western 80.3    19.7    100.0
central 81.8    18.2    100.0
greater accra   87.4    12.6    100.0
volta   67.8    32.2    100.0
eastern 63.8    36.2    100.0
ashanti 73.4    26.6    100.0
brong ahafo     78.7    21.3    100.0
northern        50.2    49.8    100.0
upper east      80.0    20.0    100.0
upper west      46.2    53.8    100.0
Total   74.6    25.4    100.0

wealth index                    
poorest 54.9    45.1    100.0
poorer  64.8    35.2    100.0
middle  76.3    23.7    100.0
richer  81.6    18.4    100.0
richest 87.4    12.6    100.0
Total   74.6    25.4    100.0

        Problem health care access: not wanting to go alone             
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   86.3    13.7    100.0
rural   82.3    17.7    100.0
Total   84.5    15.5    100.0

highest educational level                       
no education    79.0    21.0    100.0
primary 84.7    15.3    100.0
secondary       85.5    14.5    100.0
higher  90.5    9.5     100.0
Total   84.5    15.5    100.0

region                  
western 93.3    6.7     100.0
central 88.1    11.9    100.0
greater accra   86.6    13.4    100.0
volta   83.2    16.8    100.0
eastern 82.3    17.7    100.0
ashanti 82.6    17.4    100.0
brong ahafo     86.4    13.6    100.0
northern        66.3    33.7    100.0
upper east      90.6    9.4     100.0
upper west      84.8    15.2    100.0
Total   84.5    15.5    100.0

wealth index                    
poorest 75.7    24.3    100.0
poorer  81.8    18.2    100.0
middle  86.3    13.7    100.0
richer  87.5    12.5    100.0
richest 87.9    12.1    100.0
Total   84.5    15.5    100.0
. */
. ****************************************************
. //at least one problem
. 
. *residence
. tab v025 rh_prob_minone [iw=wt], row nofreq 

           | At least one problem
   type of |  in accessing health
  place of |         care
 residence |         0          1 |     Total
-----------+----------------------+----------
     urban |     55.87      44.13 |    100.00 
     rural |     41.62      58.38 |    100.00 
-----------+----------------------+----------
     Total |     49.28      50.72 |    100.00 
. 
. *region
. tab v024 rh_prob_minone [iw=wt], row nofreq 

              | At least one problem
              |  in accessing health
              |         care
       region |         0          1 |     Total
--------------+----------------------+----------
      western |     56.00      44.00 |    100.00 
      central |     57.72      42.28 |    100.00 
greater accra |     64.60      35.40 |    100.00 
        volta |     30.28      69.72 |    100.00 
      eastern |     40.78      59.22 |    100.00 
      ashanti |     44.02      55.98 |    100.00 
  brong ahafo |     58.33      41.67 |    100.00 
     northern |     29.19      70.81 |    100.00 
   upper east |     48.46      51.54 |    100.00 
   upper west |     29.79      70.21 |    100.00 
--------------+----------------------+----------
        Total |     49.28      50.72 |    100.00 
. 
. *education
. tab v106 rh_prob_minone [iw=wt], row nofreq 

             | At least one problem
     highest |  in accessing health
 educational |         care
       level |         0          1 |     Total
-------------+----------------------+----------
no education |     36.49      63.51 |    100.00 
     primary |     41.38      58.62 |    100.00 
   secondary |     53.17      46.83 |    100.00 
      higher |     75.13      24.87 |    100.00 
-------------+----------------------+----------
       Total |     49.28      50.72 |    100.00 
. 
. *wealth
. tab v190 rh_prob_minone [iw=wt], row nofreq 

           | At least one problem
           |  in accessing health
    wealth |         care
     index |         0          1 |     Total
-----------+----------------------+----------
   poorest |     32.44      67.56 |    100.00 
    poorer |     36.56      63.44 |    100.00 
    middle |     46.10      53.90 |    100.00 
    richer |     55.50      44.50 |    100.00 
   richest |     67.20      32.80 |    100.00 
-----------+----------------------+----------
     Total |     49.28      50.72 |    100.00 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_prob_minone using ch9tables_probs.xls [iw=wt] , c(row) f(1) append 

Table output written to: ch9tables_probs.xls

        Problem health care access: permission to go            
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   94.5    5.5     100.0
rural   93.4    6.6     100.0
Total   94.0    6.0     100.0

highest educational level                       
no education    93.2    6.8     100.0
primary 93.2    6.8     100.0
secondary       94.2    5.8     100.0
higher  96.4    3.6     100.0
Total   94.0    6.0     100.0

region                  
western 92.0    8.0     100.0
central 95.9    4.1     100.0
greater accra   96.3    3.7     100.0
volta   97.8    2.2     100.0
eastern 91.2    8.8     100.0
ashanti 93.1    6.9     100.0
brong ahafo     94.2    5.8     100.0
northern        91.4    8.6     100.0
upper east      95.7    4.3     100.0
upper west      84.9    15.1    100.0
Total   94.0    6.0     100.0

wealth index                    
poorest 92.4    7.6     100.0
poorer  92.5    7.5     100.0
middle  93.4    6.6     100.0
richer  94.8    5.2     100.0
richest 95.9    4.1     100.0
Total   94.0    6.0     100.0

        Problem health care access: getting money               
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   64.8    35.2    100.0
rural   50.7    49.3    100.0
Total   58.3    41.7    100.0

highest educational level                       
no education    45.1    54.9    100.0
primary 49.1    50.9    100.0
secondary       62.6    37.4    100.0
higher  84.8    15.2    100.0
Total   58.3    41.7    100.0

region                  
western 65.7    34.3    100.0
central 65.7    34.3    100.0
greater accra   75.2    24.8    100.0
volta   38.2    61.8    100.0
eastern 52.5    47.5    100.0
ashanti 50.6    49.4    100.0
brong ahafo     67.5    32.5    100.0
northern        39.8    60.2    100.0
upper east      54.0    46.0    100.0
upper west      35.9    64.1    100.0
Total   58.3    41.7    100.0

wealth index                    
poorest 41.4    58.6    100.0
poorer  46.0    54.0    100.0
middle  54.4    45.6    100.0
richer  63.6    36.4    100.0
richest 77.3    22.7    100.0
Total   58.3    41.7    100.0

        Problem health care access: distance to facility                
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   82.8    17.2    100.0
rural   65.1    34.9    100.0
Total   74.6    25.4    100.0

highest educational level                       
no education    62.2    37.8    100.0
primary 71.2    28.8    100.0
secondary       78.2    21.8    100.0
higher  89.7    10.3    100.0
Total   74.6    25.4    100.0

region                  
western 80.3    19.7    100.0
central 81.8    18.2    100.0
greater accra   87.4    12.6    100.0
volta   67.8    32.2    100.0
eastern 63.8    36.2    100.0
ashanti 73.4    26.6    100.0
brong ahafo     78.7    21.3    100.0
northern        50.2    49.8    100.0
upper east      80.0    20.0    100.0
upper west      46.2    53.8    100.0
Total   74.6    25.4    100.0

wealth index                    
poorest 54.9    45.1    100.0
poorer  64.8    35.2    100.0
middle  76.3    23.7    100.0
richer  81.6    18.4    100.0
richest 87.4    12.6    100.0
Total   74.6    25.4    100.0

        Problem health care access: not wanting to go alone             
        no prob prob    Total
        %       %       %
type of place of residence                      
urban   86.3    13.7    100.0
rural   82.3    17.7    100.0
Total   84.5    15.5    100.0

highest educational level                       
no education    79.0    21.0    100.0
primary 84.7    15.3    100.0
secondary       85.5    14.5    100.0
higher  90.5    9.5     100.0
Total   84.5    15.5    100.0

region                  
western 93.3    6.7     100.0
central 88.1    11.9    100.0
greater accra   86.6    13.4    100.0
volta   83.2    16.8    100.0
eastern 82.3    17.7    100.0
ashanti 82.6    17.4    100.0
brong ahafo     86.4    13.6    100.0
northern        66.3    33.7    100.0
upper east      90.6    9.4     100.0
upper west      84.8    15.2    100.0
Total   84.5    15.5    100.0

wealth index                    
poorest 75.7    24.3    100.0
poorer  81.8    18.2    100.0
middle  86.3    13.7    100.0
richer  87.5    12.5    100.0
richest 87.9    12.1    100.0
Total   84.5    15.5    100.0

        At least one problem in accessing health care           
        0       1       Total
        %       %       %
type of place of residence                      
urban   55.9    44.1    100.0
rural   41.6    58.4    100.0
Total   49.3    50.7    100.0

highest educational level                       
no education    36.5    63.5    100.0
primary 41.4    58.6    100.0
secondary       53.2    46.8    100.0
higher  75.1    24.9    100.0
Total   49.3    50.7    100.0

region                  
western 56.0    44.0    100.0
central 57.7    42.3    100.0
greater accra   64.6    35.4    100.0
volta   30.3    69.7    100.0
eastern 40.8    59.2    100.0
ashanti 44.0    56.0    100.0
brong ahafo     58.3    41.7    100.0
northern        29.2    70.8    100.0
upper east      48.5    51.5    100.0
upper west      29.8    70.2    100.0
Total   49.3    50.7    100.0

wealth index                    
poorest 32.4    67.6    100.0
poorer  36.6    63.4    100.0
middle  46.1    53.9    100.0
richer  55.5    44.5    100.0
richest 67.2    32.8    100.0
Total   49.3    50.7    100.0
. */
. ****************************************************
. }

. 
. ****************************************************************************
. ****************************************************************************
. 
. * indicators from BR file
. if file=="BR" {
. ****************************************************
. //place of delivery
. 
. *residence
. tab v025 rh_del_place [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_place [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_place [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_place [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_place using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) replace 
. */
. ****************************************************
. //type of health facilty
. 
. *residence
. tab v025 rh_del_pltype [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_pltype [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_pltype [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_pltype [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_pltype using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. //type of provider
. 
. *residence
. tab v025 rh_del_pv [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_pv [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_pv [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_pv [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_pv using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. //skilled provider
. 
. *residence
. tab v025 rh_del_pv [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_pv [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_pv [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_pv [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_pv using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. //C-section delivery
. 
. *residence
. tab v025 rh_del_ces [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_ces [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_ces [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_ces [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_ces using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. //C-section delivery timing
. 
. *residence
. tab v025 rh_del_cestime [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_cestime [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_cestime [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_cestime [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_cestime using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. //during of stay after delivery
. 
. *residence
. tab v025 rh_del_stay [iw=wt], row nofreq 
. 
. *region
. tab v024 rh_del_stay [iw=wt], row nofreq 
. 
. *education
. tab v106 rh_del_stay [iw=wt], row nofreq 
. 
. *wealth
. tab v190 rh_del_stay [iw=wt], row nofreq 
. 
. * output to excel
. tabout v025 v106 v024 v190 rh_del_stay using ch9tables_Deliv.xls [iw=wt] , c(row) f(1) append 
. */
. ****************************************************
. }

. 
. 
end of do-file

. help log

. ssc install ftool
ssc install: "ftool" not found at SSC, type search ftool
(To find all packages at SSC that start with f, type ssc describe f)
r(601);

. ssc install ftools
checking ftools consistency and verifying not already installed...
installing into c:\ado\plus\...
installation complete.

. ssc install gtools
checking gtools consistency and verifying not already installed...
installing into c:\ado\plus\...
installation complete.

. do "C:\Users\39585\OneDrive - ICF\MarriageCalendar\Code\Cal_marr_surveysearch.do"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. 
.           }
 30.         }
 31. list vcal_`i' in 1/1
 32. scalar col_example = vcal_`i' in 1/1 
 33. 
. putexcel set "C:\Users\39585\Desktop\MarriageCalendarData\marriage.xlsx", sheet("Survey Search") modify
 34. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 35.         local row = `row' + 1
 36.         
.                 }
 37.                 
. }
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
workbook C:\Users\39585\Desktop\MarriageCalendarData\marriage.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. 
.           }
 30.         }
 31. list vcal_`i' in 1/1
 32. scalar col_example = vcal_`i' in 1/1 
 33. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 34. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 35.         local row = `row' + 1
 36.         
.                 }
 37.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
afir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
alir50fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
alir50fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
alir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
alir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir42fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          00000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir42fl.dta
Marriage column exists but is empty
(6,430 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir54fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir54fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,566 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
amir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
aoir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
azir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
azir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir31fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir3afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir41fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir4jfl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir4jfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,440 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bdir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir43fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir43fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir31fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                    0000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir41fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,654 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
boir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir21fl.dta
Marriage column exists and contains data

     +------------------------------------+
     |                             vcal_3 |
     |------------------------------------|
  1. |         X                        X |
     +------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir21fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir31fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                00000000000XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
brir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
buir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir44fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir44fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir22fl.dta
Marriage column exists and contains data

     +------------------------------------------+
     |                                   vcal_3 |
     |------------------------------------------|
  1. |                                 XXXXXXXX |
     +------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir22fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir31fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 0000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir41fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,585 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir53fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(41,344 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
coir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir21fl.dta
Marriage column exists but is empty
(7,320 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir21fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir32fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir41fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir4afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir4afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(23,384 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir21fl.dta
Marriage column exists and contains data

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir21fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir33fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir42fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir42fl.dta
Marriage column exists and contains data

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir4afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir4afl.dta
Marriage column exists but is empty
(9,159 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir51fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir51fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir5afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir5afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. 
.           }
 30.         }
 31. list vcal_`i' in 1/1
 32. scalar col_example = vcal_`i' in 1/1 
 33. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 34. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 35.         local row = `row' + 1
 36.         
.                 }
 37.                 
. }
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir21fl.dta
Marriage column exists and contains data

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir21fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir33fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir42fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir42fl.dta
Marriage column exists and contains data

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir4afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir4afl.dta
Marriage column exists but is empty
(9,159 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir51fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir51fl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir5afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
egir5afl.dta
Marriage column exists and contains data

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
invalid syntax
r(198);

end of do-file

r(198);

. set trace on

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. 
.           }
 30.         }
 31. list vcal_`i' in 1/1
 32. scalar col_example = vcal_`i' in 1/1 
 33. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 34. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 35.         local row = `row' + 1
 36.         
.                 }
 37.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes ty
> pe of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= 
> col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (incl
> udes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 35. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 36.         local row = `row' + 1
 37.         
.                 }
 38.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes ty
> pe of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= 
> col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (incl
> udes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 36. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 37.         local row = `row' + 1
 38.         
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes ty
> pe of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= 
> col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (incl
> udes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 36. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 37.         local row = `row' + 1
 38. tab v007
 39.                 }
 40.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes ty
> pe of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= 
> col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (incl
> udes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 36. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 37.         local row = `row' + 1
 38. tab v007
 39.                 }
 40.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes ty
> pe of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= 
> col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (incl
> udes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5a??.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 36. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 37.         local row = `row' + 1
 38. tab v007
 39.                 }
 40.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A2= ("egir5afl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("marriage & unions") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A1= ("Survey") B1= ("Country/Phase") C1= ("Phase") D1= ("Year") E1= ("Col No.") F1= ("Category") G1= ("Exa
> mple") A3= ("egir5afl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("original pregnancy/contraception codes (includes 
> termination") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5a??.DTA"

. 
. 
. 
. 
. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. /*
> putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
> 
>         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
>                          A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
>         local row = `row' + 1
> tab v007
> */
.                 }
 36.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5a??.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")                   G`row'= col_example
 36.         local row = `row' + 1
 37. tab v007
 38. */
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir5afl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("marriage & unions") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("egir5afl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("original pregnancy/contraception codes (include
> s termination") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5a??.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 36.         local row = `row' + 1
 37. tab v007
 38. */
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir5afl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("marriage & unions") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("egir5afl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("original pregnancy/contraception codes (include
> s termination") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 36.         local row = `row' + 1
 37. tab v007
 38. */
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A5=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A5=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A5=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A5=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A7=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A7=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A7=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A7=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes 
> type of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A9=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A9=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A9=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A9=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A11=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A11=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A11=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A11=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13
> = col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A13=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A13=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A13=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A13=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (in
> cludes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A15=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A15=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A15=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A15=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. putexcel                B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 36.         local row = `row' + 1
 37. tab v007
 38. */
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B5=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B5=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B5=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B5=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B7=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B7=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B7=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B7=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes type of term)") G9= c
> ol_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B9=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B9=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B9=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B9=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B11=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B11=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B11=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B11=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B13=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B13=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B13=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B13=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (includes termination") G
> 15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("B15=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("B15=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("B15=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("B15=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. putexcel         A`row'= ("`x'")                                D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 36.         local row = `row' + 1
 37. tab v007
 38. */
.                 }
 39.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir01fl.dta") D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("egir01fl.dta") D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A4= ("egir21fl.dta") D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A5= ("egir21fl.dta") D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A5=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A5=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A5=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A5=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A6= ("egir33fl.dta") D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A7= ("egir33fl.dta") D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A7=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A7=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A7=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A7=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A8= ("egir42fl.dta") D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A9= ("egir42fl.dta") D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes type of ter
> m)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A9=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A9=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A9=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A9=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A10= ("egir4afl.dta") D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A11= ("egir4afl.dta") D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A11=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A11=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A11=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A11=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A12= ("egir51fl.dta") D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A13= ("egir51fl.dta") D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13= col_exampl
> e
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A13=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A13=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A13=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A13=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A14= ("egir5afl.dta") D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- putexcel A`row'= ("`x'") D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A15= ("egir5afl.dta") D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (includes termi
> nation") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A15=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A15=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A15=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A15=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. 
.         local row = `row' + 1
 36. tab v007
 37. */
.                 }
 38.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- local row = `row' + 1
= local row = 15 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir61fl.dta"
egir61fl.dta
- use v* using "`x'", clear
= use v* using "egir61fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
- local row = `row' + 1
= local row = 16 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
- }
- di "`x'"
= di "egir61fl.dta"
egir61fl.dta
- use v* using "`x'", clear
= use v* using "egir61fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
- local row = `row' + 1
= local row = 17 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
- }
- }

. 
. 
end of do-file

. macro list _all
S_FN:           egir61fl.dta
PUTEXCEL_FILE_MODE:
                modify
PUTEXCEL_OPEN_FHANDLE:
                no
PUTEXCEL_LOCALE:
                UTF-8
PUTEXCEL_SHEET_NAME:
                Survey Search
PUTEXCEL_FILE_TYPE:
                xlsx
PUTEXCEL_FILE_NAME:
                C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx
col3:           AMIR42 AMIR54 BDIR31 BDIR3A BDIR41 BDIR4J BOIR31 BOIR41 BRIR31 COIR31 COIR41 COIR53 DRIR32 DRIR41
                DRIR4A EGIR33 EGIR42 EGIR4A EGIR51 EGIR5A EGIR61 ETIR51 GUIR34 GUIR41 IAIR52 IDIR31 IDIR3A IDIR42
                IDIR51 JOIR31 JOIR42 KKIR42 KEIR3A KEIR42 MWIR4E MBIR53 NCIR31 PEIR31 PEIR41 PEIR51 PEIR5I PHIR3B
                PHIR41 TZIR4I TRIR41 TRIR4A VNIR31 VNIR41 ZWIR31 ZWIR42 ZWIR52
n_offset:       0
sort:           0
dots:           nois _dots 5 0
dotss:          nois _dots 0, title(Survey results being calculated)
date:           1_23_2019
brdata:         GHBR72FL
irdata:         GHIR72FL
resultspath:    ""C:/Users//39585//ICF/Analysis - Shared Resources/Code/ShareCodeProject/Chap9_RH""
datapath:       C:/Users//39585//ICF/Analysis - Shared Resources/Data/DHSdata
S_level:        95
F1:             help advice;
F2:             describe;
F7:             save
F8:             use
S_ADO:          BASE;SITE;.;PERSONAL;PLUS;OLDPLACE
S_StataSE:      SE
S_FLAVOR:       Intercooled
S_OS:           Windows
S_OSDTL:        64-bit
S_MACH:         PC (64-bit x86-64)

. di col_example
NA

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 40.         local row = `row' + 1
 41. tab v007
 42. */
.                 }
 43.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("egir01fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- di "`col_cat'"
= di "postpart. amenorrhea"
postpart. amenorrhea
- di col_example
        XXXX                                    X
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A4= ("egir21fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("postpart. amenorrhea") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A5= ("egir21fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("marriage & unions") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A5=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A5=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A5=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A5=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A6= ("egir33fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("marriage & unions") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A7= ("egir33fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A7=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A7=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A7=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A7=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A8= ("egir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- di "`col_cat'"
= di "original pregnancies & contraception (includes type of term)"
original pregnancies & contraception (includes type of term)
- di col_example
                 X                             XX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A9= ("egir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("original pregnancies & contraception (includes 
> type of term)") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A9=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A9=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A9=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A9=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A10= ("egir4afl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A11= ("egir4afl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A11=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A11=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A11=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A11=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A12= ("egir51fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("marriage & unions") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- di "`col_cat'"
= di "pregnancy & contraception (original)"
pregnancy & contraception (original)
- di col_example
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A13= ("egir51fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("pregnancy & contraception (original)") G13
> = col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A13=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A13=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A13=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A13=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A14= ("egir5afl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- di "`col_cat'"
= di "original pregnancy/contraception codes (includes termination"
original pregnancy/contraception codes (includes termination
- di col_example
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A15= ("egir5afl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("original pregnancy/contraception codes (in
> cludes termination") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A15=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A15=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A15=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A15=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 1
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51  EGIR5A  EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 40.         
.         local row = `row' + 2
 41. tab v007
 42. */
.                 }
 43.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("egir01fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 2 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- use v* using "`x'", clear
= use v* using "egir01fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir01fl.dta"
egir01fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A4= ("egir01fl.dta") B4= (v000) D4= (v007) E4= ("6") F4= ("NA") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 4 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- di "`col_cat'"
= di "postpart. amenorrhea"
postpart. amenorrhea
- di col_example
        XXXX                                    X
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A6= ("egir21fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("postpart. amenorrhea") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 6 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- use v* using "`x'", clear
= use v* using "egir21fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_6 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir21fl.dta"
egir21fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A8= ("egir21fl.dta") B8= (v000) D8= (v007) E8= ("6") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 8 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A10= ("egir33fl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 10 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- use v* using "`x'", clear
= use v* using "egir33fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir33fl.dta"
egir33fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A12= ("egir33fl.dta") B12= (v000) D12= (v007) E12= ("6") F12= ("NA") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 12 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A14= ("egir42fl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("marriage & unions") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 14 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- use v* using "`x'", clear
= use v* using "egir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir42fl.dta"
egir42fl.dta
- di "`col_cat'"
= di "original pregnancies & contraception (includes type of term)"
original pregnancies & contraception (includes type of term)
- di col_example
                 X                             XX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A16= ("egir42fl.dta") B16= (v000) D16= (v007) E16= ("6") F16= ("original pregnancies & contraception (incl
> udes type of term)") G16= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A16=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A16=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A16=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A16=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 16 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label vcol_3 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A18= ("egir4afl.dta") B18= (v000) D18= (v007) E18= ("3") F18= ("marriage & unions") G18= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A18=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A18=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A18=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A18=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 18 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- use v* using "`x'", clear
= use v* using "egir4afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(9,159 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir4afl.dta"
egir4afl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A20= ("egir4afl.dta") B20= (v000) D20= (v007) E20= ("6") F20= ("NA") G20= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A20=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A20=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A20=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A20=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 20 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A22= ("egir51fl.dta") B22= (v000) D22= (v007) E22= ("3") F22= ("marriage & unions") G22= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A22=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A22=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A22=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A22=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 22 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- use v* using "`x'", clear
= use v* using "egir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label VCOL 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir51fl.dta"
egir51fl.dta
- di "`col_cat'"
= di "pregnancy & contraception (original)"
pregnancy & contraception (original)
- di col_example
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A24= ("egir51fl.dta") B24= (v000) D24= (v007) E24= ("6") F24= ("pregnancy & contraception (original)") G24
> = col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A24=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A24=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A24=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A24=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 24 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A26= ("egir5afl.dta") B26= (v000) D26= (v007) E26= ("3") F26= ("marriage & unions") G26= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A26=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A26=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A26=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A26=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 2
= local row = 26 + 2
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- use v* using "`x'", clear
= use v* using "egir5afl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_6
- local col_cat : label `col_label' `i'
= local col_cat : label LABDB 6
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "egir5afl.dta"
egir5afl.dta
- di "`col_cat'"
= di "original pregnancy/contraception codes (includes termination"
original pregnancy/contraception codes (includes termination
- di col_example
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A28= ("egir5afl.dta") B28= (v000) D28= (v007) E28= ("6") F28= ("original pregnancy/contraception codes (in
> cludes termination") G28= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A28=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A28=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A28=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A28=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
invalid syntax
    }
    }
  -------------------------------------------------------------------------------------------------- end putexcel ---
  local row = `row' + 2
  tab v007
  }
  }
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("set" == "set") {
  - gettoken subcmd 0 : 0, parse(" ,")
  - local 0 `"using `0'"'
  = local 0 `"using  "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify"'
  - syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
  - mata : putexcel_set_new()
  - }
  - else if ("`1'" == "describe") {
  = else if ("set" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("set" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("set" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
    mata : putexcel_cellexplist_new()
    }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A1=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A1=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A1=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A1=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 40.         
.         local row = `row' + 1
 41. tab v007
 42. */
.                 }
 43.                 
. }
- foreach x of local Clist{
- foreach i in 3 6{
- di "`x'"
= di "afir70fl.dta"
afir70fl.dta
- use v* using "`x'", clear
= use v* using "afir70fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_3 = "NA"
variable vcal_3 was str1 now str2
(29,461 real changes made)
- drop vcol_`i'
= drop vcol_3
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "afir70fl.dta"
afir70fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A2= ("afir70fl.dta") B2= (v000) D2= (v007) E2= ("3") F2= ("NA") G2= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A2=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A2=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A2=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A2=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 2 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
- }
- di "`x'"
= di "afir70fl.dta"
afir70fl.dta
- use v* using "`x'", clear
= use v* using "afir70fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(29,461 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "afir70fl.dta"
afir70fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A3= ("afir70fl.dta") B3= (v000) D3= (v007) E3= ("6") F3= ("NA") G3= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A3=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A3=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A3=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A3=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 3 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "alir50fl.dta"
alir50fl.dta
- use v* using "`x'", clear
= use v* using "alir50fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_3 = "NA"
variable vcal_3 was str1 now str2
(7,584 real changes made)
- drop vcol_`i'
= drop vcol_3
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "alir50fl.dta"
alir50fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A4= ("alir50fl.dta") B4= (v000) D4= (v007) E4= ("3") F4= ("NA") G4= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A4=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A4=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A4=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A4=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 4 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
- }
- di "`x'"
= di "alir50fl.dta"
alir50fl.dta
- use v* using "`x'", clear
= use v* using "alir50fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(7,584 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "alir50fl.dta"
alir50fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A5= ("alir50fl.dta") B5= (v000) D5= (v007) E5= ("6") F5= ("NA") G5= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A5=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A5=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A5=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A5=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 5 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "alir71fl.dta"
alir71fl.dta
- use v* using "`x'", clear
= use v* using "alir71fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_3 = "NA"
variable vcal_3 was str1 now str2
(15,000 real changes made)
- drop vcol_`i'
= drop vcol_3
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "alir71fl.dta"
alir71fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A6= ("alir71fl.dta") B6= (v000) D6= (v007) E6= ("3") F6= ("NA") G6= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A6=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A6=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A6=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A6=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 6 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
- }
- di "`x'"
= di "alir71fl.dta"
alir71fl.dta
- use v* using "`x'", clear
= use v* using "alir71fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(15,000 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "alir71fl.dta"
alir71fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A7= ("alir71fl.dta") B7= (v000) D7= (v007) E7= ("6") F7= ("NA") G7= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A7=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A7=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A7=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A7=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 7 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "amir42fl.dta"
amir42fl.dta
- use v* using "`x'", clear
= use v* using "amir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDT 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          00000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "amir42fl.dta"
amir42fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
         00000000000000000000000000000000000000000000000000000000000000000000000
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A8= ("amir42fl.dta") B8= (v000) D8= (v007) E8= ("3") F8= ("marriage & unions") G8= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A8=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A8=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A8=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A8=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 8 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
- }
- di "`x'"
= di "amir42fl.dta"
amir42fl.dta
- use v* using "`x'", clear
= use v* using "amir42fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
(6,430 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "amir42fl.dta"
amir42fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A9= ("amir42fl.dta") B9= (v000) D9= (v007) E9= ("6") F9= ("NA") G9= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A9=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A9=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A9=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A9=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 9 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "amir54fl.dta"
amir54fl.dta
- use v* using "`x'", clear
= use v* using "amir54fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- di "Marriage column exists and contains data"
Marriage column exists and contains data
- local col_label : value label vcol_`i'
= local col_label : value label vcol_3
- local col_cat : label `col_label' `i'
= local col_cat : label LABDY 3
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
- }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "amir54fl.dta"
amir54fl.dta
- di "`col_cat'"
= di "marriage & unions"
marriage & unions
- di col_example
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A10= ("amir54fl.dta") B10= (v000) D10= (v007) E10= ("3") F10= ("marriage & unions") G10= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A10=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A10=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A10=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A10=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 10 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
- }
- di "`x'"
= di "amir54fl.dta"
amir54fl.dta
- use v* using "`x'", clear
= use v* using "amir54fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(6,566 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "amir54fl.dta"
amir54fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A11= ("amir54fl.dta") B11= (v000) D11= (v007) E11= ("6") F11= ("NA") G11= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A11=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A11=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A11=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A11=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 11 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "amir61fl.dta"
amir61fl.dta
- use v* using "`x'", clear
= use v* using "amir61fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_3 = "NA"
variable vcal_3 was str1 now str2
(5,922 real changes made)
- drop vcol_`i'
= drop vcol_3
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "amir61fl.dta"
amir61fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A12= ("amir61fl.dta") B12= (v000) D12= (v007) E12= ("3") F12= ("NA") G12= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A12=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A12=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A12=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A12=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 12 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
- }
- di "`x'"
= di "amir61fl.dta"
amir61fl.dta
- use v* using "`x'", clear
= use v* using "amir61fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(5,922 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "amir61fl.dta"
amir61fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A13= ("amir61fl.dta") B13= (v000) D13= (v007) E13= ("6") F13= ("NA") G13= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A13=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A13=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A13=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A13=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 13 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "amir72fl.dta"
amir72fl.dta
- use v* using "`x'", clear
= use v* using "amir72fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_3=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_3 = "NA"
variable vcal_3 was str1 now str2
(6,116 real changes made)
- drop vcol_`i'
= drop vcol_3
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "amir72fl.dta"
amir72fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A14= ("amir72fl.dta") B14= (v000) D14= (v007) E14= ("3") F14= ("NA") G14= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A14=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A14=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A14=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A14=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 14 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
- }
- di "`x'"
= di "amir72fl.dta"
amir72fl.dta
- use v* using "`x'", clear
= use v* using "amir72fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
- else {
- if vcal_`col`i''=="" {
= if vcal_6=="" {
- di "Marriage column exists but is empty"
Marriage column exists but is empty
- replace vcal_`i' = "NA"
= replace vcal_6 = "NA"
variable vcal_6 was str1 now str2
(6,116 real changes made)
- drop vcol_`i'
= drop vcol_6
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
- }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "amir72fl.dta"
amir72fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A15= ("amir72fl.dta") B15= (v000) D15= (v007) E15= ("6") F15= ("NA") G15= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A15=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A15=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A15=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A15=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 15 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "aoir51fl.dta"
aoir51fl.dta
- use v* using "`x'", clear
= use v* using "aoir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "aoir51fl.dta"
aoir51fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A16= ("aoir51fl.dta") B16= (v000) D16= (v007) E16= ("3") F16= ("NA") G16= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A16=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A16=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A16=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A16=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 16 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
- }
- di "`x'"
= di "aoir51fl.dta"
aoir51fl.dta
- use v* using "`x'", clear
= use v* using "aoir51fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_6
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_6 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_6 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_6 in 1/1

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_6 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
- di "`i'"
= di "6"
6
- di "`x'"
= di "aoir51fl.dta"
aoir51fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A17= ("aoir51fl.dta") B17= (v000) D17= (v007) E17= ("6") F17= ("NA") G17= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A17=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A17=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A17=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A17=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 17 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
- }
- }
- foreach i in 3 6{
- di "`x'"
= di "aoir62fl.dta"
aoir62fl.dta
- use v* using "`x'", clear
= use v* using "aoir62fl.dta", clear
- local col1 1
- local col2 2
- local col3 3
- local col4 4
- local col6 6
- capture confirm variable vcal_`col`i''
= capture confirm variable vcal_3
- if _rc!=0 {
- di "Marriage column does not exist"
Marriage column does not exist
- gen vcal_`i' = "NA"
= gen vcal_3 = "NA"
- gen vcol_`i' = "NA"
= gen vcol_3 = "NA"
- local col_cat NA
- }
- else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
- list vcal_`i' in 1/1
= list vcal_3 in 1/1

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+
- scalar col_example = vcal_`i' in 1/1
= scalar col_example = vcal_3 in 1/1
- tab v000

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
- di "`i'"
= di "3"
3
- di "`x'"
= di "aoir62fl.dta"
aoir62fl.dta
- di "`col_cat'"
= di "NA"
NA
- di col_example
NA
- putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
= putexcel A18= ("aoir62fl.dta") B18= (v000) D18= (v007) E18= ("3") F18= ("NA") G18= col_example
  ------------------------------------------------------------------------------------------------ begin putexcel ---
  - version 13
  - if ("`c(excelsupport)'" != "1") {
  = if ("1" != "1") {
    dis as err "putexcel is not supported on this platform."
    exit 198
    }
  - if (_caller()<14.1) {
    cap syntax anything(name=cellexplist id="cellexplist" equalok) using/ [, SHeet(string) COLWise MODify KEEPCELLFor
> mat locale(string) REPLACE]
    if _rc {
    if ("`1'" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [,MODify REPLACE SHeet(string) KEEPCELLFormat locale(string)]
    mata : putexcel_adv_set()
    }
    else if ("`1'" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_describe()
    }
    else if ("`1'" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_adv_clear()
    }
    else {
    syntax anything(name=cellexplist id="cellexplist" equalok) [, SHeet(string) COLWise]
    mata : putexcel_adv_cellexplist()
    }
    }
    else {
    mata : putexcel()
    }
    }
  - else {
  - if ("`1'" == "set") {
  = if ("A18=" == "set") {
    gettoken subcmd 0 : 0, parse(" ,")
    local 0 `"using `0'"'
    syntax using / [, REPLACE MODify SHeet(string asis) locale(string) OPEN]
    mata : putexcel_set_new()
    }
  - else if ("`1'" == "describe") {
  = else if ("A18=" == "describe") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_describe_new()
    }
  - else if ("`1'" == "clear") {
  = else if ("A18=" == "clear") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_clear_new()
    }
  - else if ("`1'" == "close") {
  = else if ("A18=" == "close") {
    if ("`2'" != "") {
    di as err "invalid syntax"
    exit 198
    }
    mata : putexcel_close_new()
    }
  - else {
  - syntax anything(name=cellexplist id="cellexplist" equalok) [, OVERWRitefmt asdate asdatetime asdatenum asdatetime
> num names rownames colnames COLWise NFORmat(string) script(string) nobold noitalic noUNDERLine noSTRIKEout notxtwra
> p noSHRINKfit noFMTLock noFMTHidden hcenter left right bottom top vcenter TXTINdent(integer -1) TXTROtate(integer -
> 1) font(string asis) BORDer(string asis) DBORDer(string asis) FPATtern(string asis) merge unmerge ]
  - mata : putexcel_cellexplist_new()
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved
  - }
  - }
  -------------------------------------------------------------------------------------------------- end putexcel ---
- local row = `row' + 1
= local row = 18 + 1
- tab v007

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
- }
- di "`x'"
= di "aoir62fl.dta"
aoir62fl.dta
- use v* using "`x'", clear
= use v* using "aoir62fl.dta", clear
- local col1 1
  local col2 2
  local col3 3
  local col4 4
  local col6 6
  capture confirm variable vcal_`col`i''
  if _rc!=0 {
  di "Marriage column does not exist"
  gen vcal_`i' = "NA"
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  if vcal_`col`i''=="" {
  di "Marriage column exists but is empty"
  replace vcal_`i' = "NA"
  drop vcol_`i'
  gen vcol_`i' = "NA"
  local col_cat NA
  }
  else {
  di "Marriage column exists and contains data"
  local col_label : value label vcol_`i'
  local col_cat : label `col_label' `i'
  tab v000
  }
  }
  list vcal_`i' in 1/1
  scalar col_example = vcal_`i' in 1/1
  tab v000
  di "`i'"
  di "`x'"
  di "`col_cat'"
  di col_example
  putexcel A`row'= ("`x'") B`row'= (v000) D`row'= (v007) E`row'= ("`i'") F`row'= ("`col_cat'") G`row'= col_example
  local row = `row' + 1
  tab v007
  }
  }
--Break--
r(1);

end of do-file

--Break--
r(1);

. set trace off

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 40.         
.         local row = `row' + 1
 41. tab v007
 42. */
.                 }
 43.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
afir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
6
afir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
alir50fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
3
alir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
alir50fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
6
alir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
alir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
3
alir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
alir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
6
alir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
amir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          00000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
3
amir42fl.dta
marriage & unions
         00000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
amir42fl.dta
Marriage column exists but is empty
(6,430 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
6
amir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
amir54fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
3
amir54fl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
amir54fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,566 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
6
amir54fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
amir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
3
amir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
amir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
6
amir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
amir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
3
amir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
amir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
6
amir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
3
aoir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
6
aoir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
3
aoir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
6
aoir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
aoir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO7 |     14,379      100.00      100.00
------------+-----------------------------------
      Total |     14,379      100.00
3
aoir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,266       50.53       50.53
       2016 |      7,113       49.47      100.00
------------+-----------------------------------
      Total |     14,379      100.00
aoir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO7 |     14,379      100.00      100.00
------------+-----------------------------------
      Total |     14,379      100.00
6
aoir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,266       50.53       50.53
       2016 |      7,113       49.47      100.00
------------+-----------------------------------
      Total |     14,379      100.00
azir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AZ5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
3
azir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
azir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AZ5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
6
azir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
bdir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00
3
bdir31fl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      3,757       38.97       38.97
         94 |      5,883       61.03      100.00
------------+-----------------------------------
      Total |      9,640      100.00
bdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00
6
bdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      3,757       38.97       38.97
         94 |      5,883       61.03      100.00
------------+-----------------------------------
      Total |      9,640      100.00
bdir3afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00
3
bdir3afl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,513       49.45       49.45
         97 |      4,614       50.55      100.00
------------+-----------------------------------
      Total |      9,127      100.00
bdir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00
6
bdir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,513       49.45       49.45
         97 |      4,614       50.55      100.00
------------+-----------------------------------
      Total |      9,127      100.00
bdir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00
3
bdir41fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      5,672       53.79       53.79
         99 |      4,872       46.21      100.00
------------+-----------------------------------
      Total |     10,544      100.00
bdir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00
6
bdir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      5,672       53.79       53.79
         99 |      4,872       46.21      100.00
------------+-----------------------------------
      Total |     10,544      100.00
bdir4jfl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
3
bdir4jfl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
bdir4jfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,440 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
6
bdir4jfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
bdir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD5 |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
3
bdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
bdir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD5 |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
6
bdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
bdir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
3
bdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
bdir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
6
bdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
bdir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
3
bdir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
bdir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
6
bdir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF2 |      6,354      100.00      100.00
------------+-----------------------------------
      Total |      6,354      100.00
3
bfir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,552       24.43       24.43
         93 |      4,802       75.57      100.00
------------+-----------------------------------
      Total |      6,354      100.00
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF2 |      6,354      100.00      100.00
------------+-----------------------------------
      Total |      6,354      100.00
6
bfir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,552       24.43       24.43
         93 |      4,802       75.57      100.00
------------+-----------------------------------
      Total |      6,354      100.00
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF3 |      6,445      100.00      100.00
------------+-----------------------------------
      Total |      6,445      100.00
3
bfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,082       32.30       32.30
         99 |      4,363       67.70      100.00
------------+-----------------------------------
      Total |      6,445      100.00
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF3 |      6,445      100.00      100.00
------------+-----------------------------------
      Total |      6,445      100.00
6
bfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,082       32.30       32.30
         99 |      4,363       67.70      100.00
------------+-----------------------------------
      Total |      6,445      100.00
bfir43fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF4 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
3
bfir43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
bfir43fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF4 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
6
bfir43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
3
bfir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
6
bfir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
3
bfir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
6
bfir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ3 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
3
bjir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ3 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
6
bjir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ4 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
3
bjir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ4 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
6
bjir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
bjir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ5 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
3
bjir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
bjir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ5 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
6
bjir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ6 |     16,599      100.00      100.00
------------+-----------------------------------
      Total |     16,599      100.00
3
bjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,909       11.50       11.50
       2012 |     14,690       88.50      100.00
------------+-----------------------------------
      Total |     16,599      100.00
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ6 |     16,599      100.00      100.00
------------+-----------------------------------
      Total |     16,599      100.00
6
bjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,909       11.50       11.50
       2012 |     14,690       88.50      100.00
------------+-----------------------------------
      Total |     16,599      100.00
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BO |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
3
boir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BO |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
6
boir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
boir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                    0000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00
3
boir31fl.dta
marriage & unions
                   0000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      1,315       15.29       15.29
         94 |      7,288       84.71      100.00
------------+-----------------------------------
      Total |      8,603      100.00
boir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00
6
boir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      1,315       15.29       15.29
         94 |      7,288       84.71      100.00
------------+-----------------------------------
      Total |      8,603      100.00
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
3
boir3bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
6
boir3bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
boir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00
3
boir41fl.dta
marriage & unions
       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     15,565       88.17       88.17
       2004 |      2,089       11.83      100.00
------------+-----------------------------------
      Total |     17,654      100.00
boir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,654 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00
6
boir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     15,565       88.17       88.17
       2004 |      2,089       11.83      100.00
------------+-----------------------------------
      Total |     17,654      100.00
boir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO5 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
3
boir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
boir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO5 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
6
boir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BR |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
3
brir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BR |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
6
brir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
brir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00

     +------------------------------------+
     |                             vcal_3 |
     |------------------------------------|
  1. |         X                        X |
     +------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00
3
brir21fl.dta
postpart. amenorrhea
        X                        X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,936       95.39       95.39
         92 |        287        4.61      100.00
------------+-----------------------------------
      Total |      6,223      100.00
brir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00
6
brir21fl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,936       95.39       95.39
         92 |        287        4.61      100.00
------------+-----------------------------------
      Total |      6,223      100.00
brir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                00000000000XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
3
brir31fl.dta
marriage & unions
               00000000000XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
brir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
6
brir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BU |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
3
buir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BU |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
6
buir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
buir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      9,389      100.00      100.00
------------+-----------------------------------
      Total |      9,389      100.00
3
buir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      8,151       86.81       86.81
       2011 |      1,238       13.19      100.00
------------+-----------------------------------
      Total |      9,389      100.00
buir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      9,389      100.00      100.00
------------+-----------------------------------
      Total |      9,389      100.00
6
buir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      8,151       86.81       86.81
       2011 |      1,238       13.19      100.00
------------+-----------------------------------
      Total |      9,389      100.00
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      5,149      100.00      100.00
------------+-----------------------------------
      Total |      5,149      100.00
3
buir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,133       99.69       99.69
       2013 |         16        0.31      100.00
------------+-----------------------------------
      Total |      5,149      100.00
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      5,149      100.00      100.00
------------+-----------------------------------
      Total |      5,149      100.00
6
buir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,133       99.69       99.69
       2013 |         16        0.31      100.00
------------+-----------------------------------
      Total |      5,149      100.00
buir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU7 |     17,269      100.00      100.00
------------+-----------------------------------
      Total |     17,269      100.00
3
buir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,012       57.98       57.98
       2017 |      7,257       42.02      100.00
------------+-----------------------------------
      Total |     17,269      100.00
buir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU7 |     17,269      100.00      100.00
------------+-----------------------------------
      Total |     17,269      100.00
6
buir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,012       57.98       57.98
       2017 |      7,257       42.02      100.00
------------+-----------------------------------
      Total |     17,269      100.00
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD5 |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
3
cdir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD5 |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
6
cdir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD6 |     18,827      100.00      100.00
------------+-----------------------------------
      Total |     18,827      100.00
3
cdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     14,646       77.79       77.79
       2014 |      4,181       22.21      100.00
------------+-----------------------------------
      Total |     18,827      100.00
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD6 |     18,827      100.00      100.00
------------+-----------------------------------
      Total |     18,827      100.00
6
cdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     14,646       77.79       77.79
       2014 |      4,181       22.21      100.00
------------+-----------------------------------
      Total |     18,827      100.00
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CF3 |      5,884      100.00      100.00
------------+-----------------------------------
      Total |      5,884      100.00
3
cfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      3,622       61.56       61.56
         95 |      2,262       38.44      100.00
------------+-----------------------------------
      Total |      5,884      100.00
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CF3 |      5,884      100.00      100.00
------------+-----------------------------------
      Total |      5,884      100.00
6
cfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      3,622       61.56       61.56
         95 |      2,262       38.44      100.00
------------+-----------------------------------
      Total |      5,884      100.00
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
3
cgir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
6
cgir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
3
cgir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
6
cgir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG6 |     10,819      100.00      100.00
------------+-----------------------------------
      Total |     10,819      100.00
3
cgir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      9,301       85.97       85.97
       2012 |      1,518       14.03      100.00
------------+-----------------------------------
      Total |     10,819      100.00
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG6 |     10,819      100.00      100.00
------------+-----------------------------------
      Total |     10,819      100.00
6
cgir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      9,301       85.97       85.97
       2012 |      1,518       14.03      100.00
------------+-----------------------------------
      Total |     10,819      100.00
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
3
ciir35fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
6
ciir35fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      3,040      100.00      100.00
------------+-----------------------------------
      Total |      3,040      100.00
3
ciir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1998 |      1,521       50.03       50.03
       1999 |      1,519       49.97      100.00
------------+-----------------------------------
      Total |      3,040      100.00
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      3,040      100.00      100.00
------------+-----------------------------------
      Total |      3,040      100.00
6
ciir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1998 |      1,521       50.03       50.03
       1999 |      1,519       49.97      100.00
------------+-----------------------------------
      Total |      3,040      100.00
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI5 |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
3
ciir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI5 |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
6
ciir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI6 |     10,060      100.00      100.00
------------+-----------------------------------
      Total |     10,060      100.00
3
ciir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,357       13.49       13.49
       2012 |      8,703       86.51      100.00
------------+-----------------------------------
      Total |     10,060      100.00
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI6 |     10,060      100.00      100.00
------------+-----------------------------------
      Total |     10,060      100.00
6
ciir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,357       13.49       13.49
       2012 |      8,703       86.51      100.00
------------+-----------------------------------
      Total |     10,060      100.00
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM2 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
3
cmir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM2 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
6
cmir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM3 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
3
cmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM3 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
6
cmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
cmir44fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM4 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
3
cmir44fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
cmir44fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM4 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
6
cmir44fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM6 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
3
cmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM6 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
6
cmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         CO |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
3
coir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         CO |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
6
coir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
coir22fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00

     +------------------------------------------+
     |                                   vcal_3 |
     |------------------------------------------|
  1. |                                 XXXXXXXX |
     +------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
3
coir22fl.dta
postpart. amenorrhea
                                XXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
coir22fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
6
coir22fl.dta
marriage & unions
             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
coir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 0000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
3
coir31fl.dta
marriage & unions
                0000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
coir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
6
coir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
coir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
3
coir41fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
coir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,585 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
6
coir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
coir53fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00
3
coir53fl.dta
marriage & unions
      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,111       24.46       24.46
       2005 |     31,233       75.54      100.00
------------+-----------------------------------
      Total |     41,344      100.00
coir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(41,344 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00
6
coir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,111       24.46       24.46
       2005 |     31,233       75.54      100.00
------------+-----------------------------------
      Total |     41,344      100.00
coir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO5 |     53,521      100.00      100.00
------------+-----------------------------------
      Total |     53,521      100.00
3
coir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      5,066        9.47        9.47
       2010 |     48,455       90.53      100.00
------------+-----------------------------------
      Total |     53,521      100.00
coir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO5 |     53,521      100.00      100.00
------------+-----------------------------------
      Total |     53,521      100.00
6
coir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      5,066        9.47        9.47
       2010 |     48,455       90.53      100.00
------------+-----------------------------------
      Total |     53,521      100.00
coir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO7 |     38,718      100.00      100.00
------------+-----------------------------------
      Total |     38,718      100.00
3
coir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     31,515       81.40       81.40
       2016 |      7,203       18.60      100.00
------------+-----------------------------------
      Total |     38,718      100.00
coir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO7 |     38,718      100.00      100.00
------------+-----------------------------------
      Total |     38,718      100.00
6
coir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     31,515       81.40       81.40
       2016 |      7,203       18.60      100.00
------------+-----------------------------------
      Total |     38,718      100.00
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         DR |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
3
drir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         DR |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
6
drir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
drir21fl.dta
Marriage column exists but is empty
(7,320 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
3
drir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
drir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
6
drir21fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
drir32fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
3
drir32fl.dta
marriage & unions
           000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
drir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
6
drir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
drir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
3
drir41fl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
drir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
6
drir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
drir4afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
3
drir4afl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
drir4afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(23,384 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
6
drir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
3
drir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
6
drir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
3
drir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
6
drir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
3
drir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
6
drir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
3
drir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
6
drir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EC |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
3
ecir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EC |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
6
ecir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
3
egir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
6
egir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
egir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
3
egir21fl.dta
postpart. amenorrhea
        XXXX                                    X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
egir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
6
egir21fl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
egir33fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
3
egir33fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
egir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
6
egir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
egir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
3
egir42fl.dta
marriage & unions
                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
egir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
6
egir42fl.dta
original pregnancies & contraception (includes type of term)
                 X                             XX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
egir4afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
3
egir4afl.dta
marriage & unions
              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
egir4afl.dta
Marriage column exists but is empty
(9,159 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
6
egir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage.xlsx", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage.xlsx", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\marriage.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)                  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (""`col_cat'"") G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
unions"" invalid name
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (""`col_cat'"") G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
unions"" invalid name
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 local col_cat: = substr("`col_catz'",1,30) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
egir51fl.dta
Marriage column exists and contains data
= not allowed
r(101);

end of do-file

r(101);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 local col_cat: substr("`col_catz'",1,30) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
egir51fl.dta
Marriage column exists and contains data
substr not allowed
r(101);

end of do-file

r(101);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 local col_cat substr("`col_catz'",1,30) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
substr(marriage not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,30) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= ("`col_cat'")   G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta

                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta

                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta

                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta

                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_cat :  label `col_label' `i'
 29.                 *gen col_cat = substr("`col_catz'",1,30) 
. tab v000
 30.           }
 31.         }
 32. list vcal_`i' in 1/1
 33. scalar col_example = vcal_`i' in 1/1 
 34. tab v000
 35. 
. di "`i'"
 36. di "`x'"
 37. di "`col_cat'"
 38. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (`"`col_cat'"') G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contraception (original)
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy/contraception codes (includes termination
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
invalid syntax
r(198);

end of do-file

r(198);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "EGIR5???.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta

                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta

                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta

                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta

                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

. 
. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
workbook C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx could not be loaded
r(603);

end of do-file

r(603);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di "`col_cat'"
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
NA
NA
col_cat not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. 
. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
NA
col_cat not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\OneDrive - ICF\MarriageCalendar\Code\Cal_marr_surveysearch.do"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. 
. di col_example
 39. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 40. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 41.         
.         local row = `row' + 1
 42. tab v007
 43. */
.                 }
 44.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
NA
col_cat not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di col_cat
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
col_cat not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

.                 di "Marriage column exists and contains data"
Marriage column exists and contains data

.                 local col_label : value label vcol_`i'
vcol_ ambiguous abbreviation
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           local col_cat   NA
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 local col_cat   NA
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di col_cat
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
col_cat not found
r(111);

end of do-file

r(111);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. *
. #delimit ;
delimiter now ;
. global col3        "AMIR42      AMIR54  BDIR31  BDIR3A  BDIR41  BDIR4J  
>                                 BOIR31  BOIR41  BRIR31  COIR31  COIR41  COIR53  
>                                 DRIR32  DRIR41  DRIR4A  EGIR33  EGIR42  EGIR4A  
>                                 EGIR51          EGIR61  ETIR51  GUIR34  GUIR41          
>                                 IAIR52  IDIR31  IDIR3A  IDIR42  IDIR51  JOIR31  
>                                 JOIR42  KKIR42  KEIR3A  KEIR42  MWIR4E  MBIR53          
>                                 NCIR31  PEIR31  PEIR41  PEIR51  PEIR5I  PHIR3B  
>                                 PHIR41  TZIR4I  TRIR41  TRIR4A  VNIR31  VNIR41  
>                                 ZWIR31  ZWIR42  ZWIR52" ;

. *col b is col_6
> global col6        "BRIR21      COIR22  DRIR21  EGIR21  IDIR21  JOIR21  MAIR21  PYIR21  
>                                 PEIR21  PHIR31  TRIR31" ;
.         #delimit cr
delimiter now cr
. 
. 
. //62 surveys, 25 countries i think - need more automated way to count
. //not in col 3,4, or 6
. /*                              AFIR70  ALIR50  BDIR51  BOIR51  BFIR43  COIR61
>                                 COIR72  GHIR4B  GHIR5A  GHIR72  GUIR71  GNIR52  
>                                 JOIR51  KEIR52  KEIR71  LSIR71  MDIR42  
>                                 MDIR51  MWIR7H  MLIR41  MAIR43  MZIR41  NPIR51
>                                 NCIR41  NGIR53  SNIR4H  SLIR51  SZIR51  UGIR52     EGIR5A
> */
. //TRIR52 NOT FOUND (turkey - ask Trevor)
. //TMIR42 NOT FOUND (turkmenistan - maybe not publicly available)
. local row = 2

. 
. local C "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"

. 
. local Clist: dir "`C'" files "??IR????.DTA"

. 
. 
. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify

. 
.         putexcel A1= ("Survey")         B1= ("Country/Phase")   C1= ("Phase")   D1= ("Year") ///
>                          E1= ("Col No.")        F1= ("Category")                G1= ("Example") ///
> 
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

. foreach x of  local Clist{
  2. foreach i in 3 6{
  3. * open the dataset to use
. di "`x'"
  4. use v* using "`x'", clear
  5. *keep caseid v00*  v011 v017 v018 v019 v021 v023 v101 v102 v106 vcal_* vcal* 
. 
. * set up which calendar columns to look at - column numbers can vary across phases of DHS
.         local col1 1 // method use and pregnancies - always column 1
  6.         local col2 2 // reasons for discontinuation - usually column 2
  7.         local col3 3 // marriage - when it exists it is usually column 3
  8.         local col4 4 // marriage might have been col 4 in DHS Phase
  9.         local col6 6 // marriage might have been col 6 in DHS Phase 2
 10. * check if marriage column exists
. capture confirm variable vcal_`col`i''
 11.         if _rc!=0 { // variable does not exist
 12.           di "Marriage column does not exist"
 13.           gen vcal_`i' = "NA"
 14.           gen vcol_`i' = "NA"
 15.           gen col_cat  = "NA"
 16.                 }
 17.         else { // variable exists, but is it empty?
 18.           if vcal_`col`i''=="" { //variable is empty
 19.                 di "Marriage column exists but is empty"
 20.                 replace vcal_`i' = "NA"
 21.                 drop vcol_`i'
 22.                 gen vcol_`i' = "NA"
 23.                 gen col_cat =  "NA"
 24. 
.           }
 25.           else {
 26.                 di "Marriage column exists and contains data"
 27.                 local col_label : value label vcol_`i'
 28.                 local col_catz :  label `col_label' `i'
 29.                 gen col_cat = substr("`col_catz'",1,18) 
 30. tab v000
 31.           }
 32.         }
 33. list vcal_`i' in 1/1
 34. scalar col_example = vcal_`i' in 1/1 
 35. tab v000
 36. 
. di "`i'"
 37. di "`x'"
 38. di col_cat
 39. di col_example
 40. 
. putexcel set "C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union", sheet("Survey Search") modify
 41. putexcel         A`row'= ("`x'")        B`row'= (v000)  D`row'= (v007)  ///
>                          E`row'= ("`i'")        F`row'= (col_cat)       G`row'= col_example
 42.         
.         local row = `row' + 1
 43. tab v007
 44. */
.                 }
 45.                 
. }
afir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
3
afir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
afir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(29,461 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AF7 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
6
afir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1394 |     29,461      100.00      100.00
------------+-----------------------------------
      Total |     29,461      100.00
alir50fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
3
alir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
alir50fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,584 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL5 |      7,584      100.00      100.00
------------+-----------------------------------
      Total |      7,584      100.00
6
alir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      2,700       35.60       35.60
            |      4,884       64.40      100.00
------------+-----------------------------------
      Total |      7,584      100.00
alir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
3
alir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
alir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(15,000 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AL7 |     15,000      100.00      100.00
------------+-----------------------------------
      Total |     15,000      100.00
6
alir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     11,943       79.62       79.62
       2018 |      3,057       20.38      100.00
------------+-----------------------------------
      Total |     15,000      100.00
amir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          00000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
3
amir42fl.dta
marriage & unions
         00000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
amir42fl.dta
Marriage column exists but is empty
(6,430 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
6
amir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,430      100.00      100.00
------------+-----------------------------------
      Total |      6,430      100.00
amir54fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
3
amir54fl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
amir54fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,566 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM4 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
6
amir54fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,566      100.00      100.00
------------+-----------------------------------
      Total |      6,566      100.00
amir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
3
amir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
amir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(5,922 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM6 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
6
amir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      5,922      100.00      100.00
------------+-----------------------------------
      Total |      5,922      100.00
amir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
3
amir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
amir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,116 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AM7 |      6,116      100.00      100.00
------------+-----------------------------------
      Total |      6,116      100.00
6
amir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      1,389       22.71       22.71
       2016 |      4,727       77.29      100.00
------------+-----------------------------------
      Total |      6,116      100.00
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
3
aoir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
aoir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      2,972      100.00      100.00
------------+-----------------------------------
      Total |      2,972      100.00
6
aoir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      1,779       59.86       59.86
       2007 |      1,193       40.14      100.00
------------+-----------------------------------
      Total |      2,972      100.00
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
3
aoir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
aoir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO5 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
6
aoir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,589      100.00      100.00
------------+-----------------------------------
      Total |      8,589      100.00
aoir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO7 |     14,379      100.00      100.00
------------+-----------------------------------
      Total |     14,379      100.00
3
aoir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,266       50.53       50.53
       2016 |      7,113       49.47      100.00
------------+-----------------------------------
      Total |     14,379      100.00
aoir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,379 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AO7 |     14,379      100.00      100.00
------------+-----------------------------------
      Total |     14,379      100.00
6
aoir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,266       50.53       50.53
       2016 |      7,113       49.47      100.00
------------+-----------------------------------
      Total |     14,379      100.00
azir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AZ5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
3
azir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
azir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        AZ5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
6
azir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
bdir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00
3
bdir31fl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      3,757       38.97       38.97
         94 |      5,883       61.03      100.00
------------+-----------------------------------
      Total |      9,640      100.00
bdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,640      100.00      100.00
------------+-----------------------------------
      Total |      9,640      100.00
6
bdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      3,757       38.97       38.97
         94 |      5,883       61.03      100.00
------------+-----------------------------------
      Total |      9,640      100.00
bdir3afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00
3
bdir3afl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,513       49.45       49.45
         97 |      4,614       50.55      100.00
------------+-----------------------------------
      Total |      9,127      100.00
bdir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |      9,127      100.00      100.00
------------+-----------------------------------
      Total |      9,127      100.00
6
bdir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,513       49.45       49.45
         97 |      4,614       50.55      100.00
------------+-----------------------------------
      Total |      9,127      100.00
bdir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00
3
bdir41fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      5,672       53.79       53.79
         99 |      4,872       46.21      100.00
------------+-----------------------------------
      Total |     10,544      100.00
bdir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD3 |     10,544      100.00      100.00
------------+-----------------------------------
      Total |     10,544      100.00
6
bdir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      5,672       53.79       53.79
         99 |      4,872       46.21      100.00
------------+-----------------------------------
      Total |     10,544      100.00
bdir4jfl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
3
bdir4jfl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
bdir4jfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,440 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD4 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
6
bdir4jfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     11,440      100.00      100.00
------------+-----------------------------------
      Total |     11,440      100.00
bdir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD5 |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
3
bdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
bdir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,996 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD5 |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
6
bdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,996      100.00      100.00
------------+-----------------------------------
      Total |     10,996      100.00
bdir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
3
bdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
bdir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,842 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
6
bdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     17,842      100.00      100.00
------------+-----------------------------------
      Total |     17,842      100.00
bdir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
3
bdir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
bdir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,863 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BD6 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
6
bdir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,863      100.00      100.00
------------+-----------------------------------
      Total |     17,863      100.00
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF2 |      6,354      100.00      100.00
------------+-----------------------------------
      Total |      6,354      100.00
3
bfir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,552       24.43       24.43
         93 |      4,802       75.57      100.00
------------+-----------------------------------
      Total |      6,354      100.00
bfir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF2 |      6,354      100.00      100.00
------------+-----------------------------------
      Total |      6,354      100.00
6
bfir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,552       24.43       24.43
         93 |      4,802       75.57      100.00
------------+-----------------------------------
      Total |      6,354      100.00
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF3 |      6,445      100.00      100.00
------------+-----------------------------------
      Total |      6,445      100.00
3
bfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,082       32.30       32.30
         99 |      4,363       67.70      100.00
------------+-----------------------------------
      Total |      6,445      100.00
bfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF3 |      6,445      100.00      100.00
------------+-----------------------------------
      Total |      6,445      100.00
6
bfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,082       32.30       32.30
         99 |      4,363       67.70      100.00
------------+-----------------------------------
      Total |      6,445      100.00
bfir43fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF4 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
3
bfir43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
bfir43fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,477 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF4 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
6
bfir43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,477      100.00      100.00
------------+-----------------------------------
      Total |     12,477      100.00
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
3
bfir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
bfir62fl.dta
Marriage column exists but is empty
(17,087 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
6
bfir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     17,087      100.00      100.00
------------+-----------------------------------
      Total |     17,087      100.00
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
3
bfir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
bfir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BF6 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
6
bfir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,111      100.00      100.00
------------+-----------------------------------
      Total |      8,111      100.00
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ3 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
3
bjir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
bjir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ3 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
6
bjir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      5,491      100.00      100.00
------------+-----------------------------------
      Total |      5,491      100.00
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ4 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
3
bjir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
bjir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ4 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
6
bjir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      6,219      100.00      100.00
------------+-----------------------------------
      Total |      6,219      100.00
bjir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ5 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
3
bjir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
bjir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,794 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ5 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
6
bjir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     17,794      100.00      100.00
------------+-----------------------------------
      Total |     17,794      100.00
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ6 |     16,599      100.00      100.00
------------+-----------------------------------
      Total |     16,599      100.00
3
bjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,909       11.50       11.50
       2012 |     14,690       88.50      100.00
------------+-----------------------------------
      Total |     16,599      100.00
bjir61fl.dta
Marriage column exists but is empty
(16,599 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BJ6 |     16,599      100.00      100.00
------------+-----------------------------------
      Total |     16,599      100.00
6
bjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,909       11.50       11.50
       2012 |     14,690       88.50      100.00
------------+-----------------------------------
      Total |     16,599      100.00
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BO |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
3
boir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
boir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BO |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
6
boir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      7,923      100.00      100.00
------------+-----------------------------------
      Total |      7,923      100.00
boir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                    0000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00
3
boir31fl.dta
marriage & unions
                   0000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      1,315       15.29       15.29
         94 |      7,288       84.71      100.00
------------+-----------------------------------
      Total |      8,603      100.00
boir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |      8,603      100.00      100.00
------------+-----------------------------------
      Total |      8,603      100.00
6
boir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      1,315       15.29       15.29
         94 |      7,288       84.71      100.00
------------+-----------------------------------
      Total |      8,603      100.00
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
3
boir3bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
boir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO3 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
6
boir3bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,187      100.00      100.00
------------+-----------------------------------
      Total |     11,187      100.00
boir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00
3
boir41fl.dta
marriage & unions
       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     15,565       88.17       88.17
       2004 |      2,089       11.83      100.00
------------+-----------------------------------
      Total |     17,654      100.00
boir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,654 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO4 |     17,654      100.00      100.00
------------+-----------------------------------
      Total |     17,654      100.00
6
boir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     15,565       88.17       88.17
       2004 |      2,089       11.83      100.00
------------+-----------------------------------
      Total |     17,654      100.00
boir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO5 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
3
boir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
boir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,939 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BO5 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
6
boir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,939      100.00      100.00
------------+-----------------------------------
      Total |     16,939      100.00
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BR |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
3
brir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
brir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BR |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
6
brir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,892      100.00      100.00
------------+-----------------------------------
      Total |      5,892      100.00
brir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00

     +------------------------------------+
     |                             vcal_3 |
     |------------------------------------|
  1. |         X                        X |
     +------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00
3
brir21fl.dta
postpart. amenorrh
        X                        X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,936       95.39       95.39
         92 |        287        4.61      100.00
------------+-----------------------------------
      Total |      6,223      100.00
brir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR2 |      6,223      100.00      100.00
------------+-----------------------------------
      Total |      6,223      100.00
6
brir21fl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX0000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,936       95.39       95.39
         92 |        287        4.61      100.00
------------+-----------------------------------
      Total |      6,223      100.00
brir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                00000000000XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
3
brir31fl.dta
marriage & unions
               00000000000XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
brir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BR3 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
6
brir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     12,612      100.00      100.00
------------+-----------------------------------
      Total |     12,612      100.00
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BU |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
3
buir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
buir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         BU |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
6
buir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,970      100.00      100.00
------------+-----------------------------------
      Total |      3,970      100.00
buir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      9,389      100.00      100.00
------------+-----------------------------------
      Total |      9,389      100.00
3
buir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      8,151       86.81       86.81
       2011 |      1,238       13.19      100.00
------------+-----------------------------------
      Total |      9,389      100.00
buir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,389 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      9,389      100.00      100.00
------------+-----------------------------------
      Total |      9,389      100.00
6
buir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      8,151       86.81       86.81
       2011 |      1,238       13.19      100.00
------------+-----------------------------------
      Total |      9,389      100.00
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      5,149      100.00      100.00
------------+-----------------------------------
      Total |      5,149      100.00
3
buir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,133       99.69       99.69
       2013 |         16        0.31      100.00
------------+-----------------------------------
      Total |      5,149      100.00
buir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU6 |      5,149      100.00      100.00
------------+-----------------------------------
      Total |      5,149      100.00
6
buir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,133       99.69       99.69
       2013 |         16        0.31      100.00
------------+-----------------------------------
      Total |      5,149      100.00
buir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU7 |     17,269      100.00      100.00
------------+-----------------------------------
      Total |     17,269      100.00
3
buir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,012       57.98       57.98
       2017 |      7,257       42.02      100.00
------------+-----------------------------------
      Total |     17,269      100.00
buir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,269 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        BU7 |     17,269      100.00      100.00
------------+-----------------------------------
      Total |     17,269      100.00
6
buir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,012       57.98       57.98
       2017 |      7,257       42.02      100.00
------------+-----------------------------------
      Total |     17,269      100.00
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD5 |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
3
cdir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
cdir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD5 |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
6
cdir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,995      100.00      100.00
------------+-----------------------------------
      Total |      9,995      100.00
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD6 |     18,827      100.00      100.00
------------+-----------------------------------
      Total |     18,827      100.00
3
cdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     14,646       77.79       77.79
       2014 |      4,181       22.21      100.00
------------+-----------------------------------
      Total |     18,827      100.00
cdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CD6 |     18,827      100.00      100.00
------------+-----------------------------------
      Total |     18,827      100.00
6
cdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     14,646       77.79       77.79
       2014 |      4,181       22.21      100.00
------------+-----------------------------------
      Total |     18,827      100.00
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CF3 |      5,884      100.00      100.00
------------+-----------------------------------
      Total |      5,884      100.00
3
cfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      3,622       61.56       61.56
         95 |      2,262       38.44      100.00
------------+-----------------------------------
      Total |      5,884      100.00
cfir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CF3 |      5,884      100.00      100.00
------------+-----------------------------------
      Total |      5,884      100.00
6
cfir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      3,622       61.56       61.56
         95 |      2,262       38.44      100.00
------------+-----------------------------------
      Total |      5,884      100.00
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
3
cgir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
cgir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
6
cgir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,051      100.00      100.00
------------+-----------------------------------
      Total |      7,051      100.00
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
3
cgir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
cgir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG5 |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
6
cgir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     12,413      100.00      100.00
------------+-----------------------------------
      Total |     12,413      100.00
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG6 |     10,819      100.00      100.00
------------+-----------------------------------
      Total |     10,819      100.00
3
cgir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      9,301       85.97       85.97
       2012 |      1,518       14.03      100.00
------------+-----------------------------------
      Total |     10,819      100.00
cgir60fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CG6 |     10,819      100.00      100.00
------------+-----------------------------------
      Total |     10,819      100.00
6
cgir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      9,301       85.97       85.97
       2012 |      1,518       14.03      100.00
------------+-----------------------------------
      Total |     10,819      100.00
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
3
ciir35fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
ciir35fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
6
ciir35fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      8,099      100.00      100.00
------------+-----------------------------------
      Total |      8,099      100.00
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      3,040      100.00      100.00
------------+-----------------------------------
      Total |      3,040      100.00
3
ciir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1998 |      1,521       50.03       50.03
       1999 |      1,519       49.97      100.00
------------+-----------------------------------
      Total |      3,040      100.00
ciir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI3 |      3,040      100.00      100.00
------------+-----------------------------------
      Total |      3,040      100.00
6
ciir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1998 |      1,521       50.03       50.03
       1999 |      1,519       49.97      100.00
------------+-----------------------------------
      Total |      3,040      100.00
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI5 |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
3
ciir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
ciir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI5 |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
6
ciir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      9,686      100.00      100.00
------------+-----------------------------------
      Total |      9,686      100.00
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI6 |     10,060      100.00      100.00
------------+-----------------------------------
      Total |     10,060      100.00
3
ciir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,357       13.49       13.49
       2012 |      8,703       86.51      100.00
------------+-----------------------------------
      Total |     10,060      100.00
ciir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CI6 |     10,060      100.00      100.00
------------+-----------------------------------
      Total |     10,060      100.00
6
ciir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      1,357       13.49       13.49
       2012 |      8,703       86.51      100.00
------------+-----------------------------------
      Total |     10,060      100.00
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM2 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
3
cmir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
cmir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM2 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
6
cmir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      3,871      100.00      100.00
------------+-----------------------------------
      Total |      3,871      100.00
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM3 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
3
cmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
cmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM3 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
6
cmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      5,501      100.00      100.00
------------+-----------------------------------
      Total |      5,501      100.00
cmir44fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM4 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
3
cmir44fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
cmir44fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,656 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM4 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
6
cmir44fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,656      100.00      100.00
------------+-----------------------------------
      Total |     10,656      100.00
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM6 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
3
cmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
cmir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CM6 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
6
cmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     15,426      100.00      100.00
------------+-----------------------------------
      Total |     15,426      100.00
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         CO |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
3
coir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
coir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         CO |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
6
coir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
coir22fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00

     +------------------------------------------+
     |                                   vcal_3 |
     |------------------------------------------|
  1. |                                 XXXXXXXX |
     +------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
3
coir22fl.dta
postpart. amenorrh
                                XXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
coir22fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO2 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
6
coir22fl.dta
marriage & unions
             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,644      100.00      100.00
------------+-----------------------------------
      Total |      8,644      100.00
coir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 0000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
3
coir31fl.dta
marriage & unions
                0000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
coir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO3 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
6
coir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     11,140      100.00      100.00
------------+-----------------------------------
      Total |     11,140      100.00
coir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
3
coir41fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
coir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,585 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
6
coir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     11,585      100.00      100.00
------------+-----------------------------------
      Total |     11,585      100.00
coir53fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00
3
coir53fl.dta
marriage & unions
      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,111       24.46       24.46
       2005 |     31,233       75.54      100.00
------------+-----------------------------------
      Total |     41,344      100.00
coir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(41,344 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO4 |     41,344      100.00      100.00
------------+-----------------------------------
      Total |     41,344      100.00
6
coir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |     10,111       24.46       24.46
       2005 |     31,233       75.54      100.00
------------+-----------------------------------
      Total |     41,344      100.00
coir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO5 |     53,521      100.00      100.00
------------+-----------------------------------
      Total |     53,521      100.00
3
coir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      5,066        9.47        9.47
       2010 |     48,455       90.53      100.00
------------+-----------------------------------
      Total |     53,521      100.00
coir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(53,521 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO5 |     53,521      100.00      100.00
------------+-----------------------------------
      Total |     53,521      100.00
6
coir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      5,066        9.47        9.47
       2010 |     48,455       90.53      100.00
------------+-----------------------------------
      Total |     53,521      100.00
coir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO7 |     38,718      100.00      100.00
------------+-----------------------------------
      Total |     38,718      100.00
3
coir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     31,515       81.40       81.40
       2016 |      7,203       18.60      100.00
------------+-----------------------------------
      Total |     38,718      100.00
coir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(38,718 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        CO7 |     38,718      100.00      100.00
------------+-----------------------------------
      Total |     38,718      100.00
6
coir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     31,515       81.40       81.40
       2016 |      7,203       18.60      100.00
------------+-----------------------------------
      Total |     38,718      100.00
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         DR |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
3
drir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
drir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         DR |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
6
drir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      7,645      100.00      100.00
------------+-----------------------------------
      Total |      7,645      100.00
drir21fl.dta
Marriage column exists but is empty
(7,320 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
3
drir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
drir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR2 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
6
drir21fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      7,320      100.00      100.00
------------+-----------------------------------
      Total |      7,320      100.00
drir32fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
3
drir32fl.dta
marriage & unions
           000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
drir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
6
drir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
drir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
3
drir41fl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
drir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR3 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
6
drir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      1,286      100.00      100.00
------------+-----------------------------------
      Total |      1,286      100.00
drir4afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
3
drir4afl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
drir4afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(23,384 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR4 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
6
drir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     23,384      100.00      100.00
------------+-----------------------------------
      Total |     23,384      100.00
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
3
drir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
drir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
6
drir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     27,195      100.00      100.00
------------+-----------------------------------
      Total |     27,195      100.00
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
3
drir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
drir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR5 |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
6
drir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      1,575      100.00      100.00
------------+-----------------------------------
      Total |      1,575      100.00
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
3
drir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
drir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
6
drir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,372      100.00      100.00
------------+-----------------------------------
      Total |      9,372      100.00
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
3
drir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
drir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        DR6 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
6
drir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      1,707      100.00      100.00
------------+-----------------------------------
      Total |      1,707      100.00
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EC |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
3
ecir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
ecir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EC |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
6
ecir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      4,713      100.00      100.00
------------+-----------------------------------
      Total |      4,713      100.00
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
3
egir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
egir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         EG |      8,911      100.00      100.00
------------+-----------------------------------
      Total |      8,911      100.00
6
egir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      8,652       97.09       97.09
         89 |        259        2.91      100.00
------------+-----------------------------------
      Total |      8,911      100.00
egir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00

     +---------------------------------------------------+
     |                                            vcal_3 |
     |---------------------------------------------------|
  1. |         XXXX                                    X |
     +---------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
3
egir21fl.dta
postpart. amenorrh
        XXXX                                    X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
egir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG2 |      9,864      100.00      100.00
------------+-----------------------------------
      Total |      9,864      100.00
6
egir21fl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,510       96.41       96.41
         93 |        354        3.59      100.00
------------+-----------------------------------
      Total |      9,864      100.00
egir33fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
3
egir33fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
egir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG3 |     14,779      100.00      100.00
------------+-----------------------------------
      Total |     14,779      100.00
6
egir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     14,248       96.41       96.41
         96 |        531        3.59      100.00
------------+-----------------------------------
      Total |     14,779      100.00
egir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
3
egir42fl.dta
marriage & unions
                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
egir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00

     +---------------------------------------------------+
     |                                            vcal_6 |
     |---------------------------------------------------|
  1. |                  X                             XX |
     +---------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
6
egir42fl.dta
original pregnanci
                 X                             XX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,573      100.00      100.00
------------+-----------------------------------
      Total |     15,573      100.00
egir4afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
3
egir4afl.dta
marriage & unions
              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
egir4afl.dta
Marriage column exists but is empty
(9,159 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
6
egir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      9,159      100.00      100.00
------------+-----------------------------------
      Total |      9,159      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
3
egir51fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX00
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG4 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
6
egir51fl.dta
pregnancy & contra
                333333333330BPPPPPPPP09999999999999999999999920BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     19,474      100.00      100.00
------------+-----------------------------------
      Total |     19,474      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
3
egir5afl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir5afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG5 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
6
egir5afl.dta
original pregnancy
                1111111111111111111111111111111110BPPPPPPPP01111111111111110BPPP
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     16,527      100.00      100.00
------------+-----------------------------------
      Total |     16,527      100.00
egir61fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
3
egir61fl.dta
marriage and union
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
egir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        EG6 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
6
egir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     21,762      100.00      100.00
------------+-----------------------------------
      Total |     21,762      100.00
esir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ES |      5,207      100.00      100.00
------------+-----------------------------------
      Total |      5,207      100.00
3
esir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         85 |      5,207      100.00      100.00
------------+-----------------------------------
      Total |      5,207      100.00
esir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ES |      5,207      100.00      100.00
------------+-----------------------------------
      Total |      5,207      100.00
6
esir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         85 |      5,207      100.00      100.00
------------+-----------------------------------
      Total |      5,207      100.00
etir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET4 |     15,367      100.00      100.00
------------+-----------------------------------
      Total |     15,367      100.00
3
etir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1992 |     15,367      100.00      100.00
------------+-----------------------------------
      Total |     15,367      100.00
etir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET4 |     15,367      100.00      100.00
------------+-----------------------------------
      Total |     15,367      100.00
6
etir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1992 |     15,367      100.00      100.00
------------+-----------------------------------
      Total |     15,367      100.00
etir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET4 |     14,070      100.00      100.00
------------+-----------------------------------
      Total |     14,070      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET4 |     14,070      100.00      100.00
------------+-----------------------------------
      Total |     14,070      100.00
3
etir51fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1997 |     14,070      100.00      100.00
------------+-----------------------------------
      Total |     14,070      100.00
etir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,070 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET4 |     14,070      100.00      100.00
------------+-----------------------------------
      Total |     14,070      100.00
6
etir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1997 |     14,070      100.00      100.00
------------+-----------------------------------
      Total |     14,070      100.00
etir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,515 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET6 |     16,515      100.00      100.00
------------+-----------------------------------
      Total |     16,515      100.00
3
etir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     16,515      100.00      100.00
------------+-----------------------------------
      Total |     16,515      100.00
etir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,515 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET6 |     16,515      100.00      100.00
------------+-----------------------------------
      Total |     16,515      100.00
6
etir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     16,515      100.00      100.00
------------+-----------------------------------
      Total |     16,515      100.00
etir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(15,683 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET7 |     15,683      100.00      100.00
------------+-----------------------------------
      Total |     15,683      100.00
3
etir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     15,683      100.00      100.00
------------+-----------------------------------
      Total |     15,683      100.00
etir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(15,683 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ET7 |     15,683      100.00      100.00
------------+-----------------------------------
      Total |     15,683      100.00
6
etir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     15,683      100.00      100.00
------------+-----------------------------------
      Total |     15,683      100.00
gair41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GA3 |      6,183      100.00      100.00
------------+-----------------------------------
      Total |      6,183      100.00
3
gair41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      6,068       98.14       98.14
       2001 |        115        1.86      100.00
------------+-----------------------------------
      Total |      6,183      100.00
gair41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GA3 |      6,183      100.00      100.00
------------+-----------------------------------
      Total |      6,183      100.00
6
gair41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      6,068       98.14       98.14
       2001 |        115        1.86      100.00
------------+-----------------------------------
      Total |      6,183      100.00
gair60fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,422 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GA6 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
3
gair60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
gair60fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,422 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GA6 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
6
gair60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      8,422      100.00      100.00
------------+-----------------------------------
      Total |      8,422      100.00
ghir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         GH |      4,488      100.00      100.00
------------+-----------------------------------
      Total |      4,488      100.00
3
ghir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      4,488      100.00      100.00
------------+-----------------------------------
      Total |      4,488      100.00
ghir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         GH |      4,488      100.00      100.00
------------+-----------------------------------
      Total |      4,488      100.00
6
ghir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      4,488      100.00      100.00
------------+-----------------------------------
      Total |      4,488      100.00
ghir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH2 |      4,562      100.00      100.00
------------+-----------------------------------
      Total |      4,562      100.00
3
ghir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      4,386       96.14       96.14
         94 |        176        3.86      100.00
------------+-----------------------------------
      Total |      4,562      100.00
ghir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH2 |      4,562      100.00      100.00
------------+-----------------------------------
      Total |      4,562      100.00
6
ghir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      4,386       96.14       96.14
         94 |        176        3.86      100.00
------------+-----------------------------------
      Total |      4,562      100.00
ghir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH3 |      4,843      100.00      100.00
------------+-----------------------------------
      Total |      4,843      100.00
3
ghir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,570       53.07       53.07
         99 |      2,273       46.93      100.00
------------+-----------------------------------
      Total |      4,843      100.00
ghir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH3 |      4,843      100.00      100.00
------------+-----------------------------------
      Total |      4,843      100.00
6
ghir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      2,570       53.07       53.07
         99 |      2,273       46.93      100.00
------------+-----------------------------------
      Total |      4,843      100.00
ghir4bfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(5,691 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH4 |      5,691      100.00      100.00
------------+-----------------------------------
      Total |      5,691      100.00
3
ghir4bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      5,691      100.00      100.00
------------+-----------------------------------
      Total |      5,691      100.00
ghir4bfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(5,691 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH4 |      5,691      100.00      100.00
------------+-----------------------------------
      Total |      5,691      100.00
6
ghir4bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      5,691      100.00      100.00
------------+-----------------------------------
      Total |      5,691      100.00
ghir5afl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(4,916 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH5 |      4,916      100.00      100.00
------------+-----------------------------------
      Total |      4,916      100.00
3
ghir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      4,916      100.00      100.00
------------+-----------------------------------
      Total |      4,916      100.00
ghir5afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(4,916 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH5 |      4,916      100.00      100.00
------------+-----------------------------------
      Total |      4,916      100.00
6
ghir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      4,916      100.00      100.00
------------+-----------------------------------
      Total |      4,916      100.00
ghir72fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,396 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH6 |      9,396      100.00      100.00
------------+-----------------------------------
      Total |      9,396      100.00
3
ghir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      9,396      100.00      100.00
------------+-----------------------------------
      Total |      9,396      100.00
ghir72fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,396 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH6 |      9,396      100.00      100.00
------------+-----------------------------------
      Total |      9,396      100.00
6
ghir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      9,396      100.00      100.00
------------+-----------------------------------
      Total |      9,396      100.00
ghir7bfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH7 |      5,150      100.00      100.00
------------+-----------------------------------
      Total |      5,150      100.00
3
ghir7bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      5,150      100.00      100.00
------------+-----------------------------------
      Total |      5,150      100.00
ghir7bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GH7 |      5,150      100.00      100.00
------------+-----------------------------------
      Total |      5,150      100.00
6
ghir7bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      5,150      100.00      100.00
------------+-----------------------------------
      Total |      5,150      100.00
gmir60fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,233 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GM6 |     10,233      100.00      100.00
------------+-----------------------------------
      Total |     10,233      100.00
3
gmir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     10,233      100.00      100.00
------------+-----------------------------------
      Total |     10,233      100.00
gmir60fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,233 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GM6 |     10,233      100.00      100.00
------------+-----------------------------------
      Total |     10,233      100.00
6
gmir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     10,233      100.00      100.00
------------+-----------------------------------
      Total |     10,233      100.00
gnir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN3 |      6,753      100.00      100.00
------------+-----------------------------------
      Total |      6,753      100.00
3
gnir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      6,753      100.00      100.00
------------+-----------------------------------
      Total |      6,753      100.00
gnir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN3 |      6,753      100.00      100.00
------------+-----------------------------------
      Total |      6,753      100.00
6
gnir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      6,753      100.00      100.00
------------+-----------------------------------
      Total |      6,753      100.00
gnir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,954 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN4 |      7,954      100.00      100.00
------------+-----------------------------------
      Total |      7,954      100.00
3
gnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      7,954      100.00      100.00
------------+-----------------------------------
      Total |      7,954      100.00
gnir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,954 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN4 |      7,954      100.00      100.00
------------+-----------------------------------
      Total |      7,954      100.00
6
gnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      7,954      100.00      100.00
------------+-----------------------------------
      Total |      7,954      100.00
gnir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN6 |      9,142      100.00      100.00
------------+-----------------------------------
      Total |      9,142      100.00
3
gnir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,142      100.00      100.00
------------+-----------------------------------
      Total |      9,142      100.00
gnir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GN6 |      9,142      100.00      100.00
------------+-----------------------------------
      Total |      9,142      100.00
6
gnir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,142      100.00      100.00
------------+-----------------------------------
      Total |      9,142      100.00
guir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         GU |      5,160      100.00      100.00
------------+-----------------------------------
      Total |      5,160      100.00
3
guir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,160      100.00      100.00
------------+-----------------------------------
      Total |      5,160      100.00
guir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         GU |      5,160      100.00      100.00
------------+-----------------------------------
      Total |      5,160      100.00
6
guir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,160      100.00      100.00
------------+-----------------------------------
      Total |      5,160      100.00
guir34fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |     12,403      100.00      100.00
------------+-----------------------------------
      Total |     12,403      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |     12,403      100.00      100.00
------------+-----------------------------------
      Total |     12,403      100.00
3
guir34fl.dta
marriage & unions
              000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     12,403      100.00      100.00
------------+-----------------------------------
      Total |     12,403      100.00
guir34fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |     12,403      100.00      100.00
------------+-----------------------------------
      Total |     12,403      100.00
6
guir34fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |     12,403      100.00      100.00
------------+-----------------------------------
      Total |     12,403      100.00
guir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |      6,021      100.00      100.00
------------+-----------------------------------
      Total |      6,021      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          00000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |      6,021      100.00      100.00
------------+-----------------------------------
      Total |      6,021      100.00
3
guir41fl.dta
marriage & unions
         00000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      1,209       20.08       20.08
         99 |      4,812       79.92      100.00
------------+-----------------------------------
      Total |      6,021      100.00
guir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU3 |      6,021      100.00      100.00
------------+-----------------------------------
      Total |      6,021      100.00
6
guir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      1,209       20.08       20.08
         99 |      4,812       79.92      100.00
------------+-----------------------------------
      Total |      6,021      100.00
guir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(25,914 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU6 |     25,914      100.00      100.00
------------+-----------------------------------
      Total |     25,914      100.00
3
guir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,112       31.30       31.30
       2015 |     17,802       68.70      100.00
------------+-----------------------------------
      Total |     25,914      100.00
guir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(25,914 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GU6 |     25,914      100.00      100.00
------------+-----------------------------------
      Total |     25,914      100.00
6
guir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,112       31.30       31.30
       2015 |     17,802       68.70      100.00
------------+-----------------------------------
      Total |     25,914      100.00
gyir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GY4 |      4,300      100.00      100.00
------------+-----------------------------------
      Total |      4,300      100.00
3
gyir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,300      100.00      100.00
------------+-----------------------------------
      Total |      4,300      100.00
gyir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GY4 |      4,300      100.00      100.00
------------+-----------------------------------
      Total |      4,300      100.00
6
gyir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,300      100.00      100.00
------------+-----------------------------------
      Total |      4,300      100.00
gyir5ifl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(4,996 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GY5 |      4,996      100.00      100.00
------------+-----------------------------------
      Total |      4,996      100.00
3
gyir5ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      4,996      100.00      100.00
------------+-----------------------------------
      Total |      4,996      100.00
gyir5ifl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(4,996 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        GY5 |      4,996      100.00      100.00
------------+-----------------------------------
      Total |      4,996      100.00
6
gyir5ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      4,996      100.00      100.00
------------+-----------------------------------
      Total |      4,996      100.00
hnir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(19,948 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HN5 |     19,948      100.00      100.00
------------+-----------------------------------
      Total |     19,948      100.00
3
hnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,567       22.89       22.89
       2006 |     15,381       77.11      100.00
------------+-----------------------------------
      Total |     19,948      100.00
hnir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(19,948 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HN5 |     19,948      100.00      100.00
------------+-----------------------------------
      Total |     19,948      100.00
6
hnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,567       22.89       22.89
       2006 |     15,381       77.11      100.00
------------+-----------------------------------
      Total |     19,948      100.00
hnir62fl.dta
Marriage column exists but is empty
(22,757 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HN6 |     22,757      100.00      100.00
------------+-----------------------------------
      Total |     22,757      100.00
3
hnir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     10,170       44.69       44.69
       2012 |     12,587       55.31      100.00
------------+-----------------------------------
      Total |     22,757      100.00
hnir62fl.dta
Marriage column exists but is empty
(22,757 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HN6 |     22,757      100.00      100.00
------------+-----------------------------------
      Total |     22,757      100.00
6
hnir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     10,170       44.69       44.69
       2012 |     12,587       55.31      100.00
------------+-----------------------------------
      Total |     22,757      100.00
htir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT3 |      5,356      100.00      100.00
------------+-----------------------------------
      Total |      5,356      100.00
3
htir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      4,846       90.48       90.48
         95 |        510        9.52      100.00
------------+-----------------------------------
      Total |      5,356      100.00
htir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT3 |      5,356      100.00      100.00
------------+-----------------------------------
      Total |      5,356      100.00
6
htir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      4,846       90.48       90.48
         95 |        510        9.52      100.00
------------+-----------------------------------
      Total |      5,356      100.00
htir42fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,159 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT4 |     10,159      100.00      100.00
------------+-----------------------------------
      Total |     10,159      100.00
3
htir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,159      100.00      100.00
------------+-----------------------------------
      Total |     10,159      100.00
htir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,159 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT4 |     10,159      100.00      100.00
------------+-----------------------------------
      Total |     10,159      100.00
6
htir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,159      100.00      100.00
------------+-----------------------------------
      Total |     10,159      100.00
htir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT5 |     10,757      100.00      100.00
------------+-----------------------------------
      Total |     10,757      100.00
3
htir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,282       39.81       39.81
       2006 |      6,475       60.19      100.00
------------+-----------------------------------
      Total |     10,757      100.00
htir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT5 |     10,757      100.00      100.00
------------+-----------------------------------
      Total |     10,757      100.00
6
htir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      4,282       39.81       39.81
       2006 |      6,475       60.19      100.00
------------+-----------------------------------
      Total |     10,757      100.00
htir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT6 |     14,287      100.00      100.00
------------+-----------------------------------
      Total |     14,287      100.00
3
htir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     14,287      100.00      100.00
------------+-----------------------------------
      Total |     14,287      100.00
htir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT6 |     14,287      100.00      100.00
------------+-----------------------------------
      Total |     14,287      100.00
6
htir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     14,287      100.00      100.00
------------+-----------------------------------
      Total |     14,287      100.00
htir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT7 |     15,513      100.00      100.00
------------+-----------------------------------
      Total |     15,513      100.00
3
htir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      3,162       20.38       20.38
       2017 |     12,351       79.62      100.00
------------+-----------------------------------
      Total |     15,513      100.00
htir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        HT7 |     15,513      100.00      100.00
------------+-----------------------------------
      Total |     15,513      100.00
6
htir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      3,162       20.38       20.38
       2017 |     12,351       79.62      100.00
------------+-----------------------------------
      Total |     15,513      100.00
iair23fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA2 |     89,777      100.00      100.00
------------+-----------------------------------
      Total |     89,777      100.00
3
iair23fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |     37,142       41.37       41.37
         93 |     52,635       58.63      100.00
------------+-----------------------------------
      Total |     89,777      100.00
iair23fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA2 |     89,777      100.00      100.00
------------+-----------------------------------
      Total |     89,777      100.00
6
iair23fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |     37,142       41.37       41.37
         93 |     52,635       58.63      100.00
------------+-----------------------------------
      Total |     89,777      100.00
iair42fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA3 |     90,303      100.00      100.00
------------+-----------------------------------
      Total |     90,303      100.00
3
iair42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      1,104        1.22        1.22
         98 |     13,213       14.63       15.85
         99 |     75,986       84.15      100.00
------------+-----------------------------------
      Total |     90,303      100.00
iair42fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA3 |     90,303      100.00      100.00
------------+-----------------------------------
      Total |     90,303      100.00
6
iair42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
  year 2000 |      1,104        1.22        1.22
         98 |     13,213       14.63       15.85
         99 |     75,986       84.15      100.00
------------+-----------------------------------
      Total |     90,303      100.00
iair52fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA5 |    124,385      100.00      100.00
------------+-----------------------------------
      Total |    124,385      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA5 |    124,385      100.00      100.00
------------+-----------------------------------
      Total |    124,385      100.00
3
iair52fl.dta
marriage & unions
       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      7,947        6.39        6.39
       2006 |    116,438       93.61      100.00
------------+-----------------------------------
      Total |    124,385      100.00
iair52fl.dta
Marriage column exists but is empty
(124,385 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA5 |    124,385      100.00      100.00
------------+-----------------------------------
      Total |    124,385      100.00
6
iair52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      7,947        6.39        6.39
       2006 |    116,438       93.61      100.00
------------+-----------------------------------
      Total |    124,385      100.00
iair74fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(699,686 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA6 |    699,686      100.00      100.00
------------+-----------------------------------
      Total |    699,686      100.00
3
iair74fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |    355,584       50.82       50.82
       2016 |    344,102       49.18      100.00
------------+-----------------------------------
      Total |    699,686      100.00
iair74fl.dta
Marriage column exists but is empty
(699,686 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        IA6 |    699,686      100.00      100.00
------------+-----------------------------------
      Total |    699,686      100.00
6
iair74fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |    355,584       50.82       50.82
       2016 |    344,102       49.18      100.00
------------+-----------------------------------
      Total |    699,686      100.00
idir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ID |     11,884      100.00      100.00
------------+-----------------------------------
      Total |     11,884      100.00
3
idir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |     11,884      100.00      100.00
------------+-----------------------------------
      Total |     11,884      100.00
idir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ID |     11,884      100.00      100.00
------------+-----------------------------------
      Total |     11,884      100.00
6
idir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |     11,884      100.00      100.00
------------+-----------------------------------
      Total |     11,884      100.00
idir21fl.dta
Marriage column exists but is empty
(22,909 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID2 |     22,909      100.00      100.00
------------+-----------------------------------
      Total |     22,909      100.00
3
idir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |     22,909      100.00      100.00
------------+-----------------------------------
      Total |     22,909      100.00
idir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID2 |     22,909      100.00      100.00
------------+-----------------------------------
      Total |     22,909      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID2 |     22,909      100.00      100.00
------------+-----------------------------------
      Total |     22,909      100.00
6
idir21fl.dta
marriage & unions
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |     22,909      100.00      100.00
------------+-----------------------------------
      Total |     22,909      100.00
idir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,168      100.00      100.00
------------+-----------------------------------
      Total |     28,168      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,168      100.00      100.00
------------+-----------------------------------
      Total |     28,168      100.00
3
idir31fl.dta
marriage & unions
             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |     28,168      100.00      100.00
------------+-----------------------------------
      Total |     28,168      100.00
idir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,168      100.00      100.00
------------+-----------------------------------
      Total |     28,168      100.00
6
idir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |     28,168      100.00      100.00
------------+-----------------------------------
      Total |     28,168      100.00
idir3afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,810      100.00      100.00
------------+-----------------------------------
      Total |     28,810      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,810      100.00      100.00
------------+-----------------------------------
      Total |     28,810      100.00
3
idir3afl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |     28,810      100.00      100.00
------------+-----------------------------------
      Total |     28,810      100.00
idir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID3 |     28,810      100.00      100.00
------------+-----------------------------------
      Total |     28,810      100.00
6
idir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |     28,810      100.00      100.00
------------+-----------------------------------
      Total |     28,810      100.00
idir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID4 |     29,483      100.00      100.00
------------+-----------------------------------
      Total |     29,483      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID4 |     29,483      100.00      100.00
------------+-----------------------------------
      Total |     29,483      100.00
3
idir42fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     17,052       57.84       57.84
       2003 |     12,431       42.16      100.00
------------+-----------------------------------
      Total |     29,483      100.00
idir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(29,483 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID4 |     29,483      100.00      100.00
------------+-----------------------------------
      Total |     29,483      100.00
6
idir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |     17,052       57.84       57.84
       2003 |     12,431       42.16      100.00
------------+-----------------------------------
      Total |     29,483      100.00
idir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID5 |     32,895      100.00      100.00
------------+-----------------------------------
      Total |     32,895      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID5 |     32,895      100.00      100.00
------------+-----------------------------------
      Total |     32,895      100.00
3
idir51fl.dta
marriage and union
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     32,895      100.00      100.00
------------+-----------------------------------
      Total |     32,895      100.00
idir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(32,895 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID5 |     32,895      100.00      100.00
------------+-----------------------------------
      Total |     32,895      100.00
6
idir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     32,895      100.00      100.00
------------+-----------------------------------
      Total |     32,895      100.00
idir63fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID6 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID6 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00
3
idir63fl.dta
marriage and union
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00
idir63fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID6 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                00000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ID6 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00
6
idir63fl.dta
country specific
               00000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     45,607      100.00      100.00
------------+-----------------------------------
      Total |     45,607      100.00
joir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO2 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00

     +-----------------------+
     |                vcal_3 |
     |-----------------------|
  1. |                     X |
     +-----------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO2 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00
3
joir21fl.dta
postpart. amenorrh
                    X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00
joir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO2 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXX000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO2 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00
6
joir21fl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXX000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      6,461      100.00      100.00
------------+-----------------------------------
      Total |      6,461      100.00
joir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO3 |      5,548      100.00      100.00
------------+-----------------------------------
      Total |      5,548      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO3 |      5,548      100.00      100.00
------------+-----------------------------------
      Total |      5,548      100.00
3
joir31fl.dta
marriage & unions
             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      5,548      100.00      100.00
------------+-----------------------------------
      Total |      5,548      100.00
joir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO3 |      5,548      100.00      100.00
------------+-----------------------------------
      Total |      5,548      100.00
6
joir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      5,548      100.00      100.00
------------+-----------------------------------
      Total |      5,548      100.00
joir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO4 |      6,006      100.00      100.00
------------+-----------------------------------
      Total |      6,006      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO4 |      6,006      100.00      100.00
------------+-----------------------------------
      Total |      6,006      100.00
3
joir42fl.dta
marriage & unions
           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |      6,006      100.00      100.00
------------+-----------------------------------
      Total |      6,006      100.00
joir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,006 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO4 |      6,006      100.00      100.00
------------+-----------------------------------
      Total |      6,006      100.00
6
joir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |      6,006      100.00      100.00
------------+-----------------------------------
      Total |      6,006      100.00
joir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,876 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO5 |     10,876      100.00      100.00
------------+-----------------------------------
      Total |     10,876      100.00
3
joir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,876      100.00      100.00
------------+-----------------------------------
      Total |     10,876      100.00
joir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,876 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO5 |     10,876      100.00      100.00
------------+-----------------------------------
      Total |     10,876      100.00
6
joir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,876      100.00      100.00
------------+-----------------------------------
      Total |     10,876      100.00
joir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,109 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO5 |     10,109      100.00      100.00
------------+-----------------------------------
      Total |     10,109      100.00
3
joir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,109      100.00      100.00
------------+-----------------------------------
      Total |     10,109      100.00
joir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,109 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO5 |     10,109      100.00      100.00
------------+-----------------------------------
      Total |     10,109      100.00
6
joir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     10,109      100.00      100.00
------------+-----------------------------------
      Total |     10,109      100.00
joir6cfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(11,352 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO6 |     11,352      100.00      100.00
------------+-----------------------------------
      Total |     11,352      100.00
3
joir6cfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     11,352      100.00      100.00
------------+-----------------------------------
      Total |     11,352      100.00
joir6cfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,352 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        JO6 |     11,352      100.00      100.00
------------+-----------------------------------
      Total |     11,352      100.00
6
joir6cfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     11,352      100.00      100.00
------------+-----------------------------------
      Total |     11,352      100.00
keir03fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         KE |      7,150      100.00      100.00
------------+-----------------------------------
      Total |      7,150      100.00
3
keir03fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |        485        6.78        6.78
         89 |      6,665       93.22      100.00
------------+-----------------------------------
      Total |      7,150      100.00
keir03fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         KE |      7,150      100.00      100.00
------------+-----------------------------------
      Total |      7,150      100.00
6
keir03fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |        485        6.78        6.78
         89 |      6,665       93.22      100.00
------------+-----------------------------------
      Total |      7,150      100.00
keir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE2 |      7,540      100.00      100.00
------------+-----------------------------------
      Total |      7,540      100.00
3
keir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      7,540      100.00      100.00
------------+-----------------------------------
      Total |      7,540      100.00
keir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE2 |      7,540      100.00      100.00
------------+-----------------------------------
      Total |      7,540      100.00
6
keir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      7,540      100.00      100.00
------------+-----------------------------------
      Total |      7,540      100.00
keir3afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE3 |      7,881      100.00      100.00
------------+-----------------------------------
      Total |      7,881      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE3 |      7,881      100.00      100.00
------------+-----------------------------------
      Total |      7,881      100.00
3
keir3afl.dta
marriage & unions
              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      7,881      100.00      100.00
------------+-----------------------------------
      Total |      7,881      100.00
keir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE3 |      7,881      100.00      100.00
------------+-----------------------------------
      Total |      7,881      100.00
6
keir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      7,881      100.00      100.00
------------+-----------------------------------
      Total |      7,881      100.00
keir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE4 |      8,195      100.00      100.00
------------+-----------------------------------
      Total |      8,195      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE4 |      8,195      100.00      100.00
------------+-----------------------------------
      Total |      8,195      100.00
3
keir42fl.dta
marriage & unions
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      8,195      100.00      100.00
------------+-----------------------------------
      Total |      8,195      100.00
keir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,195 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE4 |      8,195      100.00      100.00
------------+-----------------------------------
      Total |      8,195      100.00
6
keir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      8,195      100.00      100.00
------------+-----------------------------------
      Total |      8,195      100.00
keir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
3
keir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      3,924       46.47       46.47
       2009 |      4,520       53.53      100.00
------------+-----------------------------------
      Total |      8,444      100.00
keir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,444 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE5 |      8,444      100.00      100.00
------------+-----------------------------------
      Total |      8,444      100.00
6
keir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      3,924       46.47       46.47
       2009 |      4,520       53.53      100.00
------------+-----------------------------------
      Total |      8,444      100.00
keir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(31,079 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE6 |     31,079      100.00      100.00
------------+-----------------------------------
      Total |     31,079      100.00
3
keir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     31,079      100.00      100.00
------------+-----------------------------------
      Total |     31,079      100.00
keir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(31,079 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE6 |     31,079      100.00      100.00
------------+-----------------------------------
      Total |     31,079      100.00
6
keir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     31,079      100.00      100.00
------------+-----------------------------------
      Total |     31,079      100.00
keir7hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE6 |      5,394      100.00      100.00
------------+-----------------------------------
      Total |      5,394      100.00
3
keir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      5,394      100.00      100.00
------------+-----------------------------------
      Total |      5,394      100.00
keir7hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KE6 |      5,394      100.00      100.00
------------+-----------------------------------
      Total |      5,394      100.00
6
keir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      5,394      100.00      100.00
------------+-----------------------------------
      Total |      5,394      100.00
khir42fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH4 |     15,351      100.00      100.00
------------+-----------------------------------
      Total |     15,351      100.00
3
khir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,351      100.00      100.00
------------+-----------------------------------
      Total |     15,351      100.00
khir42fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH4 |     15,351      100.00      100.00
------------+-----------------------------------
      Total |     15,351      100.00
6
khir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     15,351      100.00      100.00
------------+-----------------------------------
      Total |     15,351      100.00
khir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,823 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH5 |     16,823      100.00      100.00
------------+-----------------------------------
      Total |     16,823      100.00
3
khir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     10,941       65.04       65.04
       2006 |      5,882       34.96      100.00
------------+-----------------------------------
      Total |     16,823      100.00
khir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,823 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH5 |     16,823      100.00      100.00
------------+-----------------------------------
      Total |     16,823      100.00
6
khir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     10,941       65.04       65.04
       2006 |      5,882       34.96      100.00
------------+-----------------------------------
      Total |     16,823      100.00
khir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(18,754 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH5 |     18,754      100.00      100.00
------------+-----------------------------------
      Total |     18,754      100.00
3
khir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     18,163       96.85       96.85
       2011 |        591        3.15      100.00
------------+-----------------------------------
      Total |     18,754      100.00
khir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(18,754 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH5 |     18,754      100.00      100.00
------------+-----------------------------------
      Total |     18,754      100.00
6
khir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     18,163       96.85       96.85
       2011 |        591        3.15      100.00
------------+-----------------------------------
      Total |     18,754      100.00
khir73fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,578 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH6 |     17,578      100.00      100.00
------------+-----------------------------------
      Total |     17,578      100.00
3
khir73fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,578      100.00      100.00
------------+-----------------------------------
      Total |     17,578      100.00
khir73fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,578 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KH6 |     17,578      100.00      100.00
------------+-----------------------------------
      Total |     17,578      100.00
6
khir73fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |     17,578      100.00      100.00
------------+-----------------------------------
      Total |     17,578      100.00
kkir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KK3 |      3,771      100.00      100.00
------------+-----------------------------------
      Total |      3,771      100.00
3
kkir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      3,771      100.00      100.00
------------+-----------------------------------
      Total |      3,771      100.00
kkir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KK3 |      3,771      100.00      100.00
------------+-----------------------------------
      Total |      3,771      100.00
6
kkir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      3,771      100.00      100.00
------------+-----------------------------------
      Total |      3,771      100.00
kkir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KK3 |      4,800      100.00      100.00
------------+-----------------------------------
      Total |      4,800      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |              0000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KK3 |      4,800      100.00      100.00
------------+-----------------------------------
      Total |      4,800      100.00
3
kkir42fl.dta
marriage & unions
             0000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      4,800      100.00      100.00
------------+-----------------------------------
      Total |      4,800      100.00
kkir42fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KK3 |      4,800      100.00      100.00
------------+-----------------------------------
      Total |      4,800      100.00
6
kkir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      4,800      100.00      100.00
------------+-----------------------------------
      Total |      4,800      100.00
kmir32fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(3,050 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KM3 |      3,050      100.00      100.00
------------+-----------------------------------
      Total |      3,050      100.00
3
kmir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      3,050      100.00      100.00
------------+-----------------------------------
      Total |      3,050      100.00
kmir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KM3 |      3,050      100.00      100.00
------------+-----------------------------------
      Total |      3,050      100.00
6
kmir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      3,050      100.00      100.00
------------+-----------------------------------
      Total |      3,050      100.00
kmir61fl.dta
Marriage column exists but is empty
(5,329 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KM6 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
3
kmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
kmir61fl.dta
Marriage column exists but is empty
(5,329 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KM6 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
6
kmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      5,329      100.00      100.00
------------+-----------------------------------
      Total |      5,329      100.00
kyir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KY3 |      3,848      100.00      100.00
------------+-----------------------------------
      Total |      3,848      100.00
3
kyir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      3,848      100.00      100.00
------------+-----------------------------------
      Total |      3,848      100.00
kyir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KY3 |      3,848      100.00      100.00
------------+-----------------------------------
      Total |      3,848      100.00
6
kyir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      3,848      100.00      100.00
------------+-----------------------------------
      Total |      3,848      100.00
kyir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,208 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KY6 |      8,208      100.00      100.00
------------+-----------------------------------
      Total |      8,208      100.00
3
kyir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      8,208      100.00      100.00
------------+-----------------------------------
      Total |      8,208      100.00
kyir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,208 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        KY6 |      8,208      100.00      100.00
------------+-----------------------------------
      Total |      8,208      100.00
6
kyir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      8,208      100.00      100.00
------------+-----------------------------------
      Total |      8,208      100.00
lbir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         LB |      5,239      100.00      100.00
------------+-----------------------------------
      Total |      5,239      100.00
3
lbir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,239      100.00      100.00
------------+-----------------------------------
      Total |      5,239      100.00
lbir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         LB |      5,239      100.00      100.00
------------+-----------------------------------
      Total |      5,239      100.00
6
lbir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      5,239      100.00      100.00
------------+-----------------------------------
      Total |      5,239      100.00
lbir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB5 |      7,092      100.00      100.00
------------+-----------------------------------
      Total |      7,092      100.00
3
lbir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |        515        7.26        7.26
       2007 |      6,577       92.74      100.00
------------+-----------------------------------
      Total |      7,092      100.00
lbir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB5 |      7,092      100.00      100.00
------------+-----------------------------------
      Total |      7,092      100.00
6
lbir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |        515        7.26        7.26
       2007 |      6,577       92.74      100.00
------------+-----------------------------------
      Total |      7,092      100.00
lbir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB5 |      4,397      100.00      100.00
------------+-----------------------------------
      Total |      4,397      100.00
3
lbir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |        902       20.51       20.51
       2009 |      3,495       79.49      100.00
------------+-----------------------------------
      Total |      4,397      100.00
lbir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB5 |      4,397      100.00      100.00
------------+-----------------------------------
      Total |      4,397      100.00
6
lbir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |        902       20.51       20.51
       2009 |      3,495       79.49      100.00
------------+-----------------------------------
      Total |      4,397      100.00
lbir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB6 |      3,939      100.00      100.00
------------+-----------------------------------
      Total |      3,939      100.00
3
lbir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      3,939      100.00      100.00
------------+-----------------------------------
      Total |      3,939      100.00
lbir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB6 |      3,939      100.00      100.00
------------+-----------------------------------
      Total |      3,939      100.00
6
lbir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      3,939      100.00      100.00
------------+-----------------------------------
      Total |      3,939      100.00
lbir6afl.dta
Marriage column exists but is empty
(9,239 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB6 |      9,239      100.00      100.00
------------+-----------------------------------
      Total |      9,239      100.00
3
lbir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,239      100.00      100.00
------------+-----------------------------------
      Total |      9,239      100.00
lbir6afl.dta
Marriage column exists but is empty
(9,239 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB6 |      9,239      100.00      100.00
------------+-----------------------------------
      Total |      9,239      100.00
6
lbir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,239      100.00      100.00
------------+-----------------------------------
      Total |      9,239      100.00
lbir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB7 |      4,290      100.00      100.00
------------+-----------------------------------
      Total |      4,290      100.00
3
lbir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      4,290      100.00      100.00
------------+-----------------------------------
      Total |      4,290      100.00
lbir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LB7 |      4,290      100.00      100.00
------------+-----------------------------------
      Total |      4,290      100.00
6
lbir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      4,290      100.00      100.00
------------+-----------------------------------
      Total |      4,290      100.00
lkir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         LK |      5,865      100.00      100.00
------------+-----------------------------------
      Total |      5,865      100.00
3
lkir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,865      100.00      100.00
------------+-----------------------------------
      Total |      5,865      100.00
lkir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         LK |      5,865      100.00      100.00
------------+-----------------------------------
      Total |      5,865      100.00
6
lkir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,865      100.00      100.00
------------+-----------------------------------
      Total |      5,865      100.00
lsir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,095 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS4 |      7,095      100.00      100.00
------------+-----------------------------------
      Total |      7,095      100.00
3
lsir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      6,524       91.95       91.95
       2005 |        571        8.05      100.00
------------+-----------------------------------
      Total |      7,095      100.00
lsir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,095 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS4 |      7,095      100.00      100.00
------------+-----------------------------------
      Total |      7,095      100.00
6
lsir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      6,524       91.95       91.95
       2005 |        571        8.05      100.00
------------+-----------------------------------
      Total |      7,095      100.00
lsir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,624 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS5 |      7,624      100.00      100.00
------------+-----------------------------------
      Total |      7,624      100.00
3
lsir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      6,498       85.23       85.23
       2010 |      1,126       14.77      100.00
------------+-----------------------------------
      Total |      7,624      100.00
lsir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,624 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS5 |      7,624      100.00      100.00
------------+-----------------------------------
      Total |      7,624      100.00
6
lsir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      6,498       85.23       85.23
       2010 |      1,126       14.77      100.00
------------+-----------------------------------
      Total |      7,624      100.00
lsir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,621 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS6 |      6,621      100.00      100.00
------------+-----------------------------------
      Total |      6,621      100.00
3
lsir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      6,621      100.00      100.00
------------+-----------------------------------
      Total |      6,621      100.00
lsir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,621 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        LS6 |      6,621      100.00      100.00
------------+-----------------------------------
      Total |      6,621      100.00
6
lsir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      6,621      100.00      100.00
------------+-----------------------------------
      Total |      6,621      100.00
mair01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         MA |      5,982      100.00      100.00
------------+-----------------------------------
      Total |      5,982      100.00
3
mair01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,982      100.00      100.00
------------+-----------------------------------
      Total |      5,982      100.00
mair01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         MA |      5,982      100.00      100.00
------------+-----------------------------------
      Total |      5,982      100.00
6
mair01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      5,982      100.00      100.00
------------+-----------------------------------
      Total |      5,982      100.00
mair21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA2 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00

     +---------------------------------------------------------------------+
     |                                                              vcal_3 |
     |---------------------------------------------------------------------|
  1. |                               X                                   X |
     +---------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA2 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00
3
mair21fl.dta
postpart. amenorrh
                              X                                   X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00
mair21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA2 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |      XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA2 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00
6
mair21fl.dta
marriages & unions
     XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      9,256      100.00      100.00
------------+-----------------------------------
      Total |      9,256      100.00
mair43fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,798 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA4 |     16,798      100.00      100.00
------------+-----------------------------------
      Total |     16,798      100.00
3
mair43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,071       71.86       71.86
       2004 |      4,727       28.14      100.00
------------+-----------------------------------
      Total |     16,798      100.00
mair43fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,798 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MA4 |     16,798      100.00      100.00
------------+-----------------------------------
      Total |     16,798      100.00
6
mair43fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,071       71.86       71.86
       2004 |      4,727       28.14      100.00
------------+-----------------------------------
      Total |     16,798      100.00
mbir53fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MB4 |      7,440      100.00      100.00
------------+-----------------------------------
      Total |      7,440      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MB4 |      7,440      100.00      100.00
------------+-----------------------------------
      Total |      7,440      100.00
3
mbir53fl.dta
marriage & unions
             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,440      100.00      100.00
------------+-----------------------------------
      Total |      7,440      100.00
mbir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,440 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MB4 |      7,440      100.00      100.00
------------+-----------------------------------
      Total |      7,440      100.00
6
mbir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      7,440      100.00      100.00
------------+-----------------------------------
      Total |      7,440      100.00
mdir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD2 |      6,260      100.00      100.00
------------+-----------------------------------
      Total |      6,260      100.00
3
mdir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,260      100.00      100.00
------------+-----------------------------------
      Total |      6,260      100.00
mdir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD2 |      6,260      100.00      100.00
------------+-----------------------------------
      Total |      6,260      100.00
6
mdir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,260      100.00      100.00
------------+-----------------------------------
      Total |      6,260      100.00
mdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD3 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
3
mdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
mdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD3 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
6
mdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
mdir42fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,949 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD4 |      7,949      100.00      100.00
------------+-----------------------------------
      Total |      7,949      100.00
3
mdir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      2,273       28.59       28.59
       2004 |      5,676       71.41      100.00
------------+-----------------------------------
      Total |      7,949      100.00
mdir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,949 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD4 |      7,949      100.00      100.00
------------+-----------------------------------
      Total |      7,949      100.00
6
mdir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      2,273       28.59       28.59
       2004 |      5,676       71.41      100.00
------------+-----------------------------------
      Total |      7,949      100.00
mdir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,375 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD5 |     17,375      100.00      100.00
------------+-----------------------------------
      Total |     17,375      100.00
3
mdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      4,128       23.76       23.76
       2009 |     13,247       76.24      100.00
------------+-----------------------------------
      Total |     17,375      100.00
mdir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,375 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD5 |     17,375      100.00      100.00
------------+-----------------------------------
      Total |     17,375      100.00
6
mdir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      4,128       23.76       23.76
       2009 |     13,247       76.24      100.00
------------+-----------------------------------
      Total |     17,375      100.00
mdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD6 |      8,169      100.00      100.00
------------+-----------------------------------
      Total |      8,169      100.00
3
mdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,169      100.00      100.00
------------+-----------------------------------
      Total |      8,169      100.00
mdir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD6 |      8,169      100.00      100.00
------------+-----------------------------------
      Total |      8,169      100.00
6
mdir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,169      100.00      100.00
------------+-----------------------------------
      Total |      8,169      100.00
mdir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD6 |      8,045      100.00      100.00
------------+-----------------------------------
      Total |      8,045      100.00
3
mdir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      8,045      100.00      100.00
------------+-----------------------------------
      Total |      8,045      100.00
mdir6hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD6 |      8,045      100.00      100.00
------------+-----------------------------------
      Total |      8,045      100.00
6
mdir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      8,045      100.00      100.00
------------+-----------------------------------
      Total |      8,045      100.00
mdir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD7 |     10,655      100.00      100.00
------------+-----------------------------------
      Total |     10,655      100.00
3
mdir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,655      100.00      100.00
------------+-----------------------------------
      Total |     10,655      100.00
mdir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MD7 |     10,655      100.00      100.00
------------+-----------------------------------
      Total |     10,655      100.00
6
mdir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     10,655      100.00      100.00
------------+-----------------------------------
      Total |     10,655      100.00
mlir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ML |      3,200      100.00      100.00
------------+-----------------------------------
      Total |      3,200      100.00
3
mlir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,200      100.00      100.00
------------+-----------------------------------
      Total |      3,200      100.00
mlir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ML |      3,200      100.00      100.00
------------+-----------------------------------
      Total |      3,200      100.00
6
mlir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,200      100.00      100.00
------------+-----------------------------------
      Total |      3,200      100.00
mlir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML3 |      9,704      100.00      100.00
------------+-----------------------------------
      Total |      9,704      100.00
3
mlir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      3,234       33.33       33.33
         96 |      6,470       66.67      100.00
------------+-----------------------------------
      Total |      9,704      100.00
mlir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML3 |      9,704      100.00      100.00
------------+-----------------------------------
      Total |      9,704      100.00
6
mlir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      3,234       33.33       33.33
         96 |      6,470       66.67      100.00
------------+-----------------------------------
      Total |      9,704      100.00
mlir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,849 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML4 |     12,849      100.00      100.00
------------+-----------------------------------
      Total |     12,849      100.00
3
mlir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |     12,849      100.00      100.00
------------+-----------------------------------
      Total |     12,849      100.00
mlir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,849 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML4 |     12,849      100.00      100.00
------------+-----------------------------------
      Total |     12,849      100.00
6
mlir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |     12,849      100.00      100.00
------------+-----------------------------------
      Total |     12,849      100.00
mlir53fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(14,583 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML5 |     14,583      100.00      100.00
------------+-----------------------------------
      Total |     14,583      100.00
3
mlir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     14,583      100.00      100.00
------------+-----------------------------------
      Total |     14,583      100.00
mlir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,583 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML5 |     14,583      100.00      100.00
------------+-----------------------------------
      Total |     14,583      100.00
6
mlir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |     14,583      100.00      100.00
------------+-----------------------------------
      Total |     14,583      100.00
mlir6hfl.dta
Marriage column exists but is empty
(10,424 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML6 |     10,424      100.00      100.00
------------+-----------------------------------
      Total |     10,424      100.00
3
mlir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      6,704       64.31       64.31
       2013 |      3,720       35.69      100.00
------------+-----------------------------------
      Total |     10,424      100.00
mlir6hfl.dta
Marriage column exists but is empty
(10,424 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML6 |     10,424      100.00      100.00
------------+-----------------------------------
      Total |     10,424      100.00
6
mlir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      6,704       64.31       64.31
       2013 |      3,720       35.69      100.00
------------+-----------------------------------
      Total |     10,424      100.00
mlir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML6 |      7,758      100.00      100.00
------------+-----------------------------------
      Total |      7,758      100.00
3
mlir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,758      100.00      100.00
------------+-----------------------------------
      Total |      7,758      100.00
mlir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ML6 |      7,758      100.00      100.00
------------+-----------------------------------
      Total |      7,758      100.00
6
mlir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,758      100.00      100.00
------------+-----------------------------------
      Total |      7,758      100.00
mmir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,885 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MM7 |     12,885      100.00      100.00
------------+-----------------------------------
      Total |     12,885      100.00
3
mmir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      2,606       20.23       20.23
       2016 |     10,279       79.77      100.00
------------+-----------------------------------
      Total |     12,885      100.00
mmir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,885 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MM7 |     12,885      100.00      100.00
------------+-----------------------------------
      Total |     12,885      100.00
6
mmir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      2,606       20.23       20.23
       2016 |     10,279       79.77      100.00
------------+-----------------------------------
      Total |     12,885      100.00
mvir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,131 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MV5 |      7,131      100.00      100.00
------------+-----------------------------------
      Total |      7,131      100.00
3
mvir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      7,131      100.00      100.00
------------+-----------------------------------
      Total |      7,131      100.00
mvir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,131 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MV5 |      7,131      100.00      100.00
------------+-----------------------------------
      Total |      7,131      100.00
6
mvir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      7,131      100.00      100.00
------------+-----------------------------------
      Total |      7,131      100.00
mwir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW2 |      4,849      100.00      100.00
------------+-----------------------------------
      Total |      4,849      100.00
3
mwir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      4,849      100.00      100.00
------------+-----------------------------------
      Total |      4,849      100.00
mwir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW2 |      4,849      100.00      100.00
------------+-----------------------------------
      Total |      4,849      100.00
6
mwir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      4,849      100.00      100.00
------------+-----------------------------------
      Total |      4,849      100.00
mwir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,220 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW4 |     13,220      100.00      100.00
------------+-----------------------------------
      Total |     13,220      100.00
3
mwir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     13,220      100.00      100.00
------------+-----------------------------------
      Total |     13,220      100.00
mwir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW4 |     13,220      100.00      100.00
------------+-----------------------------------
      Total |     13,220      100.00
6
mwir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     13,220      100.00      100.00
------------+-----------------------------------
      Total |     13,220      100.00
mwir4efl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW4 |     11,698      100.00      100.00
------------+-----------------------------------
      Total |     11,698      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW4 |     11,698      100.00      100.00
------------+-----------------------------------
      Total |     11,698      100.00
3
mwir4efl.dta
marriage & unions
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      8,836       75.53       75.53
       2005 |      2,862       24.47      100.00
------------+-----------------------------------
      Total |     11,698      100.00
mwir4efl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,698 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW4 |     11,698      100.00      100.00
------------+-----------------------------------
      Total |     11,698      100.00
6
mwir4efl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      8,836       75.53       75.53
       2005 |      2,862       24.47      100.00
------------+-----------------------------------
      Total |     11,698      100.00
mwir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(23,020 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW5 |     23,020      100.00      100.00
------------+-----------------------------------
      Total |     23,020      100.00
3
mwir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     23,020      100.00      100.00
------------+-----------------------------------
      Total |     23,020      100.00
mwir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(23,020 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW5 |     23,020      100.00      100.00
------------+-----------------------------------
      Total |     23,020      100.00
6
mwir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     23,020      100.00      100.00
------------+-----------------------------------
      Total |     23,020      100.00
mwir6hfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(2,906 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW6 |      2,906      100.00      100.00
------------+-----------------------------------
      Total |      2,906      100.00
3
mwir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      2,906      100.00      100.00
------------+-----------------------------------
      Total |      2,906      100.00
mwir6hfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(2,906 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW6 |      2,906      100.00      100.00
------------+-----------------------------------
      Total |      2,906      100.00
6
mwir6hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      2,906      100.00      100.00
------------+-----------------------------------
      Total |      2,906      100.00
mwir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW6 |      2,897      100.00      100.00
------------+-----------------------------------
      Total |      2,897      100.00
3
mwir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      2,897      100.00      100.00
------------+-----------------------------------
      Total |      2,897      100.00
mwir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW6 |      2,897      100.00      100.00
------------+-----------------------------------
      Total |      2,897      100.00
6
mwir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      2,897      100.00      100.00
------------+-----------------------------------
      Total |      2,897      100.00
mwir7hfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(24,562 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW7 |     24,562      100.00      100.00
------------+-----------------------------------
      Total |     24,562      100.00
3
mwir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     16,606       67.61       67.61
       2016 |      7,956       32.39      100.00
------------+-----------------------------------
      Total |     24,562      100.00
mwir7hfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(24,562 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW7 |     24,562      100.00      100.00
------------+-----------------------------------
      Total |     24,562      100.00
6
mwir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     16,606       67.61       67.61
       2016 |      7,956       32.39      100.00
------------+-----------------------------------
      Total |     24,562      100.00
mwir7ifl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW7 |      3,860      100.00      100.00
------------+-----------------------------------
      Total |      3,860      100.00
3
mwir7ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      3,860      100.00      100.00
------------+-----------------------------------
      Total |      3,860      100.00
mwir7ifl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MW7 |      3,860      100.00      100.00
------------+-----------------------------------
      Total |      3,860      100.00
6
mwir7ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      3,860      100.00      100.00
------------+-----------------------------------
      Total |      3,860      100.00
mxir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         MX |      9,310      100.00      100.00
------------+-----------------------------------
      Total |      9,310      100.00
3
mxir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      9,310      100.00      100.00
------------+-----------------------------------
      Total |      9,310      100.00
mxir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         MX |      9,310      100.00      100.00
------------+-----------------------------------
      Total |      9,310      100.00
6
mxir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      9,310      100.00      100.00
------------+-----------------------------------
      Total |      9,310      100.00
mzir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ3 |      8,779      100.00      100.00
------------+-----------------------------------
      Total |      8,779      100.00
3
mzir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      8,779      100.00      100.00
------------+-----------------------------------
      Total |      8,779      100.00
mzir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ3 |      8,779      100.00      100.00
------------+-----------------------------------
      Total |      8,779      100.00
6
mzir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      8,779      100.00      100.00
------------+-----------------------------------
      Total |      8,779      100.00
mzir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,418 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ4 |     12,418      100.00      100.00
------------+-----------------------------------
      Total |     12,418      100.00
3
mzir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,300       99.05       99.05
       2004 |        118        0.95      100.00
------------+-----------------------------------
      Total |     12,418      100.00
mzir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,418 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ4 |     12,418      100.00      100.00
------------+-----------------------------------
      Total |     12,418      100.00
6
mzir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     12,300       99.05       99.05
       2004 |        118        0.95      100.00
------------+-----------------------------------
      Total |     12,418      100.00
mzir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ5 |     11,212      100.00      100.00
------------+-----------------------------------
      Total |     11,212      100.00
3
mzir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     11,212      100.00      100.00
------------+-----------------------------------
      Total |     11,212      100.00
mzir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ5 |     11,212      100.00      100.00
------------+-----------------------------------
      Total |     11,212      100.00
6
mzir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     11,212      100.00      100.00
------------+-----------------------------------
      Total |     11,212      100.00
mzir62fl.dta
Marriage column exists but is empty
(13,745 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ6 |     13,745      100.00      100.00
------------+-----------------------------------
      Total |     13,745      100.00
3
mzir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     13,745      100.00      100.00
------------+-----------------------------------
      Total |     13,745      100.00
mzir62fl.dta
Marriage column exists but is empty
(13,745 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ6 |     13,745      100.00      100.00
------------+-----------------------------------
      Total |     13,745      100.00
6
mzir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     13,745      100.00      100.00
------------+-----------------------------------
      Total |     13,745      100.00
mzir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,749 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ6 |      7,749      100.00      100.00
------------+-----------------------------------
      Total |      7,749      100.00
3
mzir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,749      100.00      100.00
------------+-----------------------------------
      Total |      7,749      100.00
mzir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,749 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        MZ6 |      7,749      100.00      100.00
------------+-----------------------------------
      Total |      7,749      100.00
6
mzir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      7,749      100.00      100.00
------------+-----------------------------------
      Total |      7,749      100.00
ncir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NC3 |     13,634      100.00      100.00
------------+-----------------------------------
      Total |     13,634      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                   XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NC3 |     13,634      100.00      100.00
------------+-----------------------------------
      Total |     13,634      100.00
3
ncir31fl.dta
marriage & unions
                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      3,173       23.27       23.27
         98 |     10,461       76.73      100.00
------------+-----------------------------------
      Total |     13,634      100.00
ncir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NC3 |     13,634      100.00      100.00
------------+-----------------------------------
      Total |     13,634      100.00
6
ncir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      3,173       23.27       23.27
         98 |     10,461       76.73      100.00
------------+-----------------------------------
      Total |     13,634      100.00
ncir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,060 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NC4 |     13,060      100.00      100.00
------------+-----------------------------------
      Total |     13,060      100.00
3
ncir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |     13,060      100.00      100.00
------------+-----------------------------------
      Total |     13,060      100.00
ncir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,060 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NC4 |     13,060      100.00      100.00
------------+-----------------------------------
      Total |     13,060      100.00
6
ncir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |     13,060      100.00      100.00
------------+-----------------------------------
      Total |     13,060      100.00
ngir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG2 |      8,781      100.00      100.00
------------+-----------------------------------
      Total |      8,781      100.00
3
ngir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,781      100.00      100.00
------------+-----------------------------------
      Total |      8,781      100.00
ngir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG2 |      8,781      100.00      100.00
------------+-----------------------------------
      Total |      8,781      100.00
6
ngir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      8,781      100.00      100.00
------------+-----------------------------------
      Total |      8,781      100.00
ngir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG3 |      9,810      100.00      100.00
------------+-----------------------------------
      Total |      9,810      100.00
3
ngir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      9,810      100.00      100.00
------------+-----------------------------------
      Total |      9,810      100.00
ngir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG3 |      9,810      100.00      100.00
------------+-----------------------------------
      Total |      9,810      100.00
6
ngir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      9,810      100.00      100.00
------------+-----------------------------------
      Total |      9,810      100.00
ngir4bfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG4 |      7,620      100.00      100.00
------------+-----------------------------------
      Total |      7,620      100.00
3
ngir4bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      7,620      100.00      100.00
------------+-----------------------------------
      Total |      7,620      100.00
ngir4bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG4 |      7,620      100.00      100.00
------------+-----------------------------------
      Total |      7,620      100.00
6
ngir4bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      7,620      100.00      100.00
------------+-----------------------------------
      Total |      7,620      100.00
ngir53fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(33,385 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG5 |     33,385      100.00      100.00
------------+-----------------------------------
      Total |     33,385      100.00
3
ngir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     33,385      100.00      100.00
------------+-----------------------------------
      Total |     33,385      100.00
ngir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(33,385 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG5 |     33,385      100.00      100.00
------------+-----------------------------------
      Total |     33,385      100.00
6
ngir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     33,385      100.00      100.00
------------+-----------------------------------
      Total |     33,385      100.00
ngir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |      6,344      100.00      100.00
------------+-----------------------------------
      Total |      6,344      100.00
3
ngir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      6,344      100.00      100.00
------------+-----------------------------------
      Total |      6,344      100.00
ngir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |      6,344      100.00      100.00
------------+-----------------------------------
      Total |      6,344      100.00
6
ngir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      6,344      100.00      100.00
------------+-----------------------------------
      Total |      6,344      100.00
ngir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |     38,948      100.00      100.00
------------+-----------------------------------
      Total |     38,948      100.00
3
ngir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     38,948      100.00      100.00
------------+-----------------------------------
      Total |     38,948      100.00
ngir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |     38,948      100.00      100.00
------------+-----------------------------------
      Total |     38,948      100.00
6
ngir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     38,948      100.00      100.00
------------+-----------------------------------
      Total |     38,948      100.00
ngir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |      8,034      100.00      100.00
------------+-----------------------------------
      Total |      8,034      100.00
3
ngir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,034      100.00      100.00
------------+-----------------------------------
      Total |      8,034      100.00
ngir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NG6 |      8,034      100.00      100.00
------------+-----------------------------------
      Total |      8,034      100.00
6
ngir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,034      100.00      100.00
------------+-----------------------------------
      Total |      8,034      100.00
niir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI2 |      6,503      100.00      100.00
------------+-----------------------------------
      Total |      6,503      100.00
3
niir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,503      100.00      100.00
------------+-----------------------------------
      Total |      6,503      100.00
niir22fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI2 |      6,503      100.00      100.00
------------+-----------------------------------
      Total |      6,503      100.00
6
niir22fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,503      100.00      100.00
------------+-----------------------------------
      Total |      6,503      100.00
niir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI3 |      7,577      100.00      100.00
------------+-----------------------------------
      Total |      7,577      100.00
3
niir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      7,577      100.00      100.00
------------+-----------------------------------
      Total |      7,577      100.00
niir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI3 |      7,577      100.00      100.00
------------+-----------------------------------
      Total |      7,577      100.00
6
niir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      7,577      100.00      100.00
------------+-----------------------------------
      Total |      7,577      100.00
niir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,223 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI5 |      9,223      100.00      100.00
------------+-----------------------------------
      Total |      9,223      100.00
3
niir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      9,223      100.00      100.00
------------+-----------------------------------
      Total |      9,223      100.00
niir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,223 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI5 |      9,223      100.00      100.00
------------+-----------------------------------
      Total |      9,223      100.00
6
niir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      9,223      100.00      100.00
------------+-----------------------------------
      Total |      9,223      100.00
niir61fl.dta
Marriage column exists but is empty
(11,160 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI6 |     11,160      100.00      100.00
------------+-----------------------------------
      Total |     11,160      100.00
3
niir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     11,160      100.00      100.00
------------+-----------------------------------
      Total |     11,160      100.00
niir61fl.dta
Marriage column exists but is empty
(11,160 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NI6 |     11,160      100.00      100.00
------------+-----------------------------------
      Total |     11,160      100.00
6
niir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     11,160      100.00      100.00
------------+-----------------------------------
      Total |     11,160      100.00
nmir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM2 |      5,421      100.00      100.00
------------+-----------------------------------
      Total |      5,421      100.00
3
nmir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      5,421      100.00      100.00
------------+-----------------------------------
      Total |      5,421      100.00
nmir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM2 |      5,421      100.00      100.00
------------+-----------------------------------
      Total |      5,421      100.00
6
nmir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      5,421      100.00      100.00
------------+-----------------------------------
      Total |      5,421      100.00
nmir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM4 |      6,755      100.00      100.00
------------+-----------------------------------
      Total |      6,755      100.00
3
nmir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      6,755      100.00      100.00
------------+-----------------------------------
      Total |      6,755      100.00
nmir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM4 |      6,755      100.00      100.00
------------+-----------------------------------
      Total |      6,755      100.00
6
nmir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      6,755      100.00      100.00
------------+-----------------------------------
      Total |      6,755      100.00
nmir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,804 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM5 |      9,804      100.00      100.00
------------+-----------------------------------
      Total |      9,804      100.00
3
nmir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      2,742       27.97       27.97
       2007 |      7,062       72.03      100.00
------------+-----------------------------------
      Total |      9,804      100.00
nmir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,804 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM5 |      9,804      100.00      100.00
------------+-----------------------------------
      Total |      9,804      100.00
6
nmir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      2,742       27.97       27.97
       2007 |      7,062       72.03      100.00
------------+-----------------------------------
      Total |      9,804      100.00
nmir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,018 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM6 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
3
nmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
nmir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,018 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NM6 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
6
nmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
npir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP3 |      8,429      100.00      100.00
------------+-----------------------------------
      Total |      8,429      100.00
3
npir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         52 |      6,260       74.27       74.27
         53 |      2,169       25.73      100.00
------------+-----------------------------------
      Total |      8,429      100.00
npir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP3 |      8,429      100.00      100.00
------------+-----------------------------------
      Total |      8,429      100.00
6
npir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         52 |      6,260       74.27       74.27
         53 |      2,169       25.73      100.00
------------+-----------------------------------
      Total |      8,429      100.00
npir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,726 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP4 |      8,726      100.00      100.00
------------+-----------------------------------
      Total |      8,726      100.00
3
npir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2057 |      4,866       55.76       55.76
       2058 |      3,860       44.24      100.00
------------+-----------------------------------
      Total |      8,726      100.00
npir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,726 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP4 |      8,726      100.00      100.00
------------+-----------------------------------
      Total |      8,726      100.00
6
npir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2057 |      4,866       55.76       55.76
       2058 |      3,860       44.24      100.00
------------+-----------------------------------
      Total |      8,726      100.00
npir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,793 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP5 |     10,793      100.00      100.00
------------+-----------------------------------
      Total |     10,793      100.00
3
npir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2062 |      3,654       33.86       33.86
       2063 |      7,139       66.14      100.00
------------+-----------------------------------
      Total |     10,793      100.00
npir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,793 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP5 |     10,793      100.00      100.00
------------+-----------------------------------
      Total |     10,793      100.00
6
npir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2062 |      3,654       33.86       33.86
       2063 |      7,139       66.14      100.00
------------+-----------------------------------
      Total |     10,793      100.00
npir60fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,674 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP6 |     12,674      100.00      100.00
------------+-----------------------------------
      Total |     12,674      100.00
3
npir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2067 |      7,916       62.46       62.46
       2068 |      4,758       37.54      100.00
------------+-----------------------------------
      Total |     12,674      100.00
npir60fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP6 |     12,674      100.00      100.00
------------+-----------------------------------
      Total |     12,674      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |       LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP6 |     12,674      100.00      100.00
------------+-----------------------------------
      Total |     12,674      100.00
6
npir60fl.dta
same as 1, but abo
      LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2067 |      7,916       62.46       62.46
       2068 |      4,758       37.54      100.00
------------+-----------------------------------
      Total |     12,674      100.00
npir7hfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,862 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP7 |     12,862      100.00      100.00
------------+-----------------------------------
      Total |     12,862      100.00
3
npir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2073 |     12,862      100.00      100.00
------------+-----------------------------------
      Total |     12,862      100.00
npir7hfl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP7 |     12,862      100.00      100.00
------------+-----------------------------------
      Total |     12,862      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 9999999999999999999999999999999999999999999999999999999999999999 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        NP7 |     12,862      100.00      100.00
------------+-----------------------------------
      Total |     12,862      100.00
6
npir7hfl.dta
country specific
                9999999999999999999999999999999999999999999999999999999999999999
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2073 |     12,862      100.00      100.00
------------+-----------------------------------
      Total |     12,862      100.00
osir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         OS |      4,213      100.00      100.00
------------+-----------------------------------
      Total |      4,213      100.00
3
osir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      3,716       88.20       88.20
         87 |        497       11.80      100.00
------------+-----------------------------------
      Total |      4,213      100.00
osir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         OS |      4,213      100.00      100.00
------------+-----------------------------------
      Total |      4,213      100.00
6
osir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      3,716       88.20       88.20
         87 |        497       11.80      100.00
------------+-----------------------------------
      Total |      4,213      100.00
peir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         PE |      4,999      100.00      100.00
------------+-----------------------------------
      Total |      4,999      100.00
3
peir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      4,999      100.00      100.00
------------+-----------------------------------
      Total |      4,999      100.00
peir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         PE |      4,999      100.00      100.00
------------+-----------------------------------
      Total |      4,999      100.00
6
peir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      4,999      100.00      100.00
------------+-----------------------------------
      Total |      4,999      100.00
peir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE2 |     15,882      100.00      100.00
------------+-----------------------------------
      Total |     15,882      100.00

     +----------------------------+
     |                     vcal_3 |
     |----------------------------|
  1. |                     XXXXXX |
     +----------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE2 |     15,882      100.00      100.00
------------+-----------------------------------
      Total |     15,882      100.00
3
peir21fl.dta
postpart. amenorrh
                    XXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      8,750       55.09       55.09
         92 |      7,132       44.91      100.00
------------+-----------------------------------
      Total |     15,882      100.00
peir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE2 |     15,882      100.00      100.00
------------+-----------------------------------
      Total |     15,882      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE2 |     15,882      100.00      100.00
------------+-----------------------------------
      Total |     15,882      100.00
6
peir21fl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      8,750       55.09       55.09
         92 |      7,132       44.91      100.00
------------+-----------------------------------
      Total |     15,882      100.00
peir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE3 |     28,951      100.00      100.00
------------+-----------------------------------
      Total |     28,951      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             00000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE3 |     28,951      100.00      100.00
------------+-----------------------------------
      Total |     28,951      100.00
3
peir31fl.dta
marriage & unions
            00000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     28,951      100.00      100.00
------------+-----------------------------------
      Total |     28,951      100.00
peir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE3 |     28,951      100.00      100.00
------------+-----------------------------------
      Total |     28,951      100.00
6
peir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |     28,951      100.00      100.00
------------+-----------------------------------
      Total |     28,951      100.00
peir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE4 |     27,843      100.00      100.00
------------+-----------------------------------
      Total |     27,843      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |              XXXXXXXXXXXXXXX0000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE4 |     27,843      100.00      100.00
------------+-----------------------------------
      Total |     27,843      100.00
3
peir41fl.dta
marriage & unions
             XXXXXXXXXXXXXXX0000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     27,843      100.00      100.00
------------+-----------------------------------
      Total |     27,843      100.00
peir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(27,843 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE4 |     27,843      100.00      100.00
------------+-----------------------------------
      Total |     27,843      100.00
6
peir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     27,843      100.00      100.00
------------+-----------------------------------
      Total |     27,843      100.00
peir51fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE5 |     41,648      100.00      100.00
------------+-----------------------------------
      Total |     41,648      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                   00000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE5 |     41,648      100.00      100.00
------------+-----------------------------------
      Total |     41,648      100.00
3
peir51fl.dta
marriage & unions
                  00000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |        534        1.28        1.28
       2004 |      5,717       13.73       15.01
       2005 |      6,214       14.92       29.93
       2006 |      6,625       15.91       45.84
       2007 |      6,399       15.36       61.20
       2008 |     16,159       38.80      100.00
------------+-----------------------------------
      Total |     41,648      100.00
peir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(41,648 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE5 |     41,648      100.00      100.00
------------+-----------------------------------
      Total |     41,648      100.00
6
peir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |        534        1.28        1.28
       2004 |      5,717       13.73       15.01
       2005 |      6,214       14.92       29.93
       2006 |      6,625       15.91       45.84
       2007 |      6,399       15.36       61.20
       2008 |     16,159       38.80      100.00
------------+-----------------------------------
      Total |     41,648      100.00
peir5ifl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     24,212      100.00      100.00
------------+-----------------------------------
      Total |     24,212      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXX000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     24,212      100.00      100.00
------------+-----------------------------------
      Total |     24,212      100.00
3
peir5ifl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXX000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     24,212      100.00      100.00
------------+-----------------------------------
      Total |     24,212      100.00
peir5ifl.dta
Marriage column exists but is empty
(24,212 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     24,212      100.00      100.00
------------+-----------------------------------
      Total |     24,212      100.00
6
peir5ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     24,212      100.00      100.00
------------+-----------------------------------
      Total |     24,212      100.00
peir61fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,947      100.00      100.00
------------+-----------------------------------
      Total |     22,947      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                 0000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,947      100.00      100.00
------------+-----------------------------------
      Total |     22,947      100.00
3
peir61fl.dta
marriage & unions
                0000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     22,947      100.00      100.00
------------+-----------------------------------
      Total |     22,947      100.00
peir61fl.dta
Marriage column exists but is empty
(22,947 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,947      100.00      100.00
------------+-----------------------------------
      Total |     22,947      100.00
6
peir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |     22,947      100.00      100.00
------------+-----------------------------------
      Total |     22,947      100.00
peir6afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,517      100.00      100.00
------------+-----------------------------------
      Total |     22,517      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             00000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,517      100.00      100.00
------------+-----------------------------------
      Total |     22,517      100.00
3
peir6afl.dta
marriage & unions
            00000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     22,517      100.00      100.00
------------+-----------------------------------
      Total |     22,517      100.00
peir6afl.dta
Marriage column exists but is empty
(22,517 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     22,517      100.00      100.00
------------+-----------------------------------
      Total |     22,517      100.00
6
peir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     22,517      100.00      100.00
------------+-----------------------------------
      Total |     22,517      100.00
peir6ifl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     23,888      100.00      100.00
------------+-----------------------------------
      Total |     23,888      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |         *********XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     23,888      100.00      100.00
------------+-----------------------------------
      Total |     23,888      100.00
3
peir6ifl.dta
marriage & unions
        *********XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     23,888      100.00      100.00
------------+-----------------------------------
      Total |     23,888      100.00
peir6ifl.dta
Marriage column exists but is empty
(23,888 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PE6 |     23,888      100.00      100.00
------------+-----------------------------------
      Total |     23,888      100.00
6
peir6ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     23,888      100.00      100.00
------------+-----------------------------------
      Total |     23,888      100.00
phir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH2 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00

     +---------------------------------------------------------------------------+
     |                                                                    vcal_3 |
     |---------------------------------------------------------------------------|
  1. |                                                                       XXX |
     +---------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH2 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00
3
phir31fl.dta
postpart. amenorrh
                                                                      XXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00
phir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH2 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH2 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00
6
phir31fl.dta
marriage & unions
                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |     15,029      100.00      100.00
------------+-----------------------------------
      Total |     15,029      100.00
phir3bfl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH3 |     13,983      100.00      100.00
------------+-----------------------------------
      Total |     13,983      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |                  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH3 |     13,983      100.00      100.00
------------+-----------------------------------
      Total |     13,983      100.00
3
phir3bfl.dta
marriage & unions
                 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     13,983      100.00      100.00
------------+-----------------------------------
      Total |     13,983      100.00
phir3bfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH3 |     13,983      100.00      100.00
------------+-----------------------------------
      Total |     13,983      100.00
6
phir3bfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     13,983      100.00      100.00
------------+-----------------------------------
      Total |     13,983      100.00
phir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH4 |     13,633      100.00      100.00
------------+-----------------------------------
      Total |     13,633      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             00000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH4 |     13,633      100.00      100.00
------------+-----------------------------------
      Total |     13,633      100.00
3
phir41fl.dta
marriage & unions
            00000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     13,633      100.00      100.00
------------+-----------------------------------
      Total |     13,633      100.00
phir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,633 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH4 |     13,633      100.00      100.00
------------+-----------------------------------
      Total |     13,633      100.00
6
phir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |     13,633      100.00      100.00
------------+-----------------------------------
      Total |     13,633      100.00
phir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH5 |     13,594      100.00      100.00
------------+-----------------------------------
      Total |     13,594      100.00
3
phir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     13,594      100.00      100.00
------------+-----------------------------------
      Total |     13,594      100.00
phir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH5 |     13,594      100.00      100.00
------------+-----------------------------------
      Total |     13,594      100.00
6
phir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     13,594      100.00      100.00
------------+-----------------------------------
      Total |     13,594      100.00
phir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH6 |     16,155      100.00      100.00
------------+-----------------------------------
      Total |     16,155      100.00
3
phir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     16,155      100.00      100.00
------------+-----------------------------------
      Total |     16,155      100.00
phir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH6 |     16,155      100.00      100.00
------------+-----------------------------------
      Total |     16,155      100.00
6
phir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     16,155      100.00      100.00
------------+-----------------------------------
      Total |     16,155      100.00
phir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH7 |     25,074      100.00      100.00
------------+-----------------------------------
      Total |     25,074      100.00
3
phir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     25,074      100.00      100.00
------------+-----------------------------------
      Total |     25,074      100.00
phir70fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PH7 |     25,074      100.00      100.00
------------+-----------------------------------
      Total |     25,074      100.00
6
phir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     25,074      100.00      100.00
------------+-----------------------------------
      Total |     25,074      100.00
pkir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK2 |      6,611      100.00      100.00
------------+-----------------------------------
      Total |      6,611      100.00
3
pkir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      1,212       18.33       18.33
         91 |      5,399       81.67      100.00
------------+-----------------------------------
      Total |      6,611      100.00
pkir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK2 |      6,611      100.00      100.00
------------+-----------------------------------
      Total |      6,611      100.00
6
pkir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      1,212       18.33       18.33
         91 |      5,399       81.67      100.00
------------+-----------------------------------
      Total |      6,611      100.00
pkir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK5 |     10,023      100.00      100.00
------------+-----------------------------------
      Total |     10,023      100.00
3
pkir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      7,100       70.84       70.84
       2007 |      2,923       29.16      100.00
------------+-----------------------------------
      Total |     10,023      100.00
pkir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK5 |     10,023      100.00      100.00
------------+-----------------------------------
      Total |     10,023      100.00
6
pkir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      7,100       70.84       70.84
       2007 |      2,923       29.16      100.00
------------+-----------------------------------
      Total |     10,023      100.00
pkir61fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK6 |     13,558      100.00      100.00
------------+-----------------------------------
      Total |     13,558      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          PPPPPPPP000000000000BPPPPPPPP0666BPPPPPPPP0BPPPPPPPP00BPPPPPPPP00000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK6 |     13,558      100.00      100.00
------------+-----------------------------------
      Total |     13,558      100.00
3
pkir61fl.dta
marriage and union
         PPPPPPPP000000000000BPPPPPPPP0666BPPPPPPPP0BPPPPPPPP00BPPPPPPPP00000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,896       72.99       72.99
       2013 |      3,662       27.01      100.00
------------+-----------------------------------
      Total |     13,558      100.00
pkir61fl.dta
Marriage column exists but is empty
(13,558 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PK6 |     13,558      100.00      100.00
------------+-----------------------------------
      Total |     13,558      100.00
6
pkir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,896       72.99       72.99
       2013 |      3,662       27.01      100.00
------------+-----------------------------------
      Total |     13,558      100.00
pyir21fl.dta
Marriage column exists but is empty
(5,827 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PY2 |      5,827      100.00      100.00
------------+-----------------------------------
      Total |      5,827      100.00
3
pyir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      5,827      100.00      100.00
------------+-----------------------------------
      Total |      5,827      100.00
pyir21fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PY2 |      5,827      100.00      100.00
------------+-----------------------------------
      Total |      5,827      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |                XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        PY2 |      5,827      100.00      100.00
------------+-----------------------------------
      Total |      5,827      100.00
6
pyir21fl.dta
marriage & unions
               XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         90 |      5,827      100.00      100.00
------------+-----------------------------------
      Total |      5,827      100.00
rwir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW2 |      6,551      100.00      100.00
------------+-----------------------------------
      Total |      6,551      100.00
3
rwir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,551      100.00      100.00
------------+-----------------------------------
      Total |      6,551      100.00
rwir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW2 |      6,551      100.00      100.00
------------+-----------------------------------
      Total |      6,551      100.00
6
rwir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      6,551      100.00      100.00
------------+-----------------------------------
      Total |      6,551      100.00
rwir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,421 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW4 |     10,421      100.00      100.00
------------+-----------------------------------
      Total |     10,421      100.00
3
rwir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     10,421      100.00      100.00
------------+-----------------------------------
      Total |     10,421      100.00
rwir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,421 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW4 |     10,421      100.00      100.00
------------+-----------------------------------
      Total |     10,421      100.00
6
rwir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |     10,421      100.00      100.00
------------+-----------------------------------
      Total |     10,421      100.00
rwir53fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(11,321 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW4 |     11,321      100.00      100.00
------------+-----------------------------------
      Total |     11,321      100.00
3
rwir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     11,321      100.00      100.00
------------+-----------------------------------
      Total |     11,321      100.00
rwir53fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(11,321 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW4 |     11,321      100.00      100.00
------------+-----------------------------------
      Total |     11,321      100.00
6
rwir53fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     11,321      100.00      100.00
------------+-----------------------------------
      Total |     11,321      100.00
rwir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW5 |      7,313      100.00      100.00
------------+-----------------------------------
      Total |      7,313      100.00
3
rwir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |        615        8.41        8.41
       2008 |      6,698       91.59      100.00
------------+-----------------------------------
      Total |      7,313      100.00
rwir5afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW5 |      7,313      100.00      100.00
------------+-----------------------------------
      Total |      7,313      100.00
6
rwir5afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |        615        8.41        8.41
       2008 |      6,698       91.59      100.00
------------+-----------------------------------
      Total |      7,313      100.00
rwir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,671 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |     13,671      100.00      100.00
------------+-----------------------------------
      Total |     13,671      100.00
3
rwir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      7,364       53.87       53.87
       2011 |      6,307       46.13      100.00
------------+-----------------------------------
      Total |     13,671      100.00
rwir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,671 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |     13,671      100.00      100.00
------------+-----------------------------------
      Total |     13,671      100.00
6
rwir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      7,364       53.87       53.87
       2011 |      6,307       46.13      100.00
------------+-----------------------------------
      Total |     13,671      100.00
rwir6qfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |      5,135      100.00      100.00
------------+-----------------------------------
      Total |      5,135      100.00
3
rwir6qfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      5,135      100.00      100.00
------------+-----------------------------------
      Total |      5,135      100.00
rwir6qfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |      5,135      100.00      100.00
------------+-----------------------------------
      Total |      5,135      100.00
6
rwir6qfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      5,135      100.00      100.00
------------+-----------------------------------
      Total |      5,135      100.00
rwir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,497 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |     13,497      100.00      100.00
------------+-----------------------------------
      Total |     13,497      100.00
3
rwir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      4,893       36.25       36.25
       2015 |      8,604       63.75      100.00
------------+-----------------------------------
      Total |     13,497      100.00
rwir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,497 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW6 |     13,497      100.00      100.00
------------+-----------------------------------
      Total |     13,497      100.00
6
rwir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      4,893       36.25       36.25
       2015 |      8,604       63.75      100.00
------------+-----------------------------------
      Total |     13,497      100.00
rwir7afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW7 |      5,022      100.00      100.00
------------+-----------------------------------
      Total |      5,022      100.00
3
rwir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      5,022      100.00      100.00
------------+-----------------------------------
      Total |      5,022      100.00
rwir7afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        RW7 |      5,022      100.00      100.00
------------+-----------------------------------
      Total |      5,022      100.00
6
rwir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      5,022      100.00      100.00
------------+-----------------------------------
      Total |      5,022      100.00
sdir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         SD |      5,860      100.00      100.00
------------+-----------------------------------
      Total |      5,860      100.00
3
sdir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      1,693       28.89       28.89
         90 |      4,167       71.11      100.00
------------+-----------------------------------
      Total |      5,860      100.00
sdir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         SD |      5,860      100.00      100.00
------------+-----------------------------------
      Total |      5,860      100.00
6
sdir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         89 |      1,693       28.89       28.89
         90 |      4,167       71.11      100.00
------------+-----------------------------------
      Total |      5,860      100.00
slir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,374 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL5 |      7,374      100.00      100.00
------------+-----------------------------------
      Total |      7,374      100.00
3
slir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      7,374      100.00      100.00
------------+-----------------------------------
      Total |      7,374      100.00
slir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,374 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL5 |      7,374      100.00      100.00
------------+-----------------------------------
      Total |      7,374      100.00
6
slir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      7,374      100.00      100.00
------------+-----------------------------------
      Total |      7,374      100.00
slir61fl.dta
Marriage column exists but is empty
(16,658 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL6 |     16,658      100.00      100.00
------------+-----------------------------------
      Total |     16,658      100.00
3
slir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     16,658      100.00      100.00
------------+-----------------------------------
      Total |     16,658      100.00
slir61fl.dta
Marriage column exists but is empty
(16,658 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL6 |     16,658      100.00      100.00
------------+-----------------------------------
      Total |     16,658      100.00
6
slir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     16,658      100.00      100.00
------------+-----------------------------------
      Total |     16,658      100.00
slir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL7 |      8,501      100.00      100.00
------------+-----------------------------------
      Total |      8,501      100.00
3
slir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      8,501      100.00      100.00
------------+-----------------------------------
      Total |      8,501      100.00
slir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SL7 |      8,501      100.00      100.00
------------+-----------------------------------
      Total |      8,501      100.00
6
slir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      8,501      100.00      100.00
------------+-----------------------------------
      Total |      8,501      100.00
snir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

       v000 |      Freq.     Percent        Cum.
------------+-----------------------------------
         SN |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
3
snir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
snir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

       v000 |      Freq.     Percent        Cum.
------------+-----------------------------------
         SN |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
6
snir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         86 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
snir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN2 |      6,310      100.00      100.00
------------+-----------------------------------
      Total |      6,310      100.00
3
snir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,903       30.16       30.16
         93 |      4,407       69.84      100.00
------------+-----------------------------------
      Total |      6,310      100.00
snir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN2 |      6,310      100.00      100.00
------------+-----------------------------------
      Total |      6,310      100.00
6
snir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      1,903       30.16       30.16
         93 |      4,407       69.84      100.00
------------+-----------------------------------
      Total |      6,310      100.00
snir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN2 |      8,593      100.00      100.00
------------+-----------------------------------
      Total |      8,593      100.00
3
snir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      8,593      100.00      100.00
------------+-----------------------------------
      Total |      8,593      100.00
snir32fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN2 |      8,593      100.00      100.00
------------+-----------------------------------
      Total |      8,593      100.00
6
snir32fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      8,593      100.00      100.00
------------+-----------------------------------
      Total |      8,593      100.00
snir4hfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(14,602 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN4 |     14,602      100.00      100.00
------------+-----------------------------------
      Total |     14,602      100.00
3
snir4hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     14,602      100.00      100.00
------------+-----------------------------------
      Total |     14,602      100.00
snir4hfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(14,602 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN4 |     14,602      100.00      100.00
------------+-----------------------------------
      Total |     14,602      100.00
6
snir4hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     14,602      100.00      100.00
------------+-----------------------------------
      Total |     14,602      100.00
snir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN5 |      6,655      100.00      100.00
------------+-----------------------------------
      Total |      6,655      100.00
3
snir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      6,655      100.00      100.00
------------+-----------------------------------
      Total |      6,655      100.00
snir50fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN5 |      6,655      100.00      100.00
------------+-----------------------------------
      Total |      6,655      100.00
6
snir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      6,655      100.00      100.00
------------+-----------------------------------
      Total |      6,655      100.00
snir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN5 |     19,441      100.00      100.00
------------+-----------------------------------
      Total |     19,441      100.00
3
snir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     11,933       61.38       61.38
       2009 |      7,508       38.62      100.00
------------+-----------------------------------
      Total |     19,441      100.00
snir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN5 |     19,441      100.00      100.00
------------+-----------------------------------
      Total |     19,441      100.00
6
snir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |     11,933       61.38       61.38
       2009 |      7,508       38.62      100.00
------------+-----------------------------------
      Total |     19,441      100.00
snir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(15,688 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     15,688      100.00      100.00
------------+-----------------------------------
      Total |     15,688      100.00
3
snir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      6,437       41.03       41.03
       2011 |      9,251       58.97      100.00
------------+-----------------------------------
      Total |     15,688      100.00
snir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(15,688 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     15,688      100.00      100.00
------------+-----------------------------------
      Total |     15,688      100.00
6
snir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      6,437       41.03       41.03
       2011 |      9,251       58.97      100.00
------------+-----------------------------------
      Total |     15,688      100.00
snir6dfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,636 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,636      100.00      100.00
------------+-----------------------------------
      Total |      8,636      100.00
3
snir6dfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      3,248       37.61       37.61
       2013 |      5,388       62.39      100.00
------------+-----------------------------------
      Total |      8,636      100.00
snir6dfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,636 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,636      100.00      100.00
------------+-----------------------------------
      Total |      8,636      100.00
6
snir6dfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      3,248       37.61       37.61
       2013 |      5,388       62.39      100.00
------------+-----------------------------------
      Total |      8,636      100.00
snir6rfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,124 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     17,124      100.00      100.00
------------+-----------------------------------
      Total |     17,124      100.00
3
snir6rfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      3,248       18.97       18.97
       2013 |      5,388       31.46       50.43
       2014 |      8,488       49.57      100.00
------------+-----------------------------------
      Total |     17,124      100.00
snir6rfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,124 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     17,124      100.00      100.00
------------+-----------------------------------
      Total |     17,124      100.00
6
snir6rfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      3,248       18.97       18.97
       2013 |      5,388       31.46       50.43
       2014 |      8,488       49.57      100.00
------------+-----------------------------------
      Total |     17,124      100.00
snir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,488 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,488      100.00      100.00
------------+-----------------------------------
      Total |      8,488      100.00
3
snir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,488      100.00      100.00
------------+-----------------------------------
      Total |      8,488      100.00
snir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,488 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,488      100.00      100.00
------------+-----------------------------------
      Total |      8,488      100.00
6
snir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      8,488      100.00      100.00
------------+-----------------------------------
      Total |      8,488      100.00
snir7hfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,851 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,851      100.00      100.00
------------+-----------------------------------
      Total |      8,851      100.00
3
snir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,851      100.00      100.00
------------+-----------------------------------
      Total |      8,851      100.00
snir7hfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,851 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,851      100.00      100.00
------------+-----------------------------------
      Total |      8,851      100.00
6
snir7hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,851      100.00      100.00
------------+-----------------------------------
      Total |      8,851      100.00
snir7ifl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,865 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,865      100.00      100.00
------------+-----------------------------------
      Total |      8,865      100.00
3
snir7ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      8,865      100.00      100.00
------------+-----------------------------------
      Total |      8,865      100.00
snir7ifl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,865 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |      8,865      100.00      100.00
------------+-----------------------------------
      Total |      8,865      100.00
6
snir7ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |      8,865      100.00      100.00
------------+-----------------------------------
      Total |      8,865      100.00
snir7zfl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,787 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN7 |     16,787      100.00      100.00
------------+-----------------------------------
      Total |     16,787      100.00
3
snir7zfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     16,787      100.00      100.00
------------+-----------------------------------
      Total |     16,787      100.00
snir7zfl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,787 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN7 |     16,787      100.00      100.00
------------+-----------------------------------
      Total |     16,787      100.00
6
snir7zfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     16,787      100.00      100.00
------------+-----------------------------------
      Total |     16,787      100.00
snirg0fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(17,716 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     17,716      100.00      100.00
------------+-----------------------------------
      Total |     17,716      100.00
3
snirg0fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,851       49.96       49.96
       2016 |      8,865       50.04      100.00
------------+-----------------------------------
      Total |     17,716      100.00
snirg0fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(17,716 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SN6 |     17,716      100.00      100.00
------------+-----------------------------------
      Total |     17,716      100.00
6
snirg0fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      8,851       49.96       49.96
       2016 |      8,865       50.04      100.00
------------+-----------------------------------
      Total |     17,716      100.00
stir50fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(2,615 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ST5 |      2,615      100.00      100.00
------------+-----------------------------------
      Total |      2,615      100.00
3
stir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      2,470       94.46       94.46
       2009 |        145        5.54      100.00
------------+-----------------------------------
      Total |      2,615      100.00
stir50fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(2,615 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ST5 |      2,615      100.00      100.00
------------+-----------------------------------
      Total |      2,615      100.00
6
stir50fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2008 |      2,470       94.46       94.46
       2009 |        145        5.54      100.00
------------+-----------------------------------
      Total |      2,615      100.00
szir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(4,987 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SZ5 |      4,987      100.00      100.00
------------+-----------------------------------
      Total |      4,987      100.00
3
szir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      3,813       76.46       76.46
       2007 |      1,174       23.54      100.00
------------+-----------------------------------
      Total |      4,987      100.00
szir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(4,987 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        SZ5 |      4,987      100.00      100.00
------------+-----------------------------------
      Total |      4,987      100.00
6
szir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      3,813       76.46       76.46
       2007 |      1,174       23.54      100.00
------------+-----------------------------------
      Total |      4,987      100.00
tdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD3 |      7,454      100.00      100.00
------------+-----------------------------------
      Total |      7,454      100.00
3
tdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |        871       11.69       11.69
         97 |      6,583       88.31      100.00
------------+-----------------------------------
      Total |      7,454      100.00
tdir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD3 |      7,454      100.00      100.00
------------+-----------------------------------
      Total |      7,454      100.00
6
tdir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |        871       11.69       11.69
         97 |      6,583       88.31      100.00
------------+-----------------------------------
      Total |      7,454      100.00
tdir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,085 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD4 |      6,085      100.00      100.00
------------+-----------------------------------
      Total |      6,085      100.00
3
tdir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      6,085      100.00      100.00
------------+-----------------------------------
      Total |      6,085      100.00
tdir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(6,085 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD4 |      6,085      100.00      100.00
------------+-----------------------------------
      Total |      6,085      100.00
6
tdir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      6,085      100.00      100.00
------------+-----------------------------------
      Total |      6,085      100.00
tdir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD6 |     17,719      100.00      100.00
------------+-----------------------------------
      Total |     17,719      100.00
3
tdir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      5,886       33.22       33.22
       2015 |     11,833       66.78      100.00
------------+-----------------------------------
      Total |     17,719      100.00
tdir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TD6 |     17,719      100.00      100.00
------------+-----------------------------------
      Total |     17,719      100.00
6
tdir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      5,886       33.22       33.22
       2015 |     11,833       66.78      100.00
------------+-----------------------------------
      Total |     17,719      100.00
tgir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TG |      3,360      100.00      100.00
------------+-----------------------------------
      Total |      3,360      100.00
3
tgir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,360      100.00      100.00
------------+-----------------------------------
      Total |      3,360      100.00
tgir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TG |      3,360      100.00      100.00
------------+-----------------------------------
      Total |      3,360      100.00
6
tgir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,360      100.00      100.00
------------+-----------------------------------
      Total |      3,360      100.00
tgir31fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,569 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG3 |      8,569      100.00      100.00
------------+-----------------------------------
      Total |      8,569      100.00
3
tgir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      8,569      100.00      100.00
------------+-----------------------------------
      Total |      8,569      100.00
tgir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG3 |      8,569      100.00      100.00
------------+-----------------------------------
      Total |      8,569      100.00
6
tgir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      8,569      100.00      100.00
------------+-----------------------------------
      Total |      8,569      100.00
tgir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG6 |      9,480      100.00      100.00
------------+-----------------------------------
      Total |      9,480      100.00
3
tgir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      3,717       39.21       39.21
       2014 |      5,763       60.79      100.00
------------+-----------------------------------
      Total |      9,480      100.00
tgir61fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG6 |      9,480      100.00      100.00
------------+-----------------------------------
      Total |      9,480      100.00
6
tgir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      3,717       39.21       39.21
       2014 |      5,763       60.79      100.00
------------+-----------------------------------
      Total |      9,480      100.00
tgir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG7 |      4,674      100.00      100.00
------------+-----------------------------------
      Total |      4,674      100.00
3
tgir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      4,674      100.00      100.00
------------+-----------------------------------
      Total |      4,674      100.00
tgir71fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TG7 |      4,674      100.00      100.00
------------+-----------------------------------
      Total |      4,674      100.00
6
tgir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |      4,674      100.00      100.00
------------+-----------------------------------
      Total |      4,674      100.00
thir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TH |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00
3
thir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00
thir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TH |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00
6
thir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00
tjir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,656 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TJ6 |      9,656      100.00      100.00
------------+-----------------------------------
      Total |      9,656      100.00
3
tjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,656      100.00      100.00
------------+-----------------------------------
      Total |      9,656      100.00
tjir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,656 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TJ6 |      9,656      100.00      100.00
------------+-----------------------------------
      Total |      9,656      100.00
6
tjir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |      9,656      100.00      100.00
------------+-----------------------------------
      Total |      9,656      100.00
tjir70fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(10,718 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TJ7 |     10,718      100.00      100.00
------------+-----------------------------------
      Total |     10,718      100.00
3
tjir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     10,718      100.00      100.00
------------+-----------------------------------
      Total |     10,718      100.00
tjir70fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,718 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TJ7 |     10,718      100.00      100.00
------------+-----------------------------------
      Total |     10,718      100.00
6
tjir70fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     10,718      100.00      100.00
------------+-----------------------------------
      Total |     10,718      100.00
tlir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,137 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TL5 |     13,137      100.00      100.00
------------+-----------------------------------
      Total |     13,137      100.00
3
tlir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     10,881       82.83       82.83
       2010 |      2,256       17.17      100.00
------------+-----------------------------------
      Total |     13,137      100.00
tlir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,137 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TL5 |     13,137      100.00      100.00
------------+-----------------------------------
      Total |     13,137      100.00
6
tlir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |     10,881       82.83       82.83
       2010 |      2,256       17.17      100.00
------------+-----------------------------------
      Total |     13,137      100.00
tlir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(12,607 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TL7 |     12,607      100.00      100.00
------------+-----------------------------------
      Total |     12,607      100.00
3
tlir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     12,607      100.00      100.00
------------+-----------------------------------
      Total |     12,607      100.00
tlir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(12,607 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TL7 |     12,607      100.00      100.00
------------+-----------------------------------
      Total |     12,607      100.00
6
tlir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     12,607      100.00      100.00
------------+-----------------------------------
      Total |     12,607      100.00
tnir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TN |      4,184      100.00      100.00
------------+-----------------------------------
      Total |      4,184      100.00
3
tnir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      4,184      100.00      100.00
------------+-----------------------------------
      Total |      4,184      100.00
tnir02fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TN |      4,184      100.00      100.00
------------+-----------------------------------
      Total |      4,184      100.00
6
tnir02fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      4,184      100.00      100.00
------------+-----------------------------------
      Total |      4,184      100.00
trir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR2 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00

     +---------------------------------------------------------------+
     |                                                        vcal_3 |
     |---------------------------------------------------------------|
  1. |                                                             X |
     +---------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR2 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00
3
trir31fl.dta
postpart. amenorrh
                                                            X
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00
trir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR2 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_6 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR2 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00
6
trir31fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         93 |      6,519      100.00      100.00
------------+-----------------------------------
      Total |      6,519      100.00
trir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR3 |      8,576      100.00      100.00
------------+-----------------------------------
      Total |      8,576      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR3 |      8,576      100.00      100.00
------------+-----------------------------------
      Total |      8,576      100.00
3
trir41fl.dta
marriage & unions
            XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      8,576      100.00      100.00
------------+-----------------------------------
      Total |      8,576      100.00
trir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR3 |      8,576      100.00      100.00
------------+-----------------------------------
      Total |      8,576      100.00
6
trir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |      8,576      100.00      100.00
------------+-----------------------------------
      Total |      8,576      100.00
trir4afl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR4 |      8,075      100.00      100.00
------------+-----------------------------------
      Total |      8,075      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR4 |      8,075      100.00      100.00
------------+-----------------------------------
      Total |      8,075      100.00
3
trir4afl.dta
marriage & unions
       XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      3,041       37.66       37.66
       2004 |      5,034       62.34      100.00
------------+-----------------------------------
      Total |      8,075      100.00
trir4afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,075 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TR4 |      8,075      100.00      100.00
------------+-----------------------------------
      Total |      8,075      100.00
6
trir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      3,041       37.66       37.66
       2004 |      5,034       62.34      100.00
------------+-----------------------------------
      Total |      8,075      100.00
ttir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TT |      3,806      100.00      100.00
------------+-----------------------------------
      Total |      3,806      100.00
3
ttir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,806      100.00      100.00
------------+-----------------------------------
      Total |      3,806      100.00
ttir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         TT |      3,806      100.00      100.00
------------+-----------------------------------
      Total |      3,806      100.00
6
ttir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         87 |      3,806      100.00      100.00
------------+-----------------------------------
      Total |      3,806      100.00
tzir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ2 |      9,238      100.00      100.00
------------+-----------------------------------
      Total |      9,238      100.00
3
tzir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,160       55.86       55.86
         92 |      4,078       44.14      100.00
------------+-----------------------------------
      Total |      9,238      100.00
tzir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ2 |      9,238      100.00      100.00
------------+-----------------------------------
      Total |      9,238      100.00
6
tzir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,160       55.86       55.86
         92 |      4,078       44.14      100.00
------------+-----------------------------------
      Total |      9,238      100.00
tzir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ3 |      8,120      100.00      100.00
------------+-----------------------------------
      Total |      8,120      100.00
3
tzir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,120      100.00      100.00
------------+-----------------------------------
      Total |      8,120      100.00
tzir3afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ3 |      8,120      100.00      100.00
------------+-----------------------------------
      Total |      8,120      100.00
6
tzir3afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      8,120      100.00      100.00
------------+-----------------------------------
      Total |      8,120      100.00
tzir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ3 |      4,029      100.00      100.00
------------+-----------------------------------
      Total |      4,029      100.00
3
tzir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      4,029      100.00      100.00
------------+-----------------------------------
      Total |      4,029      100.00
tzir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ3 |      4,029      100.00      100.00
------------+-----------------------------------
      Total |      4,029      100.00
6
tzir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         99 |      4,029      100.00      100.00
------------+-----------------------------------
      Total |      4,029      100.00
tzir4afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     12,522      100.00      100.00
------------+-----------------------------------
      Total |     12,522      100.00
3
tzir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      3,240       25.87       25.87
       2004 |      9,282       74.13      100.00
------------+-----------------------------------
      Total |     12,522      100.00
tzir4afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     12,522      100.00      100.00
------------+-----------------------------------
      Total |     12,522      100.00
6
tzir4afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2003 |      3,240       25.87       25.87
       2004 |      9,282       74.13      100.00
------------+-----------------------------------
      Total |     12,522      100.00
tzir4ifl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ4 |     10,329      100.00      100.00
------------+-----------------------------------
      Total |     10,329      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           0000000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ4 |     10,329      100.00      100.00
------------+-----------------------------------
      Total |     10,329      100.00
3
tzir4ifl.dta
marriage & unions
          0000000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      7,079       68.54       68.54
       2005 |      3,250       31.46      100.00
------------+-----------------------------------
      Total |     10,329      100.00
tzir4ifl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(10,329 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ4 |     10,329      100.00      100.00
------------+-----------------------------------
      Total |     10,329      100.00
6
tzir4ifl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2004 |      7,079       68.54       68.54
       2005 |      3,250       31.46      100.00
------------+-----------------------------------
      Total |     10,329      100.00
tzir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     16,318      100.00      100.00
------------+-----------------------------------
      Total |     16,318      100.00
3
tzir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |      9,586       58.74       58.74
       2008 |      6,732       41.26      100.00
------------+-----------------------------------
      Total |     16,318      100.00
tzir51fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     16,318      100.00      100.00
------------+-----------------------------------
      Total |     16,318      100.00
6
tzir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |      9,586       58.74       58.74
       2008 |      6,732       41.26      100.00
------------+-----------------------------------
      Total |     16,318      100.00
tzir63fl.dta
Marriage column exists but is empty
(10,139 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     10,139      100.00      100.00
------------+-----------------------------------
      Total |     10,139      100.00
3
tzir63fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      1,038       10.24       10.24
       2010 |      9,101       89.76      100.00
------------+-----------------------------------
      Total |     10,139      100.00
tzir63fl.dta
Marriage column exists but is empty
(10,139 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ5 |     10,139      100.00      100.00
------------+-----------------------------------
      Total |     10,139      100.00
6
tzir63fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      1,038       10.24       10.24
       2010 |      9,101       89.76      100.00
------------+-----------------------------------
      Total |     10,139      100.00
tzir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ6 |     19,319      100.00      100.00
------------+-----------------------------------
      Total |     19,319      100.00
3
tzir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      2,060       10.66       10.66
       2012 |     17,259       89.34      100.00
------------+-----------------------------------
      Total |     19,319      100.00
tzir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    Country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ6 |     19,319      100.00      100.00
------------+-----------------------------------
      Total |     19,319      100.00
6
tzir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    Year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      2,060       10.66       10.66
       2012 |     17,259       89.34      100.00
------------+-----------------------------------
      Total |     19,319      100.00
tzir7afl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(13,266 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ7 |     13,266      100.00      100.00
------------+-----------------------------------
      Total |     13,266      100.00
3
tzir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     10,206       76.93       76.93
       2016 |      3,060       23.07      100.00
------------+-----------------------------------
      Total |     13,266      100.00
tzir7afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(13,266 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ7 |     13,266      100.00      100.00
------------+-----------------------------------
      Total |     13,266      100.00
6
tzir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |     10,206       76.93       76.93
       2016 |      3,060       23.07      100.00
------------+-----------------------------------
      Total |     13,266      100.00
tzir7qfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ7 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
3
tzir7qfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
tzir7qfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        TZ7 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
6
tzir7qfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2017 |     10,018      100.00      100.00
------------+-----------------------------------
      Total |     10,018      100.00
uair51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(6,841 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UA5 |      6,841      100.00      100.00
------------+-----------------------------------
      Total |      6,841      100.00
3
uair51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,841      100.00      100.00
------------+-----------------------------------
      Total |      6,841      100.00
uair51fl.dta
Marriage column exists but is empty
(6,841 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UA5 |      6,841      100.00      100.00
------------+-----------------------------------
      Total |      6,841      100.00
6
uair51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
            |      6,841      100.00      100.00
------------+-----------------------------------
      Total |      6,841      100.00
ugir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         UG |      4,730      100.00      100.00
------------+-----------------------------------
      Total |      4,730      100.00
3
ugir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,673       77.65       77.65
         89 |      1,057       22.35      100.00
------------+-----------------------------------
      Total |      4,730      100.00
ugir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         UG |      4,730      100.00      100.00
------------+-----------------------------------
      Total |      4,730      100.00
6
ugir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,673       77.65       77.65
         89 |      1,057       22.35      100.00
------------+-----------------------------------
      Total |      4,730      100.00
ugir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG3 |      7,070      100.00      100.00
------------+-----------------------------------
      Total |      7,070      100.00
3
ugir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      7,070      100.00      100.00
------------+-----------------------------------
      Total |      7,070      100.00
ugir33fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG3 |      7,070      100.00      100.00
------------+-----------------------------------
      Total |      7,070      100.00
6
ugir33fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         95 |      7,070      100.00      100.00
------------+-----------------------------------
      Total |      7,070      100.00
ugir41fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,246 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG4 |      7,246      100.00      100.00
------------+-----------------------------------
      Total |      7,246      100.00
3
ugir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      3,601       49.70       49.70
       2001 |      3,645       50.30      100.00
------------+-----------------------------------
      Total |      7,246      100.00
ugir41fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,246 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG4 |      7,246      100.00      100.00
------------+-----------------------------------
      Total |      7,246      100.00
6
ugir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2000 |      3,601       49.70       49.70
       2001 |      3,645       50.30      100.00
------------+-----------------------------------
      Total |      7,246      100.00
ugir52fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,531 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG5 |      8,531      100.00      100.00
------------+-----------------------------------
      Total |      8,531      100.00
3
ugir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      8,531      100.00      100.00
------------+-----------------------------------
      Total |      8,531      100.00
ugir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,531 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG5 |      8,531      100.00      100.00
------------+-----------------------------------
      Total |      8,531      100.00
6
ugir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2006 |      8,531      100.00      100.00
------------+-----------------------------------
      Total |      8,531      100.00
ugir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG5 |      4,134      100.00      100.00
------------+-----------------------------------
      Total |      4,134      100.00
3
ugir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      4,108       99.37       99.37
       2010 |         26        0.63      100.00
------------+-----------------------------------
      Total |      4,134      100.00
ugir5hfl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG5 |      4,134      100.00      100.00
------------+-----------------------------------
      Total |      4,134      100.00
6
ugir5hfl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2009 |      4,108       99.37       99.37
       2010 |         26        0.63      100.00
------------+-----------------------------------
      Total |      4,134      100.00
ugir60fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,674 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |      8,674      100.00      100.00
------------+-----------------------------------
      Total |      8,674      100.00
3
ugir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,674      100.00      100.00
------------+-----------------------------------
      Total |      8,674      100.00
ugir60fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,674 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |      8,674      100.00      100.00
------------+-----------------------------------
      Total |      8,674      100.00
6
ugir60fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |      8,674      100.00      100.00
------------+-----------------------------------
      Total |      8,674      100.00
ugir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |     21,741      100.00      100.00
------------+-----------------------------------
      Total |     21,741      100.00
3
ugir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     21,741      100.00      100.00
------------+-----------------------------------
      Total |     21,741      100.00
ugir6afl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |     21,741      100.00      100.00
------------+-----------------------------------
      Total |     21,741      100.00
6
ugir6afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2011 |     21,741      100.00      100.00
------------+-----------------------------------
      Total |     21,741      100.00
ugir72fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |      5,322      100.00      100.00
------------+-----------------------------------
      Total |      5,322      100.00
3
ugir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      3,406       64.00       64.00
       2015 |      1,916       36.00      100.00
------------+-----------------------------------
      Total |      5,322      100.00
ugir72fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG6 |      5,322      100.00      100.00
------------+-----------------------------------
      Total |      5,322      100.00
6
ugir72fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2014 |      3,406       64.00       64.00
       2015 |      1,916       36.00      100.00
------------+-----------------------------------
      Total |      5,322      100.00
ugir7afl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(18,506 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG7 |     18,506      100.00      100.00
------------+-----------------------------------
      Total |     18,506      100.00
3
ugir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     18,506      100.00      100.00
------------+-----------------------------------
      Total |     18,506      100.00
ugir7afl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(18,506 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UG7 |     18,506      100.00      100.00
------------+-----------------------------------
      Total |     18,506      100.00
6
ugir7afl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2016 |     18,506      100.00      100.00
------------+-----------------------------------
      Total |     18,506      100.00
uzir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UZ3 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
3
uzir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
uzir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        UZ3 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
6
uzir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      4,415      100.00      100.00
------------+-----------------------------------
      Total |      4,415      100.00
vnir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,664      100.00      100.00
------------+-----------------------------------
      Total |      5,664      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |             00000000000000000000000000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,664      100.00      100.00
------------+-----------------------------------
      Total |      5,664      100.00
3
vnir31fl.dta
marriage & unions
            00000000000000000000000000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      5,664      100.00      100.00
------------+-----------------------------------
      Total |      5,664      100.00
vnir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,664      100.00      100.00
------------+-----------------------------------
      Total |      5,664      100.00
6
vnir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         97 |      5,664      100.00      100.00
------------+-----------------------------------
      Total |      5,664      100.00
vnir41fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,665      100.00      100.00
------------+-----------------------------------
      Total |      5,665      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,665      100.00      100.00
------------+-----------------------------------
      Total |      5,665      100.00
3
vnir41fl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |      5,665      100.00      100.00
------------+-----------------------------------
      Total |      5,665      100.00
vnir41fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VNT |      5,665      100.00      100.00
------------+-----------------------------------
      Total |      5,665      100.00
6
vnir41fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2002 |      5,665      100.00      100.00
------------+-----------------------------------
      Total |      5,665      100.00
vnir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VN5 |     13,996      100.00      100.00
------------+-----------------------------------
      Total |     13,996      100.00
3
vnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     13,996      100.00      100.00
------------+-----------------------------------
      Total |     13,996      100.00
vnir52fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        VN5 |     13,996      100.00      100.00
------------+-----------------------------------
      Total |     13,996      100.00
6
vnir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |     13,996      100.00      100.00
------------+-----------------------------------
      Total |     13,996      100.00
yeir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        YE2 |      6,010      100.00      100.00
------------+-----------------------------------
      Total |      6,010      100.00
3
yeir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,812       96.71       96.71
         92 |        198        3.29      100.00
------------+-----------------------------------
      Total |      6,010      100.00
yeir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        YE2 |      6,010      100.00      100.00
------------+-----------------------------------
      Total |      6,010      100.00
6
yeir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         91 |      5,812       96.71       96.71
         92 |        198        3.29      100.00
------------+-----------------------------------
      Total |      6,010      100.00
yeir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(25,434 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        YE6 |     25,434      100.00      100.00
------------+-----------------------------------
      Total |     25,434      100.00
3
yeir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     25,434      100.00      100.00
------------+-----------------------------------
      Total |     25,434      100.00
yeir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(25,434 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        YE6 |     25,434      100.00      100.00
------------+-----------------------------------
      Total |     25,434      100.00
6
yeir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |     25,434      100.00      100.00
------------+-----------------------------------
      Total |     25,434      100.00
zair31fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZA3 |     11,735      100.00      100.00
------------+-----------------------------------
      Total |     11,735      100.00
3
zair31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,735      100.00      100.00
------------+-----------------------------------
      Total |     11,735      100.00
zair31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZA3 |     11,735      100.00      100.00
------------+-----------------------------------
      Total |     11,735      100.00
6
zair31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         98 |     11,735      100.00      100.00
------------+-----------------------------------
      Total |     11,735      100.00
zmir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM2 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
3
zmir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
zmir21fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM2 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
6
zmir21fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         92 |      7,060      100.00      100.00
------------+-----------------------------------
      Total |      7,060      100.00
zmir31fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(8,021 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM3 |      8,021      100.00      100.00
------------+-----------------------------------
      Total |      8,021      100.00
3
zmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      7,970       99.36       99.36
         97 |         51        0.64      100.00
------------+-----------------------------------
      Total |      8,021      100.00
zmir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM3 |      8,021      100.00      100.00
------------+-----------------------------------
      Total |      8,021      100.00
6
zmir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         96 |      7,970       99.36       99.36
         97 |         51        0.64      100.00
------------+-----------------------------------
      Total |      8,021      100.00
zmir42fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM4 |      7,658      100.00      100.00
------------+-----------------------------------
      Total |      7,658      100.00
3
zmir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      1,626       21.23       21.23
       2002 |      6,032       78.77      100.00
------------+-----------------------------------
      Total |      7,658      100.00
zmir42fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM4 |      7,658      100.00      100.00
------------+-----------------------------------
      Total |      7,658      100.00
6
zmir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2001 |      1,626       21.23       21.23
       2002 |      6,032       78.77      100.00
------------+-----------------------------------
      Total |      7,658      100.00
zmir51fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(7,146 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM5 |      7,146      100.00      100.00
------------+-----------------------------------
      Total |      7,146      100.00
3
zmir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |      7,146      100.00      100.00
------------+-----------------------------------
      Total |      7,146      100.00
zmir51fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(7,146 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM5 |      7,146      100.00      100.00
------------+-----------------------------------
      Total |      7,146      100.00
6
zmir51fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2007 |      7,146      100.00      100.00
------------+-----------------------------------
      Total |      7,146      100.00
zmir61fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(16,411 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM6 |     16,411      100.00      100.00
------------+-----------------------------------
      Total |     16,411      100.00
3
zmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,916       60.42       60.42
       2014 |      6,495       39.58      100.00
------------+-----------------------------------
      Total |     16,411      100.00
zmir61fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(16,411 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZM6 |     16,411      100.00      100.00
------------+-----------------------------------
      Total |     16,411      100.00
6
zmir61fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2013 |      9,916       60.42       60.42
       2014 |      6,495       39.58      100.00
------------+-----------------------------------
      Total |     16,411      100.00
zwir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ZW |      4,201      100.00      100.00
------------+-----------------------------------
      Total |      4,201      100.00
3
zwir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,620       86.17       86.17
         89 |        581       13.83      100.00
------------+-----------------------------------
      Total |      4,201      100.00
zwir01fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
       code |      Freq.     Percent        Cum.
------------+-----------------------------------
         ZW |      4,201      100.00      100.00
------------+-----------------------------------
      Total |      4,201      100.00
6
zwir01fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         88 |      3,620       86.17       86.17
         89 |        581       13.83      100.00
------------+-----------------------------------
      Total |      4,201      100.00
zwir31fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW3 |      6,128      100.00      100.00
------------+-----------------------------------
      Total |      6,128      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW3 |      6,128      100.00      100.00
------------+-----------------------------------
      Total |      6,128      100.00
3
zwir31fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      6,128      100.00      100.00
------------+-----------------------------------
      Total |      6,128      100.00
zwir31fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW3 |      6,128      100.00      100.00
------------+-----------------------------------
      Total |      6,128      100.00
6
zwir31fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
         94 |      6,128      100.00      100.00
------------+-----------------------------------
      Total |      6,128      100.00
zwir42fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW4 |      5,907      100.00      100.00
------------+-----------------------------------
      Total |      5,907      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |          XXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000000000000000000000000000000 |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW4 |      5,907      100.00      100.00
------------+-----------------------------------
      Total |      5,907      100.00
3
zwir42fl.dta
marriage & unions
         XXXXXXXXXXXXXXXXXXXXXXXX00000000000000000000000000000000000000000000000
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1999 |      5,907      100.00      100.00
------------+-----------------------------------
      Total |      5,907      100.00
zwir42fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(5,907 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW4 |      5,907      100.00      100.00
------------+-----------------------------------
      Total |      5,907      100.00
6
zwir42fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       1999 |      5,907      100.00      100.00
------------+-----------------------------------
      Total |      5,907      100.00
zwir52fl.dta
Marriage column exists and contains data

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW5 |      8,907      100.00      100.00
------------+-----------------------------------
      Total |      8,907      100.00

     +----------------------------------------------------------------------------------+
     |                                                                           vcal_3 |
     |----------------------------------------------------------------------------------|
  1. |           XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX |
     +----------------------------------------------------------------------------------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW5 |      8,907      100.00      100.00
------------+-----------------------------------
      Total |      8,907      100.00
3
zwir52fl.dta
marriage & unions
          XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,842       76.82       76.82
       2006 |      2,065       23.18      100.00
------------+-----------------------------------
      Total |      8,907      100.00
zwir52fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(8,907 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW5 |      8,907      100.00      100.00
------------+-----------------------------------
      Total |      8,907      100.00
6
zwir52fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2005 |      6,842       76.82       76.82
       2006 |      2,065       23.18      100.00
------------+-----------------------------------
      Total |      8,907      100.00
zwir62fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,171 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW6 |      9,171      100.00      100.00
------------+-----------------------------------
      Total |      9,171      100.00
3
zwir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      4,995       54.47       54.47
       2011 |      4,176       45.53      100.00
------------+-----------------------------------
      Total |      9,171      100.00
zwir62fl.dta
Marriage column does not exist

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW6 |      9,171      100.00      100.00
------------+-----------------------------------
      Total |      9,171      100.00
6
zwir62fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2010 |      4,995       54.47       54.47
       2011 |      4,176       45.53      100.00
------------+-----------------------------------
      Total |      9,171      100.00
zwir71fl.dta
Marriage column exists but is empty
variable vcal_3 was str1 now str2
(9,955 real changes made)

     +--------+
     | vcal_3 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW7 |      9,955      100.00      100.00
------------+-----------------------------------
      Total |      9,955      100.00
3
zwir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      9,955      100.00      100.00
------------+-----------------------------------
      Total |      9,955      100.00
zwir71fl.dta
Marriage column exists but is empty
variable vcal_6 was str1 now str2
(9,955 real changes made)

     +--------+
     | vcal_6 |
     |--------|
  1. |     NA |
     +--------+

    country |
   code and |
      phase |      Freq.     Percent        Cum.
------------+-----------------------------------
        ZW7 |      9,955      100.00      100.00
------------+-----------------------------------
      Total |      9,955      100.00
6
zwir71fl.dta
NA
NA
file C:\Users\39585\OneDrive - ICF\MarriageCalendar\surveysearch_union.xlsx saved

    year of |
  interview |      Freq.     Percent        Cum.
------------+-----------------------------------
       2015 |      9,955      100.00      100.00
------------+-----------------------------------
      Total |      9,955      100.00

. 
. 
end of do-file

. do "C:\Users\39585\OneDrive - ICF\MarriageCalendar\Code\MarriageCalendar.do"

.  /*
> gen pos = strpos(vcal_3,"0") // look for first occurrence of "P"
> egen vcal_len = max(strlen(vcal_3))
> */
. 
. cd "C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata"
C:\Users\39585\ICF\Analysis - Shared Resources\Data\DHSdata

. use mwir4efl.dta, clear

. *use zwir42fl.dta, clear
. *Variable for women with one marriage
. *gen divorce1 = strpos(vcal_3,"X0")
.  
. *gen remarry1 = strpos(vcal_3,"0X")
. gen trim_cal = trim(vcal_3)

. gen rev_cal = reverse(trim_cal)

. gen cal = rev_cal

. 
. *rev birth calendar
. gen trim_bcal = trim(vcal_1)

. gen rev_bcal = reverse(trim_bcal)

. gen bcal = rev_bcal

. 
. 
. moss cal, match("X0")

. ren _count dcount

. ren _pos1 dp1

. cap ren _pos2 dp2

. cap ren _pos3 dp3

. 
. recode dp1 .=0
(dp1: 10044 changes made)

. cap recode dp2 .=0

. cap recode dp3 .=0

. 
. moss cal, match("0X")

. ren _count mcount

. ren _pos1 mp1

. cap ren _pos2 mp2

. cap ren _pos3 mp3

. 
. recode mp1 .=0
(mp1: 8201 changes made)

. cap recode mp2 .=0

. cap recode mp3 .=0

. 
. *look for one month in between marriages, in case they were missed
. moss cal, match("X0X")

. ren _pos1 dm1 //divorce then marriage

. drop _count

. 
. *who experienced any divorce AND remarriage
. recode dcount (0=0 "no divorces") (1/max=1 "1 or more divorces"), gen(dany)
(109 differences between dcount and dany)

. gen xox = 0 

. cap replace xox =1 if (dp1<mp1 | dp1<mp2) & dany==1 

. *replace xox = xox + 1 if dm1!=. & xox = 1  //guess I didn't need that (0 changes made)
. 
. *how many remarriages
. gen xox_count = 0 

. replace xox_count = 1 if xox==1
(615 real changes made)

. cap replace xox_count =2 if (dp2<mp2 | dp2<mp3) & dcount==2 //19 second remarriages

. cap replace xox_count =1 if dp3<mp3 & dcount==3 //no changes

. 
. *of those married, one union, divorced, remarried (but no events in calendar)
. gen mnum = 0

. replace mnum = 1 if v503==1
(7,378 real changes made)

. replace mnum = 2 if v503==2
(2,418 real changes made)

. 
. *
. 
. 
. 
. 
. 
. 
. 
. 
. gen wt=v005/1000000

. svyset [pw=wt], psu(v021) strata(v023) singleunit(center)

      pweight: wt
          VCE: linearized
  Single unit: centered
     Strata 1: v023
         SU 1: v021
        FPC 1: <zero>

. 
. svy: tab mnum
(running tabulate on estimation sample)

Number of strata   =        11                  Number of obs     =     11,698
Number of PSUs     =       521                  Population size   = 11,697.891
                                                Design df         =        510

----------------------
     mnum | proportion
----------+-----------
        0 |      .1684
        1 |      .6431
        2 |      .1885
          | 
    Total |          1
----------------------
  Key:  proportion  =  cell proportion

. 
. *of those divorced, remarried
. svy: tab xox if dcount!=0
(running tabulate on estimation sample)

Number of strata   =        11                  Number of obs     =      1,654
Number of PSUs     =       476                  Population size   = 1,610.7155
                                                Design df         =        465

----------------------
      xox | proportion
----------+-----------
        0 |      .6496
        1 |      .3504
          | 
    Total |          1
----------------------
  Key:  proportion  =  cell proportion

. svy: tab v013 xox, row 
(running tabulate on estimation sample)

Number of strata   =        11                  Number of obs     =     11,698
Number of PSUs     =       521                  Population size   = 11,697.891
                                                Design df         =        510

-------------------------------
age       |
5-year    |         xox        
groups    |     0      1  Total
----------+--------------------
    15-19 | .9864  .0136      1
    20-24 | .9267  .0733      1
    25-29 | .9248  .0752      1
    30-34 | .9442  .0558      1
    35-39 | .9625  .0375      1
    40-44 | .9799  .0201      1
    45-49 | .9788  .0212      1
          | 
    Total | .9518  .0482      1
-------------------------------
  Key:  row proportion

  Pearson:
    Uncorrected   chi2(6)         =  168.6378
    Design-based  F(5.80, 2957.08)=   25.4885     P = 0.0000

. graph bar xox [pw=wt], over(v013) asyvars percentages

. *divorces
. svy: tab dcount if v502!=0
(running tabulate on estimation sample)

Number of strata   =        11                  Number of obs     =      9,796
Number of PSUs     =       521                  Population size   = 9,728.1699
                                                Design df         =        510

----------------------
   dcount | proportion
----------+-----------
        0 |      .8344
        1 |      .1558
        2 |      .0095
        3 |    3.1e-04
          | 
    Total |          1
----------------------
  Key:  proportion  =  cell proportion

. 
. *marriages
. svy: tab v201 xox if v502!=0, col
(running tabulate on estimation sample)

Number of strata   =        11                  Number of obs     =      9,796
Number of PSUs     =       521                  Population size   = 9,728.1699
                                                Design df         =        510

-------------------------------------
total     |
children  |            xox           
ever born |       0        1    Total
----------+--------------------------
        0 |   .0695    .0515    .0685
        1 |   .1664     .164    .1663
        2 |   .1699    .2672    .1755
        3 |   .1457    .2111    .1495
        4 |    .122    .1294    .1225
        5 |    .095    .0684    .0934
        6 |   .0769    .0588    .0759
        7 |   .0521    .0192    .0502
        8 |   .0423    .0208     .041
        9 |   .0295    .0071    .0282
       10 |   .0188        0    .0177
       11 |   .0075        0    .0071
       12 |   .0032    .0024    .0032
       13 | 7.1e-04        0  6.7e-04
       14 | 3.1e-04        0  2.9e-04
       16 | 1.4e-04        0  1.3e-04
          | 
    Total |       1        1        1
-------------------------------------
  Key:  column proportion

  Pearson:
    Uncorrected   chi2(15)        =   96.1839
    Design-based  F(13.80, 7035.59)=    5.3339    P = 0.0000

. /*
> 0X - one marriage, currently marr. 1st union in calendar
> 0X - one marraige, currently marr. 1st union before calendar - this is at least 2nd union
> 0X0 - one marriage, currently unmarried
> 0X - one marriage, currently unmarr. 1st union before calendar - this is at least 2nd union
> 0X0X - 2 marriages, currently married. 1st union in calendar
> 0X0X - 2 marriages, currently marr., 1st union before calendar. at least 3rd marr.
> 0X0X0 - 2 marriages, currently unmarr., 1st union before calendar. at least 3rd marr.
> XX - one marriage, currently marr. (could be >2)
> XX - one marriage, currentlyy marr. (reported >2 marriages)
> 
> 
> time to pregnancy after first marriage
> time to pregnancy after second marriage
> if remarried, higher desire than with mother with same # of kids
> remember case 2816, remarried 3 times in 5 years, with pregnancies immediately after marriage
> 

end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. moss cal, match("X0X")

. 
end of do-file

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. ren _pos1 dm1 //divorce then marriage
variable dm1 already defined
r(110);

end of do-file

r(110);

. do "C:\Users\39585\AppData\Local\Temp\STD1198_000000.tmp"

. drop _count

. 
end of do-file

